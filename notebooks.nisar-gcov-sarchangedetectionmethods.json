{"version":2,"kind":"Notebook","sha256":"f3776ed277c57a8594d9f9dd07f39c73efd7d16c71f6f6d6b47d3a13eb7e75ac","slug":"notebooks.nisar-gcov-sarchangedetectionmethods","location":"/notebooks/NISAR_GCOV_SARChangeDetectionMethods.ipynb","dependencies":[],"frontmatter":{"title":"An Introduction to Simple SAR Change Detection Methods","content_includes_title":true,"kernelspec":{"name":"conda-env-.local-uwg_demo-uwg_demo","display_name":"uwg_demo [conda env:.local-uwg_demo]","language":"python"},"authors":[{"nameParsed":{"literal":"The Alaska Satellite Facility","given":"The Alaska Satellite","family":"Facility"},"name":"The Alaska Satellite Facility","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"BSD-3-Clause","url":"https://opensource.org/licenses/BSD-3-Clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","free":true,"osi":true}},"github":"https://github.com/ASFOpenSARlab/NISAR_GCOV_Cookbook","copyright":"2025","affiliations":[{"id":"UAF","name":"University of Alaska Fairbanks","department":"Geophysical Institute","url":"https://www.gi.alaska.edu/"},{"id":"ASF","name":"Alaska Satellite Facility","url":"https://asf.alaska.edu/"}],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/ASFOpenSARlab/NISAR_GCOV_Cookbook/blob/main/notebooks/NISAR_GCOV_SARChangeDetectionMethods.ipynb","edit_url":"https://github.com/ASFOpenSARlab/NISAR_GCOV_Cookbook/edit/main/notebooks/NISAR_GCOV_SARChangeDetectionMethods.ipynb","exports":[{"format":"ipynb","filename":"NISAR_GCOV_SARChangeDetectionMethods.ipynb","url":"/NISAR_GCOV_Cookbook/build/NISAR_GCOV_SARChange-4d767ab27f942534a76555804ecd23f4.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"hide_input":false},"children":[{"type":"image","url":"/myst_assets_folderNotebookAddons/blackboard-banner.png","alt":"OpenSARlab notebook banner","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Rk5mRjrf9c"},{"type":"heading","depth":1,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"An Introduction to Simple SAR Change Detection Methods","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KmIS3Upq8q"}],"identifier":"an-introduction-to-simple-sar-change-detection-methods","label":"An Introduction to Simple SAR Change Detection Methods","html_id":"an-introduction-to-simple-sar-change-detection-methods","implicit":true,"key":"hh2m0uiSy0"},{"type":"heading","depth":3,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Franz J Meyer; University of Alaska Fairbanks","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"JjQZVq5BbG"}],"identifier":"franz-j-meyer-university-of-alaska-fairbanks","label":"Franz J Meyer; University of Alaska Fairbanks","html_id":"franz-j-meyer-university-of-alaska-fairbanks","implicit":true,"key":"S2xzNvqZEd"},{"type":"image","style":{"padding":"5px"},"url":"/myst_assets_folderNotebookAddons/UAFLogo_A_647.png","width":170,"key":"NDc0xYSnpu"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"This notebook introduces you to a some popular change detection methods that can be applied on SAR time series data. SAR is an excellent tool for change detection. As SAR sensors are weather and illumination independent, and as SAR’s carry their own illumination source (active sensor), differences between repeated images are a direct indication of changes on the surface. This fact is exploited by the change detection methods introduced below.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"DYbLdU6MGq"}],"key":"vjK10x4tia"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"The exercise is done in the framework of ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"y75suObRFA"},{"type":"emphasis","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Jupyter Notebooks","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"MQhIwc2uaV"}],"key":"k5odPjMft9"},{"type":"text","value":". The Jupyter Notebook environment is easy to launch in any web browser for interactive data exploration with provided or new training data. Notebooks are comprised of text written in a combination of executable python code and markdown formatting including latex style mathematical equations. Another advantage of Jupyter Notebooks is that they can easily be expanded, changed, and shared with new data sets or newly available time series steps. Therefore, they provide an excellent basis for collaborative and repeatable data analysis.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"xD5gJWon8h"}],"key":"dG5hL6rKTJ"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"This notebook covers the following data analysis concepts:","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"SvNdLuaJ2g"}],"key":"yRlB8vzqG3"}],"key":"iNmD90DV0J"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":15,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Time series metrics  95","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"fJ5VnH6aYJ"},{"type":"inlineMath","value":"^{th}","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mrow></mrow><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">^{th}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">h</span></span></span></span></span></span></span></span></span></span></span></span>","key":"o0NB1MVIBg"},{"type":"text","value":" and 5","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"QVSlZgEHUf"},{"type":"inlineMath","value":"^{th}","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mrow></mrow><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">^{th}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">h</span></span></span></span></span></span></span></span></span></span></span></span>","key":"UnZhopLJPU"},{"type":"text","value":" percentile difference thresholding","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"VCo8E7tLxl"}],"key":"hkelaU677D"}],"key":"N8JECzMBNJ"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Time series coefficient of variation thresholding","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"ems99diMy6"}],"key":"k8bdBYgtnj"}],"key":"QvORGS0XTk"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Log Ratio-based change detection from image pairs","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"SNv49Sypey"}],"key":"jxxAV7bfJA"}],"key":"Au911WYwiq"}],"key":"RTNEvRIZzG"}],"key":"L7iJvw5MCw"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","key":"dOv5NmrG3j"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","children":[{"type":"text","value":"0. Importing Relevant Python Packages","key":"vJfiIHBVPa"}],"key":"YbWFD3geRm"}],"key":"K5pRvWsNys"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"In this notebook we will use the following scientific libraries:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"oMw1Fr6gle"}],"key":"rcUi3KgEWc"},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"link","url":"https://pandas.pydata.org/","children":[{"type":"text","value":"Pandas","key":"k4LfircyeD"}],"urlSource":"https://pandas.pydata.org/","key":"j2CZspycVC"}],"key":"PVUZHmWA0y"},{"type":"text","value":" is a Python library that provides high-level data structures and a vast variety of tools for analysis. The great feature of this package is the ability to translate rather complex operations with data into one or two commands. Pandas contains many built-in methods for filtering and combining data, as well as the time-series functionality.","key":"PkNYHHukeC"}],"key":"B0Eu8SXgaZ"}],"key":"eITxNPSbto"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"link","url":"https://www.gdal.org/","children":[{"type":"text","value":"GDAL","key":"tOqF1c1xI1"}],"urlSource":"https://www.gdal.org/","key":"VbA0ScwDoW"}],"key":"voQZ6vgUMY"},{"type":"text","value":" is a software library for reading and writing raster and vector geospatial data formats. It includes a collection of programs tailored for geospatial data processing. Most modern GIS systems (such as ArcGIS or QGIS) use GDAL in the background.","key":"tK3ua8Q3v7"}],"key":"fZEpTt5kDE"}],"key":"K7ajmSvhPu"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"link","url":"http://www.numpy.org/","children":[{"type":"text","value":"NumPy","key":"k4zrPAsuVz"}],"urlSource":"http://www.numpy.org/","key":"qCAqLZqgAU"}],"key":"LP697AGRyv"},{"type":"text","value":" is one of the principal packages for scientific applications of Python. It is intended for processing large multidimensional arrays and matrices, and an extensive collection of high-level mathematical functions and implemented methods makes it possible to perform various operations with these objects.","key":"RqyOjOS4Cr"}],"key":"lk1YUo8dPg"}],"key":"idqOhlXrmE"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"link","url":"https://matplotlib.org/index.html","children":[{"type":"text","value":"Matplotlib","key":"hmmjpMJplV"}],"urlSource":"https://matplotlib.org/index.html","key":"NuIhT9g5Yz"}],"key":"eQFYQ0758q"},{"type":"text","value":" is a low-level library for creating two-dimensional diagrams and graphs. With its help, you can build diverse charts, from histograms and scatterplots to non-Cartesian coordinates graphs. Moreover, many popular plotting libraries are designed to work in conjunction with matplotlib.","key":"qY4Qe5BUDh"}],"key":"InUNiwsVH3"}],"key":"lRh1QcTCNw"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The ","key":"MQclczCeF5"},{"type":"strong","children":[{"type":"link","url":"https://www.pydoc.io/pypi/asf-hyp3-1.1.1/index.html","children":[{"type":"text","value":"asf-hyp3 API","key":"lctVorWfbl"}],"urlSource":"https://www.pydoc.io/pypi/asf-hyp3-1.1.1/index.html","key":"XC4NSH7giA"}],"key":"OzGwbWCkv6"},{"type":"text","value":" provides useful functions and scripts for accessing and processing SAR data via the Alaska Satellite Facility's Hybrid Pluggable Processing Pipeline, or HyP3 (pronounced \"hype\").","key":"L3ruaHs8tM"}],"key":"iBo2FWpl79"}],"key":"lx7Ed8o2yL"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"link","url":"https://www.scipy.org/about.html","children":[{"type":"text","value":"SciPY","key":"CzPbShjPOc"}],"urlSource":"https://www.scipy.org/about.html","key":"kuZhGaXZE1"}],"key":"KQOvxtgN5B"},{"type":"text","value":" is a library that provides functions for numerical integration, interpolation, optimization, linear algebra and statistics.","key":"WSbu6GPf4b"}],"key":"o3gNiRKqCT"}],"key":"aSoeVZVge0"}],"key":"wQjNXMznD1"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Our first step is to ","key":"EURupzUDU4"},{"type":"strong","children":[{"type":"text","value":"import them:","key":"gYLAEXstwg"}],"key":"XaK2zbYGxB"}],"key":"AESUEiVZR5"}],"key":"AxFAmkN1ti"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# %%capture\n# from pathlib import Path\n# from os import system\n# import datetime # for date\n# import re\n\n# import pandas as pd # for DatetimeIndex\n# from osgeo import gdal # for Info\n# gdal.UseExceptions()\n\n# %matplotlib inline\n# import matplotlib.pyplot as plt\n# from matplotlib import animation\n# from matplotlib import rc\n# import numpy as np\n\n# from ipyfilechooser import FileChooser\n\n# from IPython.display import HTML\n\n# import opensarlab_lib as asfn\n# asfn.jupytertheme_matplotlib_format()","key":"v1EEBOnI1v"},{"type":"output","id":"sUopaaYCyRrqi-yX5gyuu","data":[],"key":"QSfaBO07pp"}],"key":"DoedhmL95a"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1. Load Data Stack","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pvqC3VIorN"}],"identifier":"id-1-load-data-stack","label":"1. Load Data Stack","html_id":"id-1-load-data-stack","implicit":true,"key":"TU83trV1Mp"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In the Exercise4A-SARChangeDetectionMethods.ipynb notebook will used a dense 12-day repeat Sentinel-1 C-band SAR data stack. It contained imagery acquired during the year 2018 in Guatemala. The data was already prepared for you. Now, you will later learn how to download and pre-process Sentinel-1 images using the services of the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wJD946uZuB"},{"type":"link","url":"https://www.asf.alaska.edu/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Alaska Satellite Facility","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XQhyVlZuNU"}],"urlSource":"https://www.asf.alaska.edu/","key":"p8tsRVj4pD"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vlvuZ00Hrr"}],"key":"xveiLOdzwe"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Begin by writing a function to retrieve the absolute paths to each of our tiffs:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"A1zEIdVctR"}],"key":"tv11eShuYQ"}],"key":"aWW7TqBWXn"}],"key":"fdrNwJvsKN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# def get_tiff_paths(paths):\n#     tiff_paths = !ls $paths | sort -t_ -k5,5\n#     return tiff_paths","key":"Ao6JMx4dCi"},{"type":"output","id":"wrshnoBffSGGDe90enl7d","data":[],"key":"fBqGhnflXp"}],"key":"JXlorjun0x"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Select the directory holding your tiffs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YJ6U8pmoMK"}],"key":"hUQ2vN9VZ1"}],"key":"Dvqh2ilztG"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Click the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"kUsTkH1596"},{"type":"inlineCode","value":"Select","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"hlGV5A1DmT"},{"type":"text","value":" button","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"GNWNtVw7mv"}],"key":"ByZ8nG3oKF"}],"key":"eUVWkIQHmV"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Navigate to your data directory","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"N69zG4j7ie"}],"key":"IcvaMGF6gf"}],"key":"S2TWRLD5zP"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Click the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"HlqZ2DdWM8"},{"type":"inlineCode","value":"Select","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Zh94ZpXOdf"},{"type":"text","value":" button","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"q48YFJTofW"}],"key":"zuqb7flEjY"}],"key":"gOZ07RCyTB"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Confirm that the desired path appears in green text","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wgvVqHr0uW"}],"key":"xaEVgAHd35"}],"key":"gsM7lgLXSB"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Click the ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"dx5YoK7JuW"},{"type":"inlineCode","value":"Change","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"OP0XBbpXwd"},{"type":"text","value":" button to alter your selection","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"PQQ3tfjETS"}],"key":"iwArayXg7p"}],"key":"QnuY1BdTa5"}],"key":"S95mStploa"}],"key":"kzeAgVR55k"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# fc = FileChooser(Path.cwd())\n# display(fc)","key":"jwnALeKJYx"},{"type":"output","id":"bkpmfvLXdoxwYu7baAFvA","data":[],"key":"r5bgGhVvG0"}],"key":"pAMZo2mEJb"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine the path to the analysis directory containing the tiff directory:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P5q42R1c19"}],"key":"LHQXfVbAwW"}],"key":"Rp5Y86NFGm"}],"key":"QkbQeE1X8m"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from pathlib import Path\n\nchange_detection_example_dir = Path.cwd() / \"change_detection_example\"\n\ndata_dir = change_detection_example_dir / \"data\"\ndata_dir.mkdir(parents=True, exist_ok=True)\n\nplot_dir = change_detection_example_dir / \"plots\"\nplot_dir.mkdir(exist_ok=True)","key":"Z5RRlIfbLb"},{"type":"output","id":"V6fLP19VcZI_MaCEIQ3l4","data":[],"key":"n2FUpo7Rzs"}],"key":"jmHPWzrvSx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\nimport asf_search as asf\n# from getpass import getpass\n\n\nwkt = \"POLYGON((-57.759 -3.5099,-56.459 -3.5099,-56.459 -2.6352,-57.759 -2.6352,-57.759 -3.5099))\"\n\nopts=asf.ASFSearchOptions(**{\n    \"maxResults\": 250,\n    \"intersectsWith\": wkt,\n    \"processingLevel\": [\n        \"GCOV\"\n    ],\n    \"dataset\": [\n        \"NISAR\"\n    ],\n    \"productionConfiguration\": [\n        \"PR\"\n    ],\n    \"host\": \"cmr.uat.earthdata.nasa.gov\"\n})\n\nsession = asf.ASFSession(cmr_host='cmr.uat.earthdata.nasa.gov')\n# session.auth_with_token(getpass('UAT EDL token'))\nsession.auth_with_token(os.environ[\"UAT_TOKEN\"])\n\nresponse = asf.search(opts=opts)\n\nhdf5_files = response.find_urls(extension='.h5', pattern=r'^(?!.*STATS).*DHDH.*', directAccess=False)\nasf.download_urls(hdf5_files, data_dir, session=session, processes=4)","key":"FZIVUGheB5"},{"type":"output","id":"Du0z3Vf4nsgN-B0X5oJya","data":[],"key":"pqDedmf5Gd"}],"key":"t3pzaWJ4w6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# TODO: Delete when we have real NISAR data\n# Duplicates the one sample GCOV file we have\nimport shutil\n\nf = list(data_dir.glob('*.h5'))[0]\nfor i in range(7): \n    shutil.copy(f, f.parent / f\"{f.stem}_{i}.h5\")","key":"oLSlx4XFSB"},{"type":"output","id":"GW0o-UrisxmV5fv-ZMDon","data":[],"key":"RYec2tqo4A"}],"key":"dHAkkajZI1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"gcov_files = sorted(list(data_dir.glob(\"*.h5\")))\ngcov_files","key":"weojO6kMIe"},{"type":"output","id":"S7k5QSZgfXAYA8lIAjQqL","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"[PosixPath('/home/jovyan/opensarlab-notebooks/SAR_Training/English/Master/change_detection_example/data/NISAR_L2_PR_GCOV_087_039_D_090_2005_DHDH_A_20251102T220639_20251102T220714_T00407_N_F_J_001.h5'),\n PosixPath('/home/jovyan/opensarlab-notebooks/SAR_Training/English/Master/change_detection_example/data/NISAR_L2_PR_GCOV_087_039_D_090_2005_DHDH_A_20251102T220639_20251102T220714_T00407_N_F_J_001_0.h5'),\n PosixPath('/home/jovyan/opensarlab-notebooks/SAR_Training/English/Master/change_detection_example/data/NISAR_L2_PR_GCOV_087_039_D_090_2005_DHDH_A_20251102T220639_20251102T220714_T00407_N_F_J_001_1.h5'),\n PosixPath('/home/jovyan/opensarlab-notebooks/SAR_Training/English/Master/change_detection_example/data/NISAR_L2_PR_GCOV_087_039_D_090_2005_DHDH_A_20251102T220639_20251102T220714_T00407_N_F_J_001_2.h5'),\n PosixPath('/home/jovyan/opensarlab-notebooks/SAR_Training/English/Master/change_detection_example/data/NISAR_L2_PR_GCOV_087_039_D_090_2005_DHDH_A_20251102T220639_20251102T220714_T00407_N_F_J_001_3.h5'),\n PosixPath('/home/jovyan/opensarlab-notebooks/SAR_Training/English/Master/change_detection_example/data/NISAR_L2_PR_GCOV_087_039_D_090_2005_DHDH_A_20251102T220639_20251102T220714_T00407_N_F_J_001_4.h5'),\n PosixPath('/home/jovyan/opensarlab-notebooks/SAR_Training/English/Master/change_detection_example/data/NISAR_L2_PR_GCOV_087_039_D_090_2005_DHDH_A_20251102T220639_20251102T220714_T00407_N_F_J_001_5.h5'),\n PosixPath('/home/jovyan/opensarlab-notebooks/SAR_Training/English/Master/change_detection_example/data/NISAR_L2_PR_GCOV_087_039_D_090_2005_DHDH_A_20251102T220639_20251102T220714_T00407_N_F_J_001_6.h5')]","content_type":"text/plain"}}}],"key":"sTJEO8aYK0"}],"key":"edu18qKcvy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import re\nimport h5py\nimport numpy as np\nimport xarray as xr\nimport dask.array as da\nfrom dask import delayed\n\n_date_regex = re.compile(r\"_(\\d{8}T\\d{6})_\")\ndef _get_ts(filename):\n    match = _date_regex.search(filename)\n    if match:\n        ts_str = match.group(1)\n        return np.datetime64(f\"{ts_str[:4]}-{ts_str[4:6]}-{ts_str[6:8]}T{ts_str[9:11]}:{ts_str[11:13]}:{ts_str[13:15]}\") \n    return np.datetime64(\"NaT\")\n\ndef open_gcov(gcov_paths, vars_to_load=(\"HHHH\", \"HVHV\", \"mask\", \"numberOfLooks\", \"rtcGammaToSigmaFactor\"), freqs=(\"A\",\"B\"), max_xy_chunk=2048):\n    gcov_paths = sorted(gcov_paths)\n    group = {f: f\"/science/LSAR/GCOV/grids/frequency{f}\" for f in freqs}\n    with h5py.File(gcov_paths[0], \"r\") as f0:\n        g = f0[group[freqs[0]]]\n        x, y = g[\"xCoordinates\"][...], g[\"yCoordinates\"][...]\n        proj = g[\"projection\"][()]\n    ny, nx = len(y), len(x)\n    time = np.array([_get_ts(p.name) for p in gcov_paths])\n    chunks = (1, 1, min(ny, max_xy_chunk), min(nx, max_xy_chunk))  # (time, frequency, y, x)\n\n    data_vars = {}\n    for v in vars_to_load:\n        per_freq = []\n        for freq in freqs:\n            with h5py.File(gcov_paths[0], \"r\") as f0:\n                dt = f0[f\"{group[freq]}/{v}\"].dtype\n            planes = [da.from_delayed(delayed(lambda p, d: h5py.File(p,\"r\")[d][...])(p, f\"{group[freq]}/{v}\"),\n                                      shape=(ny, nx), dtype=dt)[None, None, ...]\n                      for p in gcov_paths]\n            per_freq.append(da.concatenate(planes, axis=0))\n        stacked = da.concatenate(per_freq, axis=1).rechunk(chunks)\n        data_vars[v] = ((\"time\",\"frequency\",\"y\",\"x\"), stacked)\n\n    return xr.Dataset(\n        data_vars=data_vars,\n        coords={\"time\": time, \"frequency\": np.array(list(freqs)), \"y\": y, \"x\": x},\n        attrs={\"source\": \"NISAR L2 GCOV\", \"projection\": proj},\n    )","key":"qkxGzmpjSu"},{"type":"output","id":"M2pk2toO82q2YlHmUlFCG","data":[],"key":"eIQMKN484g"}],"key":"Phvy8QFtfh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds = open_gcov(gcov_files)\nds","key":"Hkpf0Tie3l"},{"type":"output","id":"ckV_musMZo01aAqaWGZQL","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"73bbe162540d5c6bdceb45fb34ad6308","path":"/NISAR_GCOV_Cookbook/build/73bbe162540d5c6bdceb45fb34ad6308.html"},"text/plain":{"content":"<xarray.Dataset> Size: 72GB\nDimensions:                (time: 8, frequency: 2, y: 15984, x: 16668)\nCoordinates:\n  * time                   (time) datetime64[s] 64B 2025-11-02T22:06:39 ... 2...\n  * frequency              (frequency) <U1 8B 'A' 'B'\n  * y                      (y) float64 128kB 9.819e+06 9.819e+06 ... 9.499e+06\n  * x                      (x) float64 133kB 3.312e+05 3.312e+05 ... 6.646e+05\nData variables:\n    HHHH                   (time, frequency, y, x) float32 17GB dask.array<chunksize=(1, 1, 2048, 2048), meta=np.ndarray>\n    HVHV                   (time, frequency, y, x) float32 17GB dask.array<chunksize=(1, 1, 2048, 2048), meta=np.ndarray>\n    mask                   (time, frequency, y, x) uint8 4GB dask.array<chunksize=(1, 1, 2048, 2048), meta=np.ndarray>\n    numberOfLooks          (time, frequency, y, x) float32 17GB dask.array<chunksize=(1, 1, 2048, 2048), meta=np.ndarray>\n    rtcGammaToSigmaFactor  (time, frequency, y, x) float32 17GB dask.array<chunksize=(1, 1, 2048, 2048), meta=np.ndarray>\nAttributes:\n    source:      NISAR L2 GCOV\n    projection:  32721","content_type":"text/plain"}}}],"key":"hRHBkSdR87"}],"key":"zChutZQE0m"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# TODO: remove this when there is real NISAR data\n# Fakes a time series by updating dates and backscatter\n\nimport pandas as pd\n\nfake_times = pd.date_range(\n    start=\"2025-11-02T22:06:39\",\n    periods=ds.sizes[\"time\"],\n    freq=\"D\"\n)\n\nds = ds.assign_coords(time=fake_times)\n\n# adjust each duplicated time step's backscatter values for better test visualization\nfactors = 1 + 0.3 * np.sin(np.linspace(0, 2*np.pi, ds.sizes[\"time\"]))\nscaled = ds * xr.DataArray(factors, dims=[\"time\"])\nscaled = scaled.assign_attrs(ds.attrs)\nds = scaled\nds","key":"Q5wY2zeayA"},{"type":"output","id":"w96liP8lQnkvvmKOm3mYj","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"1de35962776a9344e64e2be2ddbab3f9","path":"/NISAR_GCOV_Cookbook/build/1de35962776a9344e64e2be2ddbab3f9.html"},"text/plain":{"content":"<xarray.Dataset> Size: 171GB\nDimensions:                (frequency: 2, y: 15984, x: 16668, time: 8)\nCoordinates:\n  * frequency              (frequency) <U1 8B 'A' 'B'\n  * y                      (y) float64 128kB 9.819e+06 9.819e+06 ... 9.499e+06\n  * x                      (x) float64 133kB 3.312e+05 3.312e+05 ... 6.646e+05\n  * time                   (time) datetime64[ns] 64B 2025-11-02T22:06:39 ... ...\nData variables:\n    HHHH                   (time, frequency, y, x) float64 34GB dask.array<chunksize=(1, 1, 2048, 2048), meta=np.ndarray>\n    HVHV                   (time, frequency, y, x) float64 34GB dask.array<chunksize=(1, 1, 2048, 2048), meta=np.ndarray>\n    mask                   (time, frequency, y, x) float64 34GB dask.array<chunksize=(1, 1, 2048, 2048), meta=np.ndarray>\n    numberOfLooks          (time, frequency, y, x) float64 34GB dask.array<chunksize=(1, 1, 2048, 2048), meta=np.ndarray>\n    rtcGammaToSigmaFactor  (time, frequency, y, x) float64 34GB dask.array<chunksize=(1, 1, 2048, 2048), meta=np.ndarray>\nAttributes:\n    source:      NISAR L2 GCOV\n    projection:  32721","content_type":"text/plain"}}}],"key":"arV9aVcWr9"}],"key":"tmxVB0j1HD"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine the path to the analysis directory containing the tiff directory:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NxSCqDA3NY"}],"key":"YFJLgjt5Ad"}],"key":"XJz0u1fVKT"}],"key":"QBhq3oTxHs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# polarization = asfn.select_parameter(['VV', 'VH'], 'polarization:')\n# polarization","key":"bAwCK4f0ZN"},{"type":"output","id":"4IFnNR7WAAqQorpVGnTE8","data":[],"key":"DSkBqDuim7"}],"key":"Zm5gtPDiKw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\npolarization = \"HVHV\"\nfrequency = \"A\"\n\nda = ds[polarization].sel(frequency=frequency,\n                          x=slice(400000.0, 500000.0),\n                          y=slice(9700000.0, 9600000.0))\nda = da.assign_attrs({**ds.attrs, **da.attrs})\n# da.load()\nda","key":"hj8v5oWobI"},{"type":"output","id":"XXvXKGpxkC5uhGgPYuY-g","data":[{"name":"stdout","output_type":"stream","text":"CPU times: user 4.08 ms, sys: 0 ns, total: 4.08 ms\nWall time: 3.13 ms\n"},{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;HVHV&#x27; (time: 8, y: 5000, x: 5000)&gt; Size: 2GB\ndask.array&lt;getitem, shape=(8, 5000, 5000), dtype=float64, chunksize=(1, 2048, 2048), chunktype=numpy.ndarray&gt;\nCoordinates:\n    frequency  &lt;U1 4B &#x27;A&#x27;\n  * y          (y) float64 40kB 9.7e+06 9.7e+06 9.7e+06 ... 9.6e+06 9.6e+06\n  * x          (x) float64 40kB 4e+05 4e+05 4e+05 ... 5e+05 5e+05 5e+05\n  * time       (time) datetime64[ns] 64B 2025-11-02T22:06:39 ... 2025-11-09T2...\nAttributes:\n    source:      NISAR L2 GCOV\n    projection:  32721</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'HVHV'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 8</li><li><span class='xr-has-index'>y</span>: 5000</li><li><span class='xr-has-index'>x</span>: 5000</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-75abffca-d1ca-4cf4-9a7a-4398c1423f93' class='xr-array-in' type='checkbox' checked><label for='section-75abffca-d1ca-4cf4-9a7a-4398c1423f93' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(1, 212, 656), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>\n    <tr>\n        <td>\n            <table style=\"border-collapse: collapse;\">\n                <thead>\n                    <tr>\n                        <td> </td>\n                        <th> Array </th>\n                        <th> Chunk </th>\n                    </tr>\n                </thead>\n                <tbody>\n                    \n                    <tr>\n                        <th> Bytes </th>\n                        <td> 1.49 GiB </td>\n                        <td> 32.00 MiB </td>\n                    </tr>\n                    \n                    <tr>\n                        <th> Shape </th>\n                        <td> (8, 5000, 5000) </td>\n                        <td> (1, 2048, 2048) </td>\n                    </tr>\n                    <tr>\n                        <th> Dask graph </th>\n                        <td colspan=\"2\"> 128 chunks in 56 graph layers </td>\n                    </tr>\n                    <tr>\n                        <th> Data type </th>\n                        <td colspan=\"2\"> float64 numpy.ndarray </td>\n                    </tr>\n                </tbody>\n            </table>\n        </td>\n        <td>\n        <svg width=\"194\" height=\"184\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n\n  <!-- Horizontal lines -->\n  <line x1=\"10\" y1=\"0\" x2=\"24\" y2=\"14\" style=\"stroke-width:2\" />\n  <line x1=\"10\" y1=\"5\" x2=\"24\" y2=\"20\" />\n  <line x1=\"10\" y1=\"54\" x2=\"24\" y2=\"69\" />\n  <line x1=\"10\" y1=\"103\" x2=\"24\" y2=\"118\" />\n  <line x1=\"10\" y1=\"120\" x2=\"24\" y2=\"134\" style=\"stroke-width:2\" />\n\n  <!-- Vertical lines -->\n  <line x1=\"10\" y1=\"0\" x2=\"10\" y2=\"120\" style=\"stroke-width:2\" />\n  <line x1=\"11\" y1=\"1\" x2=\"11\" y2=\"121\" />\n  <line x1=\"13\" y1=\"3\" x2=\"13\" y2=\"123\" />\n  <line x1=\"15\" y1=\"5\" x2=\"15\" y2=\"125\" />\n  <line x1=\"17\" y1=\"7\" x2=\"17\" y2=\"127\" />\n  <line x1=\"19\" y1=\"9\" x2=\"19\" y2=\"129\" />\n  <line x1=\"21\" y1=\"11\" x2=\"21\" y2=\"131\" />\n  <line x1=\"23\" y1=\"13\" x2=\"23\" y2=\"133\" />\n  <line x1=\"24\" y1=\"14\" x2=\"24\" y2=\"134\" style=\"stroke-width:2\" />\n\n  <!-- Colored Rectangle -->\n  <polygon points=\"10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,134.9485979497544 10.0,120.0\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n\n  <!-- Horizontal lines -->\n  <line x1=\"10\" y1=\"0\" x2=\"130\" y2=\"0\" style=\"stroke-width:2\" />\n  <line x1=\"11\" y1=\"1\" x2=\"131\" y2=\"1\" />\n  <line x1=\"13\" y1=\"3\" x2=\"133\" y2=\"3\" />\n  <line x1=\"15\" y1=\"5\" x2=\"135\" y2=\"5\" />\n  <line x1=\"17\" y1=\"7\" x2=\"137\" y2=\"7\" />\n  <line x1=\"19\" y1=\"9\" x2=\"139\" y2=\"9\" />\n  <line x1=\"21\" y1=\"11\" x2=\"141\" y2=\"11\" />\n  <line x1=\"23\" y1=\"13\" x2=\"143\" y2=\"13\" />\n  <line x1=\"24\" y1=\"14\" x2=\"144\" y2=\"14\" style=\"stroke-width:2\" />\n\n  <!-- Vertical lines -->\n  <line x1=\"10\" y1=\"0\" x2=\"24\" y2=\"14\" style=\"stroke-width:2\" />\n  <line x1=\"25\" y1=\"0\" x2=\"40\" y2=\"14\" />\n  <line x1=\"74\" y1=\"0\" x2=\"89\" y2=\"14\" />\n  <line x1=\"124\" y1=\"0\" x2=\"138\" y2=\"14\" />\n  <line x1=\"130\" y1=\"0\" x2=\"144\" y2=\"14\" style=\"stroke-width:2\" />\n\n  <!-- Colored Rectangle -->\n  <polygon points=\"10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n\n  <!-- Horizontal lines -->\n  <line x1=\"24\" y1=\"14\" x2=\"144\" y2=\"14\" style=\"stroke-width:2\" />\n  <line x1=\"24\" y1=\"20\" x2=\"144\" y2=\"20\" />\n  <line x1=\"24\" y1=\"69\" x2=\"144\" y2=\"69\" />\n  <line x1=\"24\" y1=\"118\" x2=\"144\" y2=\"118\" />\n  <line x1=\"24\" y1=\"134\" x2=\"144\" y2=\"134\" style=\"stroke-width:2\" />\n\n  <!-- Vertical lines -->\n  <line x1=\"24\" y1=\"14\" x2=\"24\" y2=\"134\" style=\"stroke-width:2\" />\n  <line x1=\"40\" y1=\"14\" x2=\"40\" y2=\"134\" />\n  <line x1=\"89\" y1=\"14\" x2=\"89\" y2=\"134\" />\n  <line x1=\"138\" y1=\"14\" x2=\"138\" y2=\"134\" />\n  <line x1=\"144\" y1=\"14\" x2=\"144\" y2=\"134\" style=\"stroke-width:2\" />\n\n  <!-- Colored Rectangle -->\n  <polygon points=\"24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,134.9485979497544 24.9485979497544,134.9485979497544\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n\n  <!-- Text -->\n  <text x=\"84.948598\" y=\"154.948598\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >5000</text>\n  <text x=\"164.948598\" y=\"74.948598\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(-90,164.948598,74.948598)\">5000</text>\n  <text x=\"7.474299\" y=\"147.474299\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(45,7.474299,147.474299)\">8</text>\n</svg>\n        </td>\n    </tr>\n</table></div></div></li><li class='xr-section-item'><input id='section-67273609-8657-4775-9cf3-07a2e59af055' class='xr-section-summary-in' type='checkbox'  checked><label for='section-67273609-8657-4775-9cf3-07a2e59af055' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>frequency</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;A&#x27;</div><input id='attrs-d173fb57-2feb-4049-bd05-3e16bc7b0fa7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d173fb57-2feb-4049-bd05-3e16bc7b0fa7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ea58672c-cb44-40e4-a2de-d44255efb791' class='xr-var-data-in' type='checkbox'><label for='data-ea58672c-cb44-40e4-a2de-d44255efb791' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(&#x27;A&#x27;, dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>9.7e+06 9.7e+06 ... 9.6e+06 9.6e+06</div><input id='attrs-a1f79ea9-ffe4-4431-b0e5-bc6bee456f5c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a1f79ea9-ffe4-4431-b0e5-bc6bee456f5c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-67e8b215-2422-4390-b4c3-f42647ab0ecf' class='xr-var-data-in' type='checkbox'><label for='data-67e8b215-2422-4390-b4c3-f42647ab0ecf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([9699990., 9699970., 9699950., ..., 9600050., 9600030., 9600010.],\n      shape=(5000,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4e+05 4e+05 4e+05 ... 5e+05 5e+05</div><input id='attrs-21441c07-832e-4a3f-8857-d3dcacba0527' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-21441c07-832e-4a3f-8857-d3dcacba0527' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4f392b0d-747a-493e-a8b7-cbcb520b2157' class='xr-var-data-in' type='checkbox'><label for='data-4f392b0d-747a-493e-a8b7-cbcb520b2157' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([400010., 400030., 400050., ..., 499950., 499970., 499990.],\n      shape=(5000,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2025-11-02T22:06:39 ... 2025-11-...</div><input id='attrs-c7f9f66f-e49b-478e-b82e-800bca7d29fe' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c7f9f66f-e49b-478e-b82e-800bca7d29fe' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f55c6273-569d-4ba4-bd79-11a9ffc8d6c1' class='xr-var-data-in' type='checkbox'><label for='data-f55c6273-569d-4ba4-bd79-11a9ffc8d6c1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2025-11-02T22:06:39.000000000&#x27;, &#x27;2025-11-03T22:06:39.000000000&#x27;,\n       &#x27;2025-11-04T22:06:39.000000000&#x27;, &#x27;2025-11-05T22:06:39.000000000&#x27;,\n       &#x27;2025-11-06T22:06:39.000000000&#x27;, &#x27;2025-11-07T22:06:39.000000000&#x27;,\n       &#x27;2025-11-08T22:06:39.000000000&#x27;, &#x27;2025-11-09T22:06:39.000000000&#x27;],\n      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0f232d98-f464-4e82-a97a-b93307e45a6e' class='xr-section-summary-in' type='checkbox'  ><label for='section-0f232d98-f464-4e82-a97a-b93307e45a6e' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-b9a565c0-354a-4e36-a562-0108b6d6e1d4' class='xr-index-data-in' type='checkbox'/><label for='index-b9a565c0-354a-4e36-a562-0108b6d6e1d4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([9699990.0, 9699970.0, 9699950.0, 9699930.0, 9699910.0, 9699890.0,\n       9699870.0, 9699850.0, 9699830.0, 9699810.0,\n       ...\n       9600190.0, 9600170.0, 9600150.0, 9600130.0, 9600110.0, 9600090.0,\n       9600070.0, 9600050.0, 9600030.0, 9600010.0],\n      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=5000))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-7899b57f-50d6-4de6-80e8-00ad8daa5099' class='xr-index-data-in' type='checkbox'/><label for='index-7899b57f-50d6-4de6-80e8-00ad8daa5099' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([400010.0, 400030.0, 400050.0, 400070.0, 400090.0, 400110.0, 400130.0,\n       400150.0, 400170.0, 400190.0,\n       ...\n       499810.0, 499830.0, 499850.0, 499870.0, 499890.0, 499910.0, 499930.0,\n       499950.0, 499970.0, 499990.0],\n      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=5000))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-598e4e8b-0d97-430c-b7d7-12f6ea4f14cf' class='xr-index-data-in' type='checkbox'/><label for='index-598e4e8b-0d97-430c-b7d7-12f6ea4f14cf' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2025-11-02 22:06:39&#x27;, &#x27;2025-11-03 22:06:39&#x27;,\n               &#x27;2025-11-04 22:06:39&#x27;, &#x27;2025-11-05 22:06:39&#x27;,\n               &#x27;2025-11-06 22:06:39&#x27;, &#x27;2025-11-07 22:06:39&#x27;,\n               &#x27;2025-11-08 22:06:39&#x27;, &#x27;2025-11-09 22:06:39&#x27;],\n              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=&#x27;D&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-97147824-8d88-47d8-a8e6-c8663d20ed36' class='xr-section-summary-in' type='checkbox'  checked><label for='section-97147824-8d88-47d8-a8e6-c8663d20ed36' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>source :</span></dt><dd>NISAR L2 GCOV</dd><dt><span>projection :</span></dt><dd>32721</dd></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray 'HVHV' (time: 8, y: 5000, x: 5000)> Size: 2GB\ndask.array<getitem, shape=(8, 5000, 5000), dtype=float64, chunksize=(1, 2048, 2048), chunktype=numpy.ndarray>\nCoordinates:\n    frequency  <U1 4B 'A'\n  * y          (y) float64 40kB 9.7e+06 9.7e+06 9.7e+06 ... 9.6e+06 9.6e+06\n  * x          (x) float64 40kB 4e+05 4e+05 4e+05 ... 5e+05 5e+05 5e+05\n  * time       (time) datetime64[ns] 64B 2025-11-02T22:06:39 ... 2025-11-09T2...\nAttributes:\n    source:      NISAR L2 GCOV\n    projection:  32721","content_type":"text/plain"}}}],"key":"i2I04uF818"}],"key":"H8DZErQuKF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# pol = polarization.value\n# print(f'polarization: {pol}')","key":"ZbjNHuB3BH"},{"type":"output","id":"i1P6wPTjCplzd8stKYzmn","data":[],"key":"ijsrzLI7jW"}],"key":"CwVsDAcScn"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create a wildcard path to the tiffs:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iYtiPKLtaD"}],"key":"SfuX5w90za"}],"key":"rSvl1DnBG8"}],"key":"ISTjD2MDN5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# if pol == 'VV':\n#     wildcard_path = f\"{tiff_dir}/*VV*.tif*\"\n# else:\n#     wildcard_path = f\"{tiff_dir}/*VH*.tif*\"\n# print(f'wildcard_path: \\n{wildcard_path}')","key":"lfqLpDqu0a"},{"type":"output","id":"vKfxCPKGz1PPgrYIM8Vha","data":[],"key":"TRd60DFo5f"}],"key":"mtwyCdotje"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Write a function to extract the tiff dates from a wildcard path.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jZ4MV8P3M8"}],"key":"UwAhXupBnH"}],"key":"pdd9ug8pQG"}],"key":"g2LonXMbIK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# def get_date(pth):\n#     date_regex = r'(?<=_)\\d{8}(?=T\\d{6})'\n#     try:\n#         return re.search(date_regex, str(pth)).group(0)\n#     except AttributeError:\n#         raise Exception(f\"Date string not found in {pth}\")","key":"VxxmjLQ533"},{"type":"output","id":"BRENZbOqkk1Nsgpx2UsrN","data":[],"key":"bfLMWuI53P"}],"key":"thEILkX8h5"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Call get_dates() to collect the product acquisition dates:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KQLB4GARWD"}],"key":"dj2nJxgAiH"}],"key":"taiyGlWcZA"}],"key":"tB5Up68Pv2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# file_ext = None\n# if pol == 'VV':\n#     file_ext = f'*VV*.tif*'\n# else:\n#     file_ext = f'*VH*.tif*'\n\n# dates = sorted([get_date(d) for d in tiff_dir.rglob(file_ext)])\n# print(f'dates: \\n{dates}')","key":"CyhRMGdzOn"},{"type":"output","id":"SC8rLEQjWIfGjWny0yUeG","data":[],"key":"u9ORwTrne7"}],"key":"ekWJ1ZcAyQ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2. Create the VRTs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"egqzV9hwVI"}],"identifier":"id-2-create-the-vrts","label":"2. Create the VRTs","html_id":"id-2-create-the-vrts","implicit":true,"key":"yJjVUesxaM"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Create the virtual raster table for the GeoTiffs:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jNR0G4JopX"}],"key":"psK4wSvNrJ"}],"key":"SuvpPfy7y6"}],"key":"FQ2AApvTFZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# raster_path = f\"{analysis_dir}/raster_stack_{pol}.vrt\"\n# !gdalbuildvrt -separate $raster_path $wildcard_path","key":"if7z9QqcWd"},{"type":"output","id":"iPYaVLn48VgmGlQgstLWv","data":[],"key":"cLXPImH6R9"}],"key":"DYtKmRdANK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3. Define Some Python Helper Functions for this Notebook","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WF0vLP2Yy0"}],"identifier":"id-3-define-some-python-helper-functions-for-this-notebook","label":"3. Define Some Python Helper Functions for this Notebook","html_id":"id-3-define-some-python-helper-functions-for-this-notebook","implicit":true,"key":"PEn34E4nej"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We are defining two helper functions for this notebook:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gZRfHCHTd7"}],"key":"sm5k8SUvxY"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"CreateGeoTiff()","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Qqy40TYHZP"}],"key":"UTNYX0sH0V"},{"type":"text","value":" to write out images","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WcU3cXT5v2"}],"key":"pCPkQBGTCw"}],"key":"JfUD1wnhnF"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"timeseries_metrics()","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jJqEJyUXIn"}],"key":"NYr08Ngw4n"},{"type":"text","value":" to compute various metrics from a time series data stack","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"k9c6dgSvN0"}],"key":"NL5oLDBKqD"}],"key":"BxGuOVNBsT"}],"key":"biSxSS09jG"}],"key":"a795adDN49"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def create_geotiff(name, array, data_type, ndv, bandnames=None, \n                   ref_image=None, geo_t=None, projection=None):\n    # If it's a 2D image we fake a third dimension:\n    if len(array.shape) == 2:\n        array = np.array([array])\n    if ref_image == None and (geo_t == None or projection == None):\n        raise RuntimeWarning('ref_image or settings required.')\n    if bandnames != None:\n        if len(bandnames) != array.shape[0]:\n            raise RuntimeError(f'Need {Array.shape[0]} bandnames. {len(bandnames)} given')\n    else:\n        bandnames = [f'Band {i+1}' for i in range(array.shape[0])]\n    if ref_image != None:\n        refimg = gdal.Open(ref_image)\n        geo_t = refimg.GetGeoTransform()\n        Projection = refimg.GetProjection()\n    driver = gdal.GetDriverByName('GTIFF')\n    array[np.isnan(array)] = ndv\n    dataset = driver.Create(name, array.shape[2], array.shape[1], \n                            array.shape[0], data_type)\n    dataset.SetGeoTransform(geo_t)\n    dataset.SetProjection(projection)\n    for i, image in enumerate(array, 1):\n        dataset.GetRasterBand(i).WriteArray(image)\n        dataset.GetRasterBand(i).SetNoDataValue(ndv)\n        dataset.SetDescription(bandnames[i-1])\n    dataset.FlushCache()\n    return name","key":"g0ObkEWTwP"},{"type":"output","id":"hWFhQW7lbXhHhHOnqlWdd","data":[],"key":"wMXWPLo74P"}],"key":"sO9pC5YECm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"da","key":"U7QLKh5eGT"},{"type":"output","id":"l9RPhV7XiZSXsuAo8V1Uv","data":[],"key":"msheMqT1hu"}],"key":"TJgFUXuob6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# def timeseries_metrics(raster, ndv=np.nan):     \n#     # Make us of numpy nan functions\n#     # Check if type is a float array\n#     if not raster.dtype.name.find('float')>-1:\n#         raster = raster.astype(np.float64)\n#     # Set ndv to nan\n#     if not np.isnan(ndv):\n#         raster[np.equal(raster,ndv)] = np.nan\n#     # Build dictionary of the metrics\n#     tsmetrics={}\n#     rperc = np.nanpercentile(raster,[5,50,95], axis=0)\n#     tsmetrics['mean'] = np.nanmean(raster, axis=0)\n#     tsmetrics['max'] = np.nanmax(raster, axis=0)\n#     tsmetrics['min'] = np.nanmin(raster, axis=0)\n#     tsmetrics['range'] = tsmetrics['max'] - tsmetrics['min']\n#     tsmetrics['median'] = rperc[1]\n#     tsmetrics['p5'] = rperc[0]\n#     tsmetrics['p95'] = rperc[2]\n#     tsmetrics['prange'] = rperc[2]-rperc[0]\n    # tsmetrics['var'] = np.nanvar(raster, axis=0)\n    # tsmetrics['std'] = np.sqrt(tsmetrics['var'])\n    # tsmetrics['CV'] = np.abs(tsmetrics['var'] / tsmetrics['mean'])\n#     return tsmetrics","key":"LoIqk0PzMz"},{"type":"output","id":"7XhH7LuRKyp_lTeAqxj36","data":[],"key":"eLx60RWns5"}],"key":"BumAxD9ELq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def timeseries_metrics(da):     \n    q = da.quantile([0.05, 0.5, 0.95], dim=\"time\")\n    p05 = q.sel(quantile=0.05, drop=True)\n    p50 = q.sel(quantile=0.50, drop=True)\n    p95 = q.sel(quantile=0.95, drop=True)\n    prange = p95 - p05\n    \n    max = da.max(dim=\"time\")\n    min = da.min(dim=\"time\")\n    range = max - min\n\n    mean = da.mean(dim=\"time\")\n    var = da.var(dim=\"time\")\n    std = da.std(dim=\"time\")\n    cv = std / xr.where(mean != 0, mean, np.nan)\n    \n    return xr.Dataset(\n        dict(\n            min=min, max=max, range=range,\n            mean=mean, var=var, std=std, CV=cv,\n            p05=p05, p50=p50, p95=p95,\n            prange=p95 - p05\n        )\n    )","key":"G75doetOSp"},{"type":"output","id":"1KHsI2KKYIkDRUOY4D-eJ","data":[],"key":"lev0yNJB2D"}],"key":"oUXYen1FkN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"4. Create a Pandas Time Index and Display the VRT Band Dates","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dUh7ewc81M"}],"identifier":"id-4-create-a-pandas-time-index-and-display-the-vrt-band-dates","label":"4. Create a Pandas Time Index and Display the VRT Band Dates","html_id":"id-4-create-a-pandas-time-index-and-display-the-vrt-band-dates","implicit":true,"key":"RWn8SDCblx"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Create an index of timedelta64 data with Pandas:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ew804Ef2lS"}],"key":"fYKYGxqVP9"}],"key":"hyJVgK84AQ"}],"key":"A8OwffBYBn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# tindex = pd.DatetimeIndex(dates)","key":"dviZBfxRWI"},{"type":"output","id":"_BDccXhfH5dJxC5dafBGR","data":[],"key":"FpZITGVhTs"}],"key":"MIVctNZRaD"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Print the bands and dates for all images in the virtual raster table (VRT):","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jLyGMZyBGy"}],"key":"cFJCuOGrMG"}],"key":"E3bTS6wGKo"}],"key":"xMP3uTQmi7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# j = 1\n# print(f\"Bands and dates for {raster_path}\")\n# for i in tindex:\n#     print(\"{:4d} {}\".format(j, i.date()), end=' ')\n#     j += 1\n#     if j%5 == 1:\n#         print()","key":"t8wU56dEJz"},{"type":"output","id":"xZ1B6KkMePZWpKyIjuyre","data":[],"key":"bAdpHQBP8o"}],"key":"nASbzUq4SZ"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OjWX8pzudw"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"4. Create a Time Series Animation to get an Idea of the Dynamics at the Site","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ZypIbkEoRh"}],"identifier":"id-4-create-a-time-series-animation-to-get-an-idea-of-the-dynamics-at-the-site","label":"4. Create a Time Series Animation to get an Idea of the Dynamics at the Site","html_id":"id-4-create-a-time-series-animation-to-get-an-idea-of-the-dynamics-at-the-site","implicit":true,"key":"jnWcrjj1pU"},{"type":"heading","depth":3,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"4.1 Load Time Series Stack","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"qxts4iEuOk"}],"identifier":"id-4-1-load-time-series-stack","label":"4.1 Load Time Series Stack","html_id":"id-4-1-load-time-series-stack","implicit":true,"key":"vtNDjaO8Px"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Now we are ready to create a time series animation from the calibrated SAR data.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"QGLYkFj5lL"}],"key":"jFxJfk1xsh"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"First, create a raster from band 0 and a raster stack from all the images:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"uxdjeDrojC"}],"key":"JN2gneAfW8"}],"key":"Eh3GHXOfkI"}],"key":"e2IyYEWBIu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# img = gdal.Open(raster_path)\n# band = img.GetRasterBand(1)\n# raster0 = band.ReadAsArray()\n# band_number = 0 # Needed for updates\n# rasterstack = img.ReadAsArray()","key":"xN6c220rz7"},{"type":"output","id":"sU_jmAipcjCMZDmEWJkaY","data":[],"key":"YdIR7ghk8j"}],"key":"NSGqkR7Knv"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Print the bands, pixels, and lines:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GwDtPOrmwb"}],"key":"kavqDZezMw"}],"key":"yf99NMbS0d"}],"key":"g5KCZaH9ZO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# print(f\"Number of  bands: {img.RasterCount}\")\n# print(f\"Number of pixels: {img.RasterXSize}\")\n# print(f\"Number of  lines: {img.RasterYSize}\")","key":"QKAvhu8gYl"},{"type":"output","id":"_dZzPgeM74aiU-yiK-ylS","data":[],"key":"ZV64TYybWs"}],"key":"bIxuqy7oUg"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"4.2 Data Conversion between dB and Power Scales","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v2rjxIYQOl"}],"identifier":"id-4-2-data-conversion-between-db-and-power-scales","label":"4.2 Data Conversion between dB and Power Scales","html_id":"id-4-2-data-conversion-between-db-and-power-scales","implicit":true,"key":"tXcpJOt86t"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The data at hand are radiometrically terrain corrected images, which are often expressed as terrain flattened ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CXmFpm123y"},{"type":"inlineMath","value":"\\gamma^0","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>γ</mi><mn>0</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\gamma^0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0085em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span></span></span></span>","key":"GhHvNprSzs"},{"type":"text","value":" backscattering coefficients. For forest and land cover monitoring applications ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qANTHmigos"},{"type":"inlineMath","value":"\\gamma^0","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>γ</mi><mn>0</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\gamma^0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0085em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span></span></span></span>","key":"ucLvznOTb9"},{"type":"text","value":" is the preferred metric.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"haYtSUQCow"}],"key":"RSqpkwVP6K"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"To use a logarithmic scale instead of the natural power scale, ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Xbe8tixXoi"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"you can set the following variable to True:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TTH2MaT74T"}],"key":"bA7KDcuSM4"}],"key":"OilvnKojKq"}],"key":"IHiaVF0bb9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# todB = True\n\n# labeldB = 'dB' if todB else 'linear'\n\n# def convert(raster, todB=todB):\n#     if todB:\n#         return 10 * np.ma.log10(raster)\n#     else:\n#         return raster","key":"jM75qd3dIF"},{"type":"output","id":"QCNfr0WUURB9UFEq7LHCZ","data":[],"key":"rEPhhzJiTr"}],"key":"iURIY9SBiL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nda_db = 10*np.log10(da)\nda_db","key":"gjevVPZJMK"},{"type":"output","id":"otDjo2fsjHgMb-DIP_ndc","data":[{"name":"stdout","output_type":"stream","text":"CPU times: user 1.85 ms, sys: 0 ns, total: 1.85 ms\nWall time: 1.85 ms\n"},{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;HVHV&#x27; (time: 8, y: 5000, x: 5000)&gt; Size: 2GB\ndask.array&lt;mul, shape=(8, 5000, 5000), dtype=float64, chunksize=(1, 2048, 2048), chunktype=numpy.ndarray&gt;\nCoordinates:\n    frequency  &lt;U1 4B &#x27;A&#x27;\n  * y          (y) float64 40kB 9.7e+06 9.7e+06 9.7e+06 ... 9.6e+06 9.6e+06\n  * x          (x) float64 40kB 4e+05 4e+05 4e+05 ... 5e+05 5e+05 5e+05\n  * time       (time) datetime64[ns] 64B 2025-11-02T22:06:39 ... 2025-11-09T2...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'HVHV'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 8</li><li><span class='xr-has-index'>y</span>: 5000</li><li><span class='xr-has-index'>x</span>: 5000</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-ddc502df-8d91-4d10-b478-b6bf659a05ca' class='xr-array-in' type='checkbox' checked><label for='section-ddc502df-8d91-4d10-b478-b6bf659a05ca' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(1, 212, 656), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>\n    <tr>\n        <td>\n            <table style=\"border-collapse: collapse;\">\n                <thead>\n                    <tr>\n                        <td> </td>\n                        <th> Array </th>\n                        <th> Chunk </th>\n                    </tr>\n                </thead>\n                <tbody>\n                    \n                    <tr>\n                        <th> Bytes </th>\n                        <td> 1.49 GiB </td>\n                        <td> 32.00 MiB </td>\n                    </tr>\n                    \n                    <tr>\n                        <th> Shape </th>\n                        <td> (8, 5000, 5000) </td>\n                        <td> (1, 2048, 2048) </td>\n                    </tr>\n                    <tr>\n                        <th> Dask graph </th>\n                        <td colspan=\"2\"> 128 chunks in 58 graph layers </td>\n                    </tr>\n                    <tr>\n                        <th> Data type </th>\n                        <td colspan=\"2\"> float64 numpy.ndarray </td>\n                    </tr>\n                </tbody>\n            </table>\n        </td>\n        <td>\n        <svg width=\"194\" height=\"184\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n\n  <!-- Horizontal lines -->\n  <line x1=\"10\" y1=\"0\" x2=\"24\" y2=\"14\" style=\"stroke-width:2\" />\n  <line x1=\"10\" y1=\"5\" x2=\"24\" y2=\"20\" />\n  <line x1=\"10\" y1=\"54\" x2=\"24\" y2=\"69\" />\n  <line x1=\"10\" y1=\"103\" x2=\"24\" y2=\"118\" />\n  <line x1=\"10\" y1=\"120\" x2=\"24\" y2=\"134\" style=\"stroke-width:2\" />\n\n  <!-- Vertical lines -->\n  <line x1=\"10\" y1=\"0\" x2=\"10\" y2=\"120\" style=\"stroke-width:2\" />\n  <line x1=\"11\" y1=\"1\" x2=\"11\" y2=\"121\" />\n  <line x1=\"13\" y1=\"3\" x2=\"13\" y2=\"123\" />\n  <line x1=\"15\" y1=\"5\" x2=\"15\" y2=\"125\" />\n  <line x1=\"17\" y1=\"7\" x2=\"17\" y2=\"127\" />\n  <line x1=\"19\" y1=\"9\" x2=\"19\" y2=\"129\" />\n  <line x1=\"21\" y1=\"11\" x2=\"21\" y2=\"131\" />\n  <line x1=\"23\" y1=\"13\" x2=\"23\" y2=\"133\" />\n  <line x1=\"24\" y1=\"14\" x2=\"24\" y2=\"134\" style=\"stroke-width:2\" />\n\n  <!-- Colored Rectangle -->\n  <polygon points=\"10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,134.9485979497544 10.0,120.0\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n\n  <!-- Horizontal lines -->\n  <line x1=\"10\" y1=\"0\" x2=\"130\" y2=\"0\" style=\"stroke-width:2\" />\n  <line x1=\"11\" y1=\"1\" x2=\"131\" y2=\"1\" />\n  <line x1=\"13\" y1=\"3\" x2=\"133\" y2=\"3\" />\n  <line x1=\"15\" y1=\"5\" x2=\"135\" y2=\"5\" />\n  <line x1=\"17\" y1=\"7\" x2=\"137\" y2=\"7\" />\n  <line x1=\"19\" y1=\"9\" x2=\"139\" y2=\"9\" />\n  <line x1=\"21\" y1=\"11\" x2=\"141\" y2=\"11\" />\n  <line x1=\"23\" y1=\"13\" x2=\"143\" y2=\"13\" />\n  <line x1=\"24\" y1=\"14\" x2=\"144\" y2=\"14\" style=\"stroke-width:2\" />\n\n  <!-- Vertical lines -->\n  <line x1=\"10\" y1=\"0\" x2=\"24\" y2=\"14\" style=\"stroke-width:2\" />\n  <line x1=\"25\" y1=\"0\" x2=\"40\" y2=\"14\" />\n  <line x1=\"74\" y1=\"0\" x2=\"89\" y2=\"14\" />\n  <line x1=\"124\" y1=\"0\" x2=\"138\" y2=\"14\" />\n  <line x1=\"130\" y1=\"0\" x2=\"144\" y2=\"14\" style=\"stroke-width:2\" />\n\n  <!-- Colored Rectangle -->\n  <polygon points=\"10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n\n  <!-- Horizontal lines -->\n  <line x1=\"24\" y1=\"14\" x2=\"144\" y2=\"14\" style=\"stroke-width:2\" />\n  <line x1=\"24\" y1=\"20\" x2=\"144\" y2=\"20\" />\n  <line x1=\"24\" y1=\"69\" x2=\"144\" y2=\"69\" />\n  <line x1=\"24\" y1=\"118\" x2=\"144\" y2=\"118\" />\n  <line x1=\"24\" y1=\"134\" x2=\"144\" y2=\"134\" style=\"stroke-width:2\" />\n\n  <!-- Vertical lines -->\n  <line x1=\"24\" y1=\"14\" x2=\"24\" y2=\"134\" style=\"stroke-width:2\" />\n  <line x1=\"40\" y1=\"14\" x2=\"40\" y2=\"134\" />\n  <line x1=\"89\" y1=\"14\" x2=\"89\" y2=\"134\" />\n  <line x1=\"138\" y1=\"14\" x2=\"138\" y2=\"134\" />\n  <line x1=\"144\" y1=\"14\" x2=\"144\" y2=\"134\" style=\"stroke-width:2\" />\n\n  <!-- Colored Rectangle -->\n  <polygon points=\"24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,134.9485979497544 24.9485979497544,134.9485979497544\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n\n  <!-- Text -->\n  <text x=\"84.948598\" y=\"154.948598\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >5000</text>\n  <text x=\"164.948598\" y=\"74.948598\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(-90,164.948598,74.948598)\">5000</text>\n  <text x=\"7.474299\" y=\"147.474299\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(45,7.474299,147.474299)\">8</text>\n</svg>\n        </td>\n    </tr>\n</table></div></div></li><li class='xr-section-item'><input id='section-238992eb-cc01-44b4-9fba-9123eb60f096' class='xr-section-summary-in' type='checkbox'  checked><label for='section-238992eb-cc01-44b4-9fba-9123eb60f096' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>frequency</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;A&#x27;</div><input id='attrs-a48be088-2152-40dd-8074-d2c73865d48b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a48be088-2152-40dd-8074-d2c73865d48b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b27d11bb-90b8-459b-970c-744b02649704' class='xr-var-data-in' type='checkbox'><label for='data-b27d11bb-90b8-459b-970c-744b02649704' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(&#x27;A&#x27;, dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>9.7e+06 9.7e+06 ... 9.6e+06 9.6e+06</div><input id='attrs-70b41817-84cd-4758-b507-231f0007166c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-70b41817-84cd-4758-b507-231f0007166c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e8abe9ce-3bc7-4401-9d33-fab9e189d88f' class='xr-var-data-in' type='checkbox'><label for='data-e8abe9ce-3bc7-4401-9d33-fab9e189d88f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([9699990., 9699970., 9699950., ..., 9600050., 9600030., 9600010.],\n      shape=(5000,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4e+05 4e+05 4e+05 ... 5e+05 5e+05</div><input id='attrs-96f264ad-d0fa-4438-954b-a8b070daa5eb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-96f264ad-d0fa-4438-954b-a8b070daa5eb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fdd80336-6724-40bb-8bea-623580935448' class='xr-var-data-in' type='checkbox'><label for='data-fdd80336-6724-40bb-8bea-623580935448' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([400010., 400030., 400050., ..., 499950., 499970., 499990.],\n      shape=(5000,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2025-11-02T22:06:39 ... 2025-11-...</div><input id='attrs-01e76313-7e4f-4e42-bcd0-a9a6b3e3063b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-01e76313-7e4f-4e42-bcd0-a9a6b3e3063b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ddf2b624-98b9-41b5-8def-7916de215efa' class='xr-var-data-in' type='checkbox'><label for='data-ddf2b624-98b9-41b5-8def-7916de215efa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2025-11-02T22:06:39.000000000&#x27;, &#x27;2025-11-03T22:06:39.000000000&#x27;,\n       &#x27;2025-11-04T22:06:39.000000000&#x27;, &#x27;2025-11-05T22:06:39.000000000&#x27;,\n       &#x27;2025-11-06T22:06:39.000000000&#x27;, &#x27;2025-11-07T22:06:39.000000000&#x27;,\n       &#x27;2025-11-08T22:06:39.000000000&#x27;, &#x27;2025-11-09T22:06:39.000000000&#x27;],\n      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f0fb2123-fc0e-4b22-9fa0-c682cededa20' class='xr-section-summary-in' type='checkbox'  ><label for='section-f0fb2123-fc0e-4b22-9fa0-c682cededa20' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-fc59d5b2-69a9-4b89-b62e-b2ca46241516' class='xr-index-data-in' type='checkbox'/><label for='index-fc59d5b2-69a9-4b89-b62e-b2ca46241516' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([9699990.0, 9699970.0, 9699950.0, 9699930.0, 9699910.0, 9699890.0,\n       9699870.0, 9699850.0, 9699830.0, 9699810.0,\n       ...\n       9600190.0, 9600170.0, 9600150.0, 9600130.0, 9600110.0, 9600090.0,\n       9600070.0, 9600050.0, 9600030.0, 9600010.0],\n      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=5000))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-7574224f-b9d0-4da9-acfb-b6904ad832a9' class='xr-index-data-in' type='checkbox'/><label for='index-7574224f-b9d0-4da9-acfb-b6904ad832a9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([400010.0, 400030.0, 400050.0, 400070.0, 400090.0, 400110.0, 400130.0,\n       400150.0, 400170.0, 400190.0,\n       ...\n       499810.0, 499830.0, 499850.0, 499870.0, 499890.0, 499910.0, 499930.0,\n       499950.0, 499970.0, 499990.0],\n      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=5000))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-33780c8e-c811-4c85-a903-ab03b7ddf63c' class='xr-index-data-in' type='checkbox'/><label for='index-33780c8e-c811-4c85-a903-ab03b7ddf63c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2025-11-02 22:06:39&#x27;, &#x27;2025-11-03 22:06:39&#x27;,\n               &#x27;2025-11-04 22:06:39&#x27;, &#x27;2025-11-05 22:06:39&#x27;,\n               &#x27;2025-11-06 22:06:39&#x27;, &#x27;2025-11-07 22:06:39&#x27;,\n               &#x27;2025-11-08 22:06:39&#x27;, &#x27;2025-11-09 22:06:39&#x27;],\n              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=&#x27;D&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-15692636-44c8-4c9a-8c17-3d0819aec0a3' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-15692636-44c8-4c9a-8c17-3d0819aec0a3' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray 'HVHV' (time: 8, y: 5000, x: 5000)> Size: 2GB\ndask.array<mul, shape=(8, 5000, 5000), dtype=float64, chunksize=(1, 2048, 2048), chunktype=numpy.ndarray>\nCoordinates:\n    frequency  <U1 4B 'A'\n  * y          (y) float64 40kB 9.7e+06 9.7e+06 9.7e+06 ... 9.6e+06 9.6e+06\n  * x          (x) float64 40kB 4e+05 4e+05 4e+05 ... 5e+05 5e+05 5e+05\n  * time       (time) datetime64[ns] 64B 2025-11-02T22:06:39 ... 2025-11-09T2...","content_type":"text/plain"}}}],"key":"o7jF1dizRh"}],"key":"KwbzrGbDUF"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"4.3 Create Time Series Animation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kQHXsEtHSO"}],"identifier":"id-4-3-create-time-series-animation","label":"4.3 Create Time Series Animation","html_id":"id-4-3-create-time-series-animation","implicit":true,"key":"MNWL6nmNdI"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Create and move into a directory in which to store our plots and animations:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DTm7s5nQ2t"}],"key":"pgf736GaOn"}],"key":"wrFEZDTxM2"}],"key":"gkHDf1ad83"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# product_path = analysis_dir/f'plots_and_animations'\n\n# if not product_path.exists():\n#     print(f'{product_path} created')\n#     product_path.mkdir()","key":"GRLhww4AnQ"},{"type":"output","id":"LOMAIQmLduUMrU7HcbDGT","data":[],"key":"iOCt1V45h6"}],"key":"AcONLzgOxQ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we can ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Yz7zyWLARf"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"create the information needed to animate our data:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YoQmW4ivWk"}],"key":"JQPvxR3gkk"}],"key":"b9NQhmIt4u"}],"key":"lXKmeRW1Pb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nfrom matplotlib import pyplot as plt\nfrom matplotlib.animation import FuncAnimation\nfrom matplotlib.animation import FFMpegWriter, PillowWriter\n\nvmin, vmax = (da_db.quantile([0.05, 0.95], skipna=True).values.astype(float))\n\nfig, ax = plt.subplots(figsize=(6, 6))\nframe_0 = da_db.isel(time=0).values\nim = ax.imshow(frame_0, vmin=vmin, vmax=vmax, origin=\"upper\", cmap=\"grey\")\ncb = fig.colorbar(im, ax=ax, label=\"γ⁰ (dB)\")\nax.set_title(np.datetime_as_string(da_db.time.values[0], unit='s'))\nax.set_axis_off()\n\ndef animate(i):\n    frame = da_db.isel(time=i).values\n    im.set_data(frame)\n    ax.set_title(np.datetime_as_string(da_db.time.values[i], unit='s'))\n    return (im,)\n\nani = FuncAnimation(fig, animate, frames=da_db.sizes[\"time\"], interval=300, blit=False)\n\nplt.show()","key":"AzriAGj1k8"},{"type":"output","id":"0lkBeSrIQbGatxR5FovIB","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d022eab9578ec221e699aa3dc4ae40b0","path":"/NISAR_GCOV_Cookbook/build/d022eab9578ec221e699aa3dc4ae40b0.png"},"text/plain":{"content":"<Figure size 600x600 with 2 Axes>","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"CPU times: user 25.2 s, sys: 3.47 s, total: 28.7 s\nWall time: 23.2 s\n"}],"key":"Z0vCCfhErP"}],"key":"bEIM8JmsOA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from IPython.display import HTML\n\nHTML(ani.to_jshtml())","key":"H3gUw1pMyT"},{"type":"output","id":"4XzV52pKKI8LmuNTWlhE8","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"b2878a979469f0075c2ab9ba661b91f0","path":"/NISAR_GCOV_Cookbook/build/b2878a979469f0075c2ab9ba661b91f0.html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}}],"key":"Bcr6rP61QR"}],"key":"z6SOQ2Davg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# %%capture \n# fig = plt.figure(figsize=(10, 5))\n# ax = fig.subplots()\n# ax.axis('off')\n\n# copyRaster = np.copy(convert(rasterstack))\n# vmin = np.nanpercentile(copyRaster, 1)\n# vmax = np.nanpercentile(copyRaster, 99)\n\n# im = ax.imshow(convert(raster0), cmap='inferno', vmin=vmin, vmax=vmax)\n# cbar = fig.colorbar(im)\n# cbar.set_label(labeldB)\n# ax.set_title(\"{}\".format(tindex[0].date()))\n# plt.rcParams.update({'font.size': 14})\n\n# def animate(i):\n#     ax.set_title(\"{}\".format(tindex[i].date()))\n#     im.set_data(convert(rasterstack[i]))\n\n# # Interval is given in milliseconds\n# ani = animation.FuncAnimation(fig, animate, frames=rasterstack.shape[0], interval=300)","key":"OWgfX3bZMG"},{"type":"output","id":"t0FuN7uQHBRGZ05Tc5FQK","data":[],"key":"cT1ibhcrN6"}],"key":"JKs3l5SytP"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Configure matplotlib’s RC settings for the animation:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KMNS0EbmYX"}],"key":"qs736SJWmK"}],"key":"n7gzu8m7yq"}],"key":"w4cSxH17ht"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# rc('animation', embed_limit=40971520.0)  # We need to increase the limit maybe to show the entire animation","key":"D9Z5fWgfe8"},{"type":"output","id":"tCo0els0KT6QcD1_3z0cr","data":[],"key":"Tfem2bKIYU"}],"key":"ZQbI56O93o"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create a javascript animation of the time-series running inline in the notebook:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aoacLs1nNi"}],"key":"CR5C1fcbMe"}],"key":"JnE5N4gn03"}],"key":"gnAokawNVG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# HTML(ani.to_jshtml())","key":"SUIq2GZLxu"},{"type":"output","id":"apCPIa6QISt1U5nuNZZ9r","data":[],"key":"oxxPjm33cm"}],"key":"rJ4KQpITvQ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Delete the dummy png that was saved to the current working directory while generating the javascript animation in the last code cell.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xCNragKw8a"}],"key":"KlDjrItrha"}],"key":"i2YDai5oAa"}],"key":"sBwvGYttcP"},{"type":"block","kind":"notebook-code","data":{"hide_input":false},"children":[{"type":"code","lang":"python","executable":true,"value":"# try:\n#     Path('/home/jovyan/notebooks/SAR_Training/English/Master/None0000000.png').unlink()\n# except FileNotFoundError:\n#     pass","key":"mwNmNmPf9w"},{"type":"output","id":"7jctgqa7pRMWDduCfXrRo","data":[],"key":"N7DtsubPsd"}],"key":"tWefmXYhnU"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Save the animation (animation.gif):","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nhegZ1FVqO"}],"key":"lC952nsczP"}],"key":"zumlYi7vJh"}],"key":"wgyJ5nNr2I"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ani.save(plot_dir/f'animation.gif', writer='pillow', fps=2)","key":"A6zzSmbjY7"},{"type":"output","id":"BYb-Bg8M71BVAm-66s7O8","data":[],"key":"mPANoshHLW"}],"key":"VNonN7zFk0"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"S8gnhwUaCD"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"5. Computation and Visualization of Time Series Metrics","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ZU1iLs9A2s"}],"identifier":"id-5-computation-and-visualization-of-time-series-metrics","label":"5. Computation and Visualization of Time Series Metrics","html_id":"id-5-computation-and-visualization-of-time-series-metrics","implicit":true,"key":"ObeeYt7agH"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Once a time-series was constructed, we can compute ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"sjgp5E7qGr"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"a set of metrics","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"iKl88r5JAB"}],"key":"ALnopa7CP5"},{"type":"text","value":" for each pixel in the stack:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"uCQ8Y2mNcK"}],"key":"NYAT20Mrx1"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Mean","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"lOlPtxOD7t"}],"key":"Xrl17UbWZK"}],"key":"msrogUwGYQ"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Median","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"vPKDVtaYcR"}],"key":"YPXo7spQWH"}],"key":"Jo3HfMJqXe"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Maximum","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"hm7LG2N74K"}],"key":"vgHsbGODgR"}],"key":"lVSsalOEN8"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Minimum","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"GLR3ZfLwD4"}],"key":"seQvnBy1fB"}],"key":"G8GtXUkPNM"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Range (Maximum - Minimum)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"aATx3CEy0O"}],"key":"HkfWeESjgl"}],"key":"MWO02FXAo4"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"5th Percentile","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"KcY7OUXFFx"}],"key":"rB9XcozWb0"}],"key":"jh3nLi84Bp"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"95th Percentile","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"jJJ0rCZHRa"}],"key":"y85lUwHTBU"}],"key":"UE4RhuCKYs"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"PRange (95th - 5th Percentile)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"ayYzeRM4PD"}],"key":"vbKrnnhEdD"}],"key":"EbYsif6zt0"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Variance","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"J4zz3qfSGd"}],"key":"Od2w9hpGxl"}],"key":"EZdGMAs07x"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Coefficient of Variation (Variance/Mean)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"jIgv1C9XBb"}],"key":"ylBgtUxz3t"}],"key":"iz0jJ7Slxk"}],"key":"WSpDQTOuHc"},{"type":"thematicBreak","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"ldmpaz30Ow"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"First, we ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"pcBMFYIcFt"},{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"mask out pixels","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"QT87Hy0fsM"}],"key":"DreGD4cPDP"},{"type":"text","value":" that are zero (e.g. beyond the edge of the swath). Then we ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"XfFl4uslug"},{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"calculate the time series metrics:","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"VdACcIo0xE"}],"key":"C7IfO0LVnh"}],"key":"I016UDnCmE"}],"key":"Blj0vEvH8A"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# mask = (rasterstack == 0)\n# raster = np.ma.array(convert(rasterstack), mask=mask, dtype=np.float64)","key":"XdeUI19s60"},{"type":"output","id":"XEz5S8BlXsLSB3ZlsNq2N","data":[],"key":"n5NFn2oNGV"}],"key":"ORiIqe53gv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"Iov9cX57UW"},{"type":"output","id":"uzCWqYvI_BkSC7nKVGlfi","data":[],"key":"rmYZPNBcQ0"}],"key":"brt8kFOQiw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n# calc metric in power\nmetrics = timeseries_metrics(da)\nmetrics.load()\nmetrics","key":"JLv58EB2r1"},{"type":"output","id":"fe0Lfh6aaXNejirbf-uMa","data":[{"name":"stdout","output_type":"stream","text":"CPU times: user 1min 24s, sys: 18.6 s, total: 1min 42s\nWall time: 56.2 s\n"},{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"5c9c008e07c25b1adad63c1b2e6b829c","path":"/NISAR_GCOV_Cookbook/build/5c9c008e07c25b1adad63c1b2e6b829c.html"},"text/plain":{"content":"<xarray.Dataset> Size: 2GB\nDimensions:    (y: 5000, x: 5000)\nCoordinates:\n    frequency  <U1 4B 'A'\n  * y          (y) float64 40kB 9.7e+06 9.7e+06 9.7e+06 ... 9.6e+06 9.6e+06\n  * x          (x) float64 40kB 4e+05 4e+05 4e+05 ... 5e+05 5e+05 5e+05\nData variables:\n    min        (y, x) float64 200MB 2.867e-08 2.171e-08 ... 7.217e-08 9.814e-08\n    max        (y, x) float64 200MB 5.238e-08 3.967e-08 ... 1.318e-07 1.793e-07\n    range      (y, x) float64 200MB 2.371e-08 1.795e-08 ... 5.967e-08 8.114e-08\n    mean       (y, x) float64 200MB 4.053e-08 3.069e-08 ... 1.02e-07 1.387e-07\n    var        (y, x) float64 200MB 6.467e-17 3.709e-17 ... 4.097e-16 7.575e-16\n    std        (y, x) float64 200MB 8.041e-09 6.09e-09 ... 2.024e-08 2.752e-08\n    CV         (y, x) float64 200MB 0.1984 0.1984 0.1984 ... 0.1984 0.1984\n    p05        (y, x) float64 200MB 2.949e-08 2.234e-08 ... 7.424e-08 1.009e-07\n    p50        (y, x) float64 200MB 4.053e-08 3.069e-08 ... 1.02e-07 1.387e-07\n    p95        (y, x) float64 200MB 5.156e-08 3.905e-08 ... 1.298e-07 1.765e-07\n    prange     (y, x) float64 200MB 2.206e-08 1.671e-08 ... 5.553e-08 7.551e-08","content_type":"text/plain"}}}],"key":"kLbZL5rV2J"}],"key":"iLtVc5PwCd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# metrics.keys()","key":"f9soDmJMbs"},{"type":"output","id":"al6N6xuyqMNpMxENYYGMH","data":[],"key":"dIVxzQGUzI"}],"key":"yp5ozDNGL3"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s look at the histograms for the time series variance and coeficient of variation to aid displaying those images:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KwKzGLW9qT"}],"key":"teueJKEZGM"}],"key":"UvgUJpEblT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# fig, ax = plt.subplots(1,2,figsize=(16,4))\n# ax[0].hist(metrics['var'].flatten(), bins=100, range=np.nanpercentile(metrics['var'], [1,99]))\n# ax[1].hist(metrics['CV'].flatten(), bins=100, range=np.nanpercentile(metrics['CV'], [1,99]))\n# _ = ax[0].set_title('Variance')\n# _ = ax[1].set_title('Coefficient of Variation')","key":"GFFz5ZxMaM"},{"type":"output","id":"fcHLgQm0bQlUkMp9lK_I9","data":[],"key":"nT6yH25m73"}],"key":"Biv2v4tTmR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"np.min(cv)","key":"VnOXCbLpYG"},{"type":"output","id":"tpBw-tDylkr6bcxgFdCY8","data":[],"key":"uJiIivIEod"}],"key":"yJo1ecGXeY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"np.max(cv)","key":"SRL8EAZ8zl"},{"type":"output","id":"NTzxwPXAnTR0O5Tp5Y9uA","data":[],"key":"CTwJnQwiqY"}],"key":"QIhXpsmAxO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"len(cv)","key":"QNinnWnn5F"},{"type":"output","id":"qHALc2ObFDTe-WkqNBUcX","data":[],"key":"kIh1RJ10Eb"}],"key":"IYrIgB9YRT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib import pyplot as plt\n\nfig, ax = plt.subplots(1,2,figsize=(9, 3))\n\nvar = metrics[\"var\"].values.ravel()\nax[0].hist(var, bins=100, range=np.nanpercentile(var, [1,99]))\nax[0].set_title('Variance')\n\ncv = metrics[\"CV\"].values.ravel()\nax[1].hist(cv, bins=100, range=np.nanpercentile(cv, [1,99]))\nax[1].set_title('Coefficient of Variation')\n\nplt.show()","key":"DYtVomddrS"},{"type":"output","id":"a2_7dJspXoF4XKjs24syF","data":[{"ename":"ValueError","evalue":"Too many bins for data range. Cannot create 100 finite-sized bins.","output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mValueError\u001b[39m                                Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[12]\u001b[39m\u001b[32m, line 10\u001b[39m\n\u001b[32m      7\u001b[39m ax[\u001b[32m0\u001b[39m].set_title(\u001b[33m'\u001b[39m\u001b[33mVariance\u001b[39m\u001b[33m'\u001b[39m)\n\u001b[32m      9\u001b[39m cv = metrics[\u001b[33m\"\u001b[39m\u001b[33mCV\u001b[39m\u001b[33m\"\u001b[39m].values.ravel()\n\u001b[32m---> \u001b[39m\u001b[32m10\u001b[39m \u001b[43max\u001b[49m\u001b[43m[\u001b[49m\u001b[32;43m1\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m.\u001b[49m\u001b[43mhist\u001b[49m\u001b[43m(\u001b[49m\u001b[43mcv\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mbins\u001b[49m\u001b[43m=\u001b[49m\u001b[32;43m100\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mrange\u001b[39;49m\u001b[43m=\u001b[49m\u001b[43mnp\u001b[49m\u001b[43m.\u001b[49m\u001b[43mnanpercentile\u001b[49m\u001b[43m(\u001b[49m\u001b[43mcv\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m[\u001b[49m\u001b[32;43m1\u001b[39;49m\u001b[43m,\u001b[49m\u001b[32;43m99\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     11\u001b[39m ax[\u001b[32m1\u001b[39m].set_title(\u001b[33m'\u001b[39m\u001b[33mCoefficient of Variation\u001b[39m\u001b[33m'\u001b[39m)\n\u001b[32m     13\u001b[39m plt.show()\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/_api/deprecation.py:453\u001b[39m, in \u001b[36mmake_keyword_only.<locals>.wrapper\u001b[39m\u001b[34m(*args, **kwargs)\u001b[39m\n\u001b[32m    447\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mlen\u001b[39m(args) > name_idx:\n\u001b[32m    448\u001b[39m     warn_deprecated(\n\u001b[32m    449\u001b[39m         since, message=\u001b[33m\"\u001b[39m\u001b[33mPassing the \u001b[39m\u001b[38;5;132;01m%(name)s\u001b[39;00m\u001b[33m \u001b[39m\u001b[38;5;132;01m%(obj_type)s\u001b[39;00m\u001b[33m \u001b[39m\u001b[33m\"\u001b[39m\n\u001b[32m    450\u001b[39m         \u001b[33m\"\u001b[39m\u001b[33mpositionally is deprecated since Matplotlib \u001b[39m\u001b[38;5;132;01m%(since)s\u001b[39;00m\u001b[33m; the \u001b[39m\u001b[33m\"\u001b[39m\n\u001b[32m    451\u001b[39m         \u001b[33m\"\u001b[39m\u001b[33mparameter will become keyword-only in \u001b[39m\u001b[38;5;132;01m%(removal)s\u001b[39;00m\u001b[33m.\u001b[39m\u001b[33m\"\u001b[39m,\n\u001b[32m    452\u001b[39m         name=name, obj_type=\u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[33mparameter of \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mfunc.\u001b[34m__name__\u001b[39m\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m()\u001b[39m\u001b[33m\"\u001b[39m)\n\u001b[32m--> \u001b[39m\u001b[32m453\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mfunc\u001b[49m\u001b[43m(\u001b[49m\u001b[43m*\u001b[49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/__init__.py:1524\u001b[39m, in \u001b[36m_preprocess_data.<locals>.inner\u001b[39m\u001b[34m(ax, data, *args, **kwargs)\u001b[39m\n\u001b[32m   1521\u001b[39m \u001b[38;5;129m@functools\u001b[39m.wraps(func)\n\u001b[32m   1522\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34minner\u001b[39m(ax, *args, data=\u001b[38;5;28;01mNone\u001b[39;00m, **kwargs):\n\u001b[32m   1523\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m data \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[32m-> \u001b[39m\u001b[32m1524\u001b[39m         \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mfunc\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m   1525\u001b[39m \u001b[43m            \u001b[49m\u001b[43max\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1526\u001b[39m \u001b[43m            \u001b[49m\u001b[43m*\u001b[49m\u001b[38;5;28;43mmap\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43mcbook\u001b[49m\u001b[43m.\u001b[49m\u001b[43msanitize_sequence\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43margs\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1527\u001b[39m \u001b[43m            \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43m{\u001b[49m\u001b[43mk\u001b[49m\u001b[43m:\u001b[49m\u001b[43m \u001b[49m\u001b[43mcbook\u001b[49m\u001b[43m.\u001b[49m\u001b[43msanitize_sequence\u001b[49m\u001b[43m(\u001b[49m\u001b[43mv\u001b[49m\u001b[43m)\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mfor\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mk\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mv\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;129;43;01min\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m.\u001b[49m\u001b[43mitems\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m}\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   1529\u001b[39m     bound = new_sig.bind(ax, *args, **kwargs)\n\u001b[32m   1530\u001b[39m     auto_label = (bound.arguments.get(label_namer)\n\u001b[32m   1531\u001b[39m                   \u001b[38;5;129;01mor\u001b[39;00m bound.kwargs.get(label_namer))\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/axes/_axes.py:7132\u001b[39m, in \u001b[36mAxes.hist\u001b[39m\u001b[34m(self, x, bins, range, density, weights, cumulative, bottom, histtype, align, orientation, rwidth, log, color, label, stacked, **kwargs)\u001b[39m\n\u001b[32m   7128\u001b[39m \u001b[38;5;66;03m# Loop through datasets\u001b[39;00m\n\u001b[32m   7129\u001b[39m \u001b[38;5;28;01mfor\u001b[39;00m i \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(nx):\n\u001b[32m   7130\u001b[39m     \u001b[38;5;66;03m# this will automatically overwrite bins,\u001b[39;00m\n\u001b[32m   7131\u001b[39m     \u001b[38;5;66;03m# so that each histogram uses the same bins\u001b[39;00m\n\u001b[32m-> \u001b[39m\u001b[32m7132\u001b[39m     m, bins = \u001b[43mnp\u001b[49m\u001b[43m.\u001b[49m\u001b[43mhistogram\u001b[49m\u001b[43m(\u001b[49m\u001b[43mx\u001b[49m\u001b[43m[\u001b[49m\u001b[43mi\u001b[49m\u001b[43m]\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mbins\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mweights\u001b[49m\u001b[43m=\u001b[49m\u001b[43mw\u001b[49m\u001b[43m[\u001b[49m\u001b[43mi\u001b[49m\u001b[43m]\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mhist_kwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   7133\u001b[39m     tops.append(m)\n\u001b[32m   7134\u001b[39m tops = np.array(tops, \u001b[38;5;28mfloat\u001b[39m)  \u001b[38;5;66;03m# causes problems later if it's an int\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/numpy/lib/_histograms_impl.py:792\u001b[39m, in \u001b[36mhistogram\u001b[39m\u001b[34m(a, bins, range, density, weights)\u001b[39m\n\u001b[32m    687\u001b[39m \u001b[38;5;250m\u001b[39m\u001b[33mr\u001b[39m\u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m    688\u001b[39m \u001b[33;03mCompute the histogram of a dataset.\u001b[39;00m\n\u001b[32m    689\u001b[39m \n\u001b[32m   (...)\u001b[39m\u001b[32m    788\u001b[39m \n\u001b[32m    789\u001b[39m \u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m    790\u001b[39m a, weights = _ravel_and_check_weights(a, weights)\n\u001b[32m--> \u001b[39m\u001b[32m792\u001b[39m bin_edges, uniform_bins = \u001b[43m_get_bin_edges\u001b[49m\u001b[43m(\u001b[49m\u001b[43ma\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mbins\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mrange\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mweights\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    794\u001b[39m \u001b[38;5;66;03m# Histogram is an integer or a float array depending on the weights.\u001b[39;00m\n\u001b[32m    795\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m weights \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/numpy/lib/_histograms_impl.py:449\u001b[39m, in \u001b[36m_get_bin_edges\u001b[39m\u001b[34m(a, bins, range, weights)\u001b[39m\n\u001b[32m    445\u001b[39m     bin_edges = np.linspace(\n\u001b[32m    446\u001b[39m         first_edge, last_edge, n_equal_bins + \u001b[32m1\u001b[39m,\n\u001b[32m    447\u001b[39m         endpoint=\u001b[38;5;28;01mTrue\u001b[39;00m, dtype=bin_type)\n\u001b[32m    448\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m np.any(bin_edges[:-\u001b[32m1\u001b[39m] >= bin_edges[\u001b[32m1\u001b[39m:]):\n\u001b[32m--> \u001b[39m\u001b[32m449\u001b[39m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[32m    450\u001b[39m             \u001b[33mf\u001b[39m\u001b[33m'\u001b[39m\u001b[33mToo many bins for data range. Cannot create \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mn_equal_bins\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m \u001b[39m\u001b[33m'\u001b[39m\n\u001b[32m    451\u001b[39m             \u001b[33mf\u001b[39m\u001b[33m'\u001b[39m\u001b[33mfinite-sized bins.\u001b[39m\u001b[33m'\u001b[39m)\n\u001b[32m    452\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m bin_edges, (first_edge, last_edge, n_equal_bins)\n\u001b[32m    453\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\n\u001b[31mValueError\u001b[39m: Too many bins for data range. Cannot create 100 finite-sized bins."},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4df5c407fd0d935de67f4c07a4c89540","path":"/NISAR_GCOV_Cookbook/build/4df5c407fd0d935de67f4c07a4c89540.png"},"text/plain":{"content":"<Figure size 900x300 with 2 Axes>","content_type":"text/plain"}}}],"key":"tsC66B3Oqq"}],"key":"XNUKGiDZ7z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# # List the metrics keys you want to plot\n# metric_keys=['mean', 'median', 'max', 'min', \n#              'p95', 'p5', 'prange', 'var', 'std', 'CV']\n# fig= plt.figure(figsize=(16,40))\n# idx=1\n# for i in metric_keys:\n#     ax = fig.add_subplot(5,2,idx)\n#     vmin, vmax = np.nanpercentile(metrics[i], [1, 99])\n#     ax.imshow(metrics[i],vmin=vmin,vmax=vmax,cmap='inferno')\n#     ax.set_title(i.upper())\n#     ax.axis('off')\n#     idx+=1","key":"FlAoMGWT56"},{"type":"output","id":"QLj7KNBzUOFxhuapSpLEf","data":[],"key":"bk1aAKI1u4"}],"key":"rwrm1q1GGf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"metrics","key":"BhNJPMJtDv"},{"type":"output","id":"kXdkeG7n2MGg7iSiYpfaV","data":[],"key":"JMGn8JfZAN"}],"key":"nzPvIsiVtL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# List the metrics keys you want to plot\nmetric_keys=['mean', 'p50', 'max', 'min', \n             'p95', 'p05', 'prange', 'var', 'std', 'CV']\nfig= plt.figure(figsize=(16,40))\nidx=1\nfor i in metric_keys:\n    ax = fig.add_subplot(5,2,idx)\n    vmin, vmax = np.nanpercentile(metrics[i], [1, 99])\n    ax.imshow(metrics[i],vmin=vmin,vmax=vmax,cmap='inferno')\n    ax.set_title(i.upper())\n    ax.axis('off')\n    idx+=1","key":"vvg3kBePOo"},{"type":"output","id":"CEX5NKJFIQZ-52ao_k8K_","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cdf02963424843d5363c231615f85944","path":"/NISAR_GCOV_Cookbook/build/cdf02963424843d5363c231615f85944.png"},"text/plain":{"content":"<Figure size 1600x4000 with 10 Axes>","content_type":"text/plain"}}}],"key":"y5uqaqHNy4"}],"key":"Ah23dE9Ngd"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"You might have noticed white patches in the images above. These do not contain any data. The reason is that they are in the radar shadow of terrain that is closer to the satellite.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IyaGS808g8"}],"key":"zCKQphMjZg"},{"type":"thematicBreak","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HpzF9wi8gs"},{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"6. Some Popular SAR Change Detection Methods","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WBA6FhMFZV"}],"identifier":"id-6-some-popular-sar-change-detection-methods","label":"6. Some Popular SAR Change Detection Methods","html_id":"id-6-some-popular-sar-change-detection-methods","implicit":true,"key":"nxlFp3sX45"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"This section will introduce you to the following popular and simple change detection methods:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"xVcCJimlDL"}],"key":"tmyFhAWxr3"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Time series metrics  95","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"wMGHAabsN3"},{"type":"inlineMath","value":"^{th}","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mrow></mrow><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">^{th}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">h</span></span></span></span></span></span></span></span></span></span></span></span>","key":"wQWEVa6l02"},{"type":"text","value":" and 5","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Od87dbdCZ3"},{"type":"inlineMath","value":"^{th}","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mrow></mrow><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">^{th}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">h</span></span></span></span></span></span></span></span></span></span></span></span>","key":"m2Pg21p2sC"},{"type":"text","value":" percentile difference and standard deviation thresholding","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Gm6wMF2WYy"}],"key":"a48ftwgkrg"}],"key":"eQ8u8H98A2"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Time series coefficient of variation thresholding","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"GuVf993KBE"}],"key":"VMX88ArO3y"}],"key":"D4VPJWI7CV"}],"key":"nRm5nr9565"},{"type":"thematicBreak","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"dCEOj71Wa7"},{"type":"heading","depth":3,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"6.1 Change Detection with the Percentile Difference and the Variance Threshold Method","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"cbNf43WE2w"}],"identifier":"id-6-1-change-detection-with-the-percentile-difference-and-the-variance-threshold-method","label":"6.1 Change Detection with the Percentile Difference and the Variance Threshold Method","html_id":"id-6-1-change-detection-with-the-percentile-difference-and-the-variance-threshold-method","implicit":true,"key":"bwbMUhzMLt"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"In this method we find thresholds on the ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"LkluEVwsyD"},{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"95","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Jc30kZ6yeE"},{"type":"inlineMath","value":"^{th}","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mrow></mrow><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">^{th}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">h</span></span></span></span></span></span></span></span></span></span></span></span>","key":"D9hznecAdq"},{"type":"text","value":" and 5","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"ZJYBNEY1XR"},{"type":"inlineMath","value":"^{th}","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mrow></mrow><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">^{th}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">h</span></span></span></span></span></span></span></span></span></span></span></span>","key":"JkWZCPQ0LV"},{"type":"text","value":" percentile difference","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"jTEyW6jB9Z"}],"key":"Ll1ExmjUHA"},{"type":"text","value":" or the ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"JwcfThdAQm"},{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"temporal pixel-by-pixel gray value cariance","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"MV4z1Ky0fP"}],"key":"q6fezNBFQI"},{"type":"text","value":". Let’s start with the 95","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"GcwtJvWaqx"},{"type":"inlineMath","value":"^{th}","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mrow></mrow><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">^{th}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">h</span></span></span></span></span></span></span></span></span></span></span></span>","key":"eJGadXQwCX"},{"type":"text","value":" and 5","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"RrTr432VOL"},{"type":"inlineMath","value":"^{th}","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mrow></mrow><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">^{th}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">h</span></span></span></span></span></span></span></span></span></span></span></span>","key":"Qj6Pg5WD56"},{"type":"text","value":" percentile difference. The advantage to look at percentiles verus maximum minus minimum is that it is more robust to outliers.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"wx6rbzEAVJ"}],"key":"iBEY56Yqml"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"First, let us define a ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"nUjOrKqeZt"},{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"function for plotting histograms:","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"MqDk89gE4w"}],"key":"RYFbuOGxzr"}],"key":"UI7oM6re6q"}],"key":"diYZ45VOok"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def plot_histogram_cdf(metric='std'):\n    plt.rcParams.update({'font.size': 12})\n    fig = plt.figure(figsize=(14, 4)) # Initialize figure with a size\n    ax1 = fig.add_subplot(121)  # 121 determines: 2 rows, 2 plots, first plot\n    ax2 = fig.add_subplot(122)\n\n    h = ax1.hist(\n        metrics[metric].values.ravel(), range=np.nanpercentile(metrics[metric], [1, 99]))\n    ax1.xaxis.set_label_text(f'{metric}')\n    ax1.set_title('Histogram')\n\n    n, bins, patches = ax2.hist(\n        metrics[metric].values.ravel(), range=np.nanpercentile(metrics[metric], [1, 99]),\n        cumulative='True', density='True', histtype='step', label='Empirical')\n\n    ax2.xaxis.set_label_text(f'{metric}')\n    ax2.set_title('CDF')\n\n    outind = np.where(n > 0.95)   \n    threshind = np.min(outind)\n    thresh = bins[threshind]\n    ax1.axvline(thresh,color='red')\n    _ = ax2.axvline(thresh,color='red')\n    plt.savefig(plot_dir/f'{metric}_histogram.png',\n                dpi=200, transparent='true')","key":"N0dtB3DBwt"},{"type":"output","id":"ZGEr7IcKQj7oZ-QN1HdRg","data":[],"key":"vwxJbum6jL"}],"key":"otV3nYYTSY"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now let’s look at the 95th - 5th percentile range","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rhjeLOvPdy"}],"key":"qNs1JY31QE"}],"key":"WUaKxKyj6h"}],"key":"iJt5QTuv2T"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_histogram_cdf(metric='prange')","key":"IRJa4LUJMV"},{"type":"output","id":"TyMNAhjeoBn0aogxAC2ML","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8710e7d305ef2852661bcee12d4e5abc","path":"/NISAR_GCOV_Cookbook/build/8710e7d305ef2852661bcee12d4e5abc.png"},"text/plain":{"content":"<Figure size 1400x400 with 2 Axes>","content_type":"text/plain"}}}],"key":"w0fAmTASZV"}],"key":"OrpqDHGi0R"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s visualize the 5% of all pixels with the largest (95th - 5th percentile) difference in the time series. We will refer to the pixels (x,y) that exceed this threshold ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X6C90Hukfe"},{"type":"inlineMath","value":"t","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"KiOqOJZsVy"},{"type":"text","value":" as likely ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"b1KPqVUZBX"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"change pixels (cp):","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o5zMqyacmU"}],"key":"OuRrD72c3S"}],"key":"TdPzZ5oJzp"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineMath","value":"{cp}_{x,y} = P_{x,y}^{95th} - P_{x,y}^{5th} > t","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mrow><mi>c</mi><mi>p</mi></mrow><mrow><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi></mrow></msub><mo>=</mo><msubsup><mi>P</mi><mrow><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi></mrow><mrow><mn>95</mn><mi>t</mi><mi>h</mi></mrow></msubsup><mo>−</mo><msubsup><mi>P</mi><mrow><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi></mrow><mrow><mn>5</mn><mi>t</mi><mi>h</mi></mrow></msubsup><mo>&gt;</mo><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">{cp}_{x,y} = P_{x,y}^{95th} - P_{x,y}^{5th} &gt; t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8108em;vertical-align:-0.3802em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">p</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.0573em;\"><span style=\"top:-2.4559em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3802em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2322em;vertical-align:-0.3831em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">95</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">h</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3831em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2322em;vertical-align:-0.3831em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">5</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">h</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3831em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"KgfogxijuW"}],"key":"VZgPSr2zCM"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"If we define ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"T8QjW6btPm"},{"type":"inlineMath","value":"t","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"nXhF3f1WOV"},{"type":"text","value":" to correspond to the 5% of pixels with highest (95th - 5th percentile) difference, the image looks like:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"lmfmgFf8af"}],"key":"WRs6KqjZwV"}],"key":"uQJ2hQkGTn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def plot_threshold_classifier(metric='prange', percentage_cutoff=5):\n    plt.figure(figsize=(8,8))\n    thresh = np.nanpercentile(metrics[metric], 100 - percentage_cutoff)\n    mask = metrics[metric] < thresh # For display we prepare the inverse mask\n    plt.imshow(mask, cmap='gray')\n    _=plt.title(f'Threshold Classifier on {metric} > %1.8f' % thresh)\n    plt.savefig(plot_dir/f'changes_{metric}.png',\n            dpi=200, transparent='true')\n    return np.logical_not(mask)\n\nmetric = 'prange'\nmasks = {metric: plot_threshold_classifier(metric=metric)}","key":"KouclrlHwD"},{"type":"output","id":"qoWl2uacXapiO45lV0i7E","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4121dcc6a28815f57f25f226e2ef3cc9","path":"/NISAR_GCOV_Cookbook/build/4121dcc6a28815f57f25f226e2ef3cc9.png"},"text/plain":{"content":"<Figure size 800x800 with 1 Axes>","content_type":"text/plain"}}}],"key":"xU0yyprou0"}],"key":"VXLwhvTL5a"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Instead of applying a threshold on the 95th - 5th percentile difference data, we can also attempt to threshold other metrics. The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BhbRBf57vl"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"standard deviation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"g2scLgVeG3"}],"key":"kTVbnkbxvj"},{"type":"text","value":" (or variance) variable seems a useful indicator for change as it identifies pixels for which radar brightness has changed strongly within the time series. Hence, in the following we use this metric for change identification according to:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RgbdaIdfif"}],"key":"tW7yscZ4kV"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineMath","value":"{cp}_{x,y} = \\sigma > t","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mrow><mi>c</mi><mi>p</mi></mrow><mrow><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi></mrow></msub><mo>=</mo><mi>σ</mi><mo>&gt;</mo><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">{cp}_{x,y} = \\sigma &gt; t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8108em;vertical-align:-0.3802em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">p</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.0573em;\"><span style=\"top:-2.4559em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3802em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"iXW3wnZl0D"}],"key":"EJWmq6xeCs"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"with ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"eXw7DDz5F6"},{"type":"inlineMath","value":"t=CDF_{\\sigma} > 0.95","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mi>C</mi><mi>D</mi><msub><mi>F</mi><mi>σ</mi></msub><mo>&gt;</mo><mn>0.95</mn></mrow><annotation encoding=\"application/x-tex\">t=CDF_{\\sigma} &gt; 0.95</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">σ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.95</span></span></span></span>","key":"XYhar2znn4"},{"type":"text","value":" (5% pixels with highest standard deviation):","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"L4wUK3pi7E"}],"key":"HeIdivvbu8"}],"key":"aIvhFXbtvZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_histogram_cdf(metric='std')","key":"UVMWxe3AKs"},{"type":"output","id":"UNkPVqMvzUvsvz8JYk8W6","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"121597439082e37604a170032487480b","path":"/NISAR_GCOV_Cookbook/build/121597439082e37604a170032487480b.png"},"text/plain":{"content":"<Figure size 1400x400 with 2 Axes>","content_type":"text/plain"}}}],"key":"ijqUOgavZV"}],"key":"rbFlDZGOMz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"metric = 'std'\nmasks[metric] = plot_threshold_classifier(metric=metric)","key":"nuHFaFBFve"},{"type":"output","id":"jt-jwbuvptq23ze7hrt-9","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"473070a9d286e08b40709d01950c7244","path":"/NISAR_GCOV_Cookbook/build/473070a9d286e08b40709d01950c7244.png"},"text/plain":{"content":"<Figure size 800x800 with 1 Axes>","content_type":"text/plain"}}}],"key":"Q2OgG8nfUV"}],"key":"vGhVPyTP8C"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"6.2 Change Detection with the Coefficient of Variation Method","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HONLGrLvO1"}],"identifier":"id-6-2-change-detection-with-the-coefficient-of-variation-method","label":"6.2 Change Detection with the Coefficient of Variation Method","html_id":"id-6-2-change-detection-with-the-coefficient-of-variation-method","implicit":true,"key":"hTXxXpU3Z2"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"We can also set a threshold ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"W9d0MfOqww"},{"type":"inlineMath","value":"t","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"cXYy9dSsc9"},{"type":"text","value":" for the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Kp26XAxlbx"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"coefficient of variation image","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VBsxBv8Bb8"}],"key":"kelhMV1wYB"},{"type":"text","value":"\nto classify change in the time series:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jujSUAGuiM"}],"key":"LlZZFBHKDd"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"inlineMath","value":"{CV}_{x,y} = \\frac{\\sigma_{x,y}}{\\overline{X}_{x,y}} > t","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mrow><mi>C</mi><mi>V</mi></mrow><mrow><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi></mrow></msub><mo>=</mo><mfrac><msub><mi>σ</mi><mrow><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi></mrow></msub><msub><mover accent=\"true\"><mi>X</mi><mo stretchy=\"true\">‾</mo></mover><mrow><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi></mrow></msub></mfrac><mo>&gt;</mo><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">{CV}_{x,y} = \\frac{\\sigma_{x,y}}{\\overline{X}_{x,y}} &gt; t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.4659em;vertical-align:-0.6572em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8087em;\"><span style=\"top:-2.5402em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord overline mtight\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9283em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">X</span></span></span><span style=\"top:-3.8303em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"overline-line mtight\" style=\"border-bottom-width:0.049em;\"></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.5073em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6572em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"O5QqGv8M2d"}],"key":"jTN4USr7PD"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Let’s look at the histogram and the Cumulative Distribution Function (CDF) of the coefficient of variation:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"KuIx6iprct"}],"key":"JvV8cRa1Sx"}],"key":"aKt4aczIyg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_histogram_cdf(metric='CV')","key":"spcOSGuRLt"},{"type":"output","id":"2yQlDvdveICXocGw7Y84d","data":[{"ename":"ValueError","evalue":"Too many bins for data range. Cannot create 10 finite-sized bins.","output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mValueError\u001b[39m                                Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[31]\u001b[39m\u001b[32m, line 1\u001b[39m\n\u001b[32m----> \u001b[39m\u001b[32m1\u001b[39m \u001b[43mplot_histogram_cdf\u001b[49m\u001b[43m(\u001b[49m\u001b[43mmetric\u001b[49m\u001b[43m=\u001b[49m\u001b[33;43m'\u001b[39;49m\u001b[33;43mCV\u001b[39;49m\u001b[33;43m'\u001b[39;49m\u001b[43m)\u001b[49m\n\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[24]\u001b[39m\u001b[32m, line 7\u001b[39m, in \u001b[36mplot_histogram_cdf\u001b[39m\u001b[34m(metric)\u001b[39m\n\u001b[32m      4\u001b[39m ax1 = fig.add_subplot(\u001b[32m121\u001b[39m)  \u001b[38;5;66;03m# 121 determines: 2 rows, 2 plots, first plot\u001b[39;00m\n\u001b[32m      5\u001b[39m ax2 = fig.add_subplot(\u001b[32m122\u001b[39m)\n\u001b[32m----> \u001b[39m\u001b[32m7\u001b[39m h = \u001b[43max1\u001b[49m\u001b[43m.\u001b[49m\u001b[43mhist\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m      8\u001b[39m \u001b[43m    \u001b[49m\u001b[43mmetrics\u001b[49m\u001b[43m[\u001b[49m\u001b[43mmetric\u001b[49m\u001b[43m]\u001b[49m\u001b[43m.\u001b[49m\u001b[43mvalues\u001b[49m\u001b[43m.\u001b[49m\u001b[43mravel\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mrange\u001b[39;49m\u001b[43m=\u001b[49m\u001b[43mnp\u001b[49m\u001b[43m.\u001b[49m\u001b[43mnanpercentile\u001b[49m\u001b[43m(\u001b[49m\u001b[43mmetrics\u001b[49m\u001b[43m[\u001b[49m\u001b[43mmetric\u001b[49m\u001b[43m]\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m[\u001b[49m\u001b[32;43m1\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[32;43m99\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m      9\u001b[39m ax1.xaxis.set_label_text(\u001b[33mf\u001b[39m\u001b[33m'\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mmetric\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m'\u001b[39m)\n\u001b[32m     10\u001b[39m ax1.set_title(\u001b[33m'\u001b[39m\u001b[33mHistogram\u001b[39m\u001b[33m'\u001b[39m)\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/_api/deprecation.py:453\u001b[39m, in \u001b[36mmake_keyword_only.<locals>.wrapper\u001b[39m\u001b[34m(*args, **kwargs)\u001b[39m\n\u001b[32m    447\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mlen\u001b[39m(args) > name_idx:\n\u001b[32m    448\u001b[39m     warn_deprecated(\n\u001b[32m    449\u001b[39m         since, message=\u001b[33m\"\u001b[39m\u001b[33mPassing the \u001b[39m\u001b[38;5;132;01m%(name)s\u001b[39;00m\u001b[33m \u001b[39m\u001b[38;5;132;01m%(obj_type)s\u001b[39;00m\u001b[33m \u001b[39m\u001b[33m\"\u001b[39m\n\u001b[32m    450\u001b[39m         \u001b[33m\"\u001b[39m\u001b[33mpositionally is deprecated since Matplotlib \u001b[39m\u001b[38;5;132;01m%(since)s\u001b[39;00m\u001b[33m; the \u001b[39m\u001b[33m\"\u001b[39m\n\u001b[32m    451\u001b[39m         \u001b[33m\"\u001b[39m\u001b[33mparameter will become keyword-only in \u001b[39m\u001b[38;5;132;01m%(removal)s\u001b[39;00m\u001b[33m.\u001b[39m\u001b[33m\"\u001b[39m,\n\u001b[32m    452\u001b[39m         name=name, obj_type=\u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[33mparameter of \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mfunc.\u001b[34m__name__\u001b[39m\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m()\u001b[39m\u001b[33m\"\u001b[39m)\n\u001b[32m--> \u001b[39m\u001b[32m453\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mfunc\u001b[49m\u001b[43m(\u001b[49m\u001b[43m*\u001b[49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/__init__.py:1524\u001b[39m, in \u001b[36m_preprocess_data.<locals>.inner\u001b[39m\u001b[34m(ax, data, *args, **kwargs)\u001b[39m\n\u001b[32m   1521\u001b[39m \u001b[38;5;129m@functools\u001b[39m.wraps(func)\n\u001b[32m   1522\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34minner\u001b[39m(ax, *args, data=\u001b[38;5;28;01mNone\u001b[39;00m, **kwargs):\n\u001b[32m   1523\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m data \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[32m-> \u001b[39m\u001b[32m1524\u001b[39m         \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mfunc\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m   1525\u001b[39m \u001b[43m            \u001b[49m\u001b[43max\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1526\u001b[39m \u001b[43m            \u001b[49m\u001b[43m*\u001b[49m\u001b[38;5;28;43mmap\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43mcbook\u001b[49m\u001b[43m.\u001b[49m\u001b[43msanitize_sequence\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43margs\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1527\u001b[39m \u001b[43m            \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43m{\u001b[49m\u001b[43mk\u001b[49m\u001b[43m:\u001b[49m\u001b[43m \u001b[49m\u001b[43mcbook\u001b[49m\u001b[43m.\u001b[49m\u001b[43msanitize_sequence\u001b[49m\u001b[43m(\u001b[49m\u001b[43mv\u001b[49m\u001b[43m)\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mfor\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mk\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mv\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;129;43;01min\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m.\u001b[49m\u001b[43mitems\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m}\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   1529\u001b[39m     bound = new_sig.bind(ax, *args, **kwargs)\n\u001b[32m   1530\u001b[39m     auto_label = (bound.arguments.get(label_namer)\n\u001b[32m   1531\u001b[39m                   \u001b[38;5;129;01mor\u001b[39;00m bound.kwargs.get(label_namer))\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/axes/_axes.py:7132\u001b[39m, in \u001b[36mAxes.hist\u001b[39m\u001b[34m(self, x, bins, range, density, weights, cumulative, bottom, histtype, align, orientation, rwidth, log, color, label, stacked, **kwargs)\u001b[39m\n\u001b[32m   7128\u001b[39m \u001b[38;5;66;03m# Loop through datasets\u001b[39;00m\n\u001b[32m   7129\u001b[39m \u001b[38;5;28;01mfor\u001b[39;00m i \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(nx):\n\u001b[32m   7130\u001b[39m     \u001b[38;5;66;03m# this will automatically overwrite bins,\u001b[39;00m\n\u001b[32m   7131\u001b[39m     \u001b[38;5;66;03m# so that each histogram uses the same bins\u001b[39;00m\n\u001b[32m-> \u001b[39m\u001b[32m7132\u001b[39m     m, bins = \u001b[43mnp\u001b[49m\u001b[43m.\u001b[49m\u001b[43mhistogram\u001b[49m\u001b[43m(\u001b[49m\u001b[43mx\u001b[49m\u001b[43m[\u001b[49m\u001b[43mi\u001b[49m\u001b[43m]\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mbins\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mweights\u001b[49m\u001b[43m=\u001b[49m\u001b[43mw\u001b[49m\u001b[43m[\u001b[49m\u001b[43mi\u001b[49m\u001b[43m]\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mhist_kwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   7133\u001b[39m     tops.append(m)\n\u001b[32m   7134\u001b[39m tops = np.array(tops, \u001b[38;5;28mfloat\u001b[39m)  \u001b[38;5;66;03m# causes problems later if it's an int\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/numpy/lib/_histograms_impl.py:792\u001b[39m, in \u001b[36mhistogram\u001b[39m\u001b[34m(a, bins, range, density, weights)\u001b[39m\n\u001b[32m    687\u001b[39m \u001b[38;5;250m\u001b[39m\u001b[33mr\u001b[39m\u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m    688\u001b[39m \u001b[33;03mCompute the histogram of a dataset.\u001b[39;00m\n\u001b[32m    689\u001b[39m \n\u001b[32m   (...)\u001b[39m\u001b[32m    788\u001b[39m \n\u001b[32m    789\u001b[39m \u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m    790\u001b[39m a, weights = _ravel_and_check_weights(a, weights)\n\u001b[32m--> \u001b[39m\u001b[32m792\u001b[39m bin_edges, uniform_bins = \u001b[43m_get_bin_edges\u001b[49m\u001b[43m(\u001b[49m\u001b[43ma\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mbins\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mrange\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mweights\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    794\u001b[39m \u001b[38;5;66;03m# Histogram is an integer or a float array depending on the weights.\u001b[39;00m\n\u001b[32m    795\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m weights \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/numpy/lib/_histograms_impl.py:449\u001b[39m, in \u001b[36m_get_bin_edges\u001b[39m\u001b[34m(a, bins, range, weights)\u001b[39m\n\u001b[32m    445\u001b[39m     bin_edges = np.linspace(\n\u001b[32m    446\u001b[39m         first_edge, last_edge, n_equal_bins + \u001b[32m1\u001b[39m,\n\u001b[32m    447\u001b[39m         endpoint=\u001b[38;5;28;01mTrue\u001b[39;00m, dtype=bin_type)\n\u001b[32m    448\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m np.any(bin_edges[:-\u001b[32m1\u001b[39m] >= bin_edges[\u001b[32m1\u001b[39m:]):\n\u001b[32m--> \u001b[39m\u001b[32m449\u001b[39m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[32m    450\u001b[39m             \u001b[33mf\u001b[39m\u001b[33m'\u001b[39m\u001b[33mToo many bins for data range. Cannot create \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mn_equal_bins\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m \u001b[39m\u001b[33m'\u001b[39m\n\u001b[32m    451\u001b[39m             \u001b[33mf\u001b[39m\u001b[33m'\u001b[39m\u001b[33mfinite-sized bins.\u001b[39m\u001b[33m'\u001b[39m)\n\u001b[32m    452\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m bin_edges, (first_edge, last_edge, n_equal_bins)\n\u001b[32m    453\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\n\u001b[31mValueError\u001b[39m: Too many bins for data range. Cannot create 10 finite-sized bins."},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f4b04bbcde8a212dbc2cd49756eeee1c","path":"/NISAR_GCOV_Cookbook/build/f4b04bbcde8a212dbc2cd49756eeee1c.png"},"text/plain":{"content":"<Figure size 1400x400 with 2 Axes>","content_type":"text/plain"}}}],"key":"KGlo4fjO8S"}],"key":"Z5M0rAeLdJ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"With a threshold of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YSKIaNQg7p"},{"type":"inlineMath","value":"t=CDF_{CV} > 0.95","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mi>C</mi><mi>D</mi><msub><mi>F</mi><mrow><mi>C</mi><mi>V</mi></mrow></msub><mo>&gt;</mo><mn>0.95</mn></mrow><annotation encoding=\"application/x-tex\">t=CDF_{CV} &gt; 0.95</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">V</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.95</span></span></span></span>","key":"h3ExpMINtW"},{"type":"text","value":" (5% pixels with highest variance) the change pixels would look like the following image:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"h16IeaeG1v"}],"key":"QDN0mRbqwK"}],"key":"rkSyENlLc9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"metric = 'CV'\nmasks[metric] = plot_threshold_classifier(metric=metric)","key":"DzaXfwjkP9"},{"type":"output","id":"vso8MHqJ_ltvdov7gk8Jj","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cbca4bf5566363a3beff8fda9ee98427","path":"/NISAR_GCOV_Cookbook/build/cbca4bf5566363a3beff8fda9ee98427.png"},"text/plain":{"content":"<Figure size 800x800 with 1 Axes>","content_type":"text/plain"}}}],"key":"yokrBRoIGZ"}],"key":"kPDjdTrmyw"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"6.3 Pair-wise change detection","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qRZpEpuLQG"}],"identifier":"id-6-3-pair-wise-change-detection","label":"6.3 Pair-wise change detection","html_id":"id-6-3-pair-wise-change-detection","implicit":true,"key":"BAH3I0PEiu"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To analyze temporal changes between two images, it is useful to compute metrics that are sensitive to discrepancies between the two images. In radar remote sensing, the standard way is to look at ratios (in the linearly scaled power domain) or, equivalently, at differences in the logarithmic dB domain.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"a8LYquJPBV"}],"key":"BO5IdXT5FN"}],"key":"eqX6BA3OCF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# dates = ('2018-05-27', '2018-06-08') # around first eruption\n\n# # convert to datetime objects\n# dates_ = [datetime.datetime.strptime(date, '%Y-%m-%d') for date in dates]\n\n# # get the indices in one line\n# dates_ind = [np.argmin(np.abs(date - tindex)) for date in dates_]\n# print(f'Comparing image {dates_ind[0]} from {tindex[dates_ind[0]].date()} with {dates_ind[1]} from {tindex[dates_ind[1]].date()}')","key":"Bjstw7Cib0"},{"type":"output","id":"z4JcwHlof6pmGUm05OKmD","data":[],"key":"EoVF0kMx8k"}],"key":"i46nIKnZgc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dates = ('2025-11-03', '2025-11-07') # around first eruption\n\n# convert to datetime objects\ndates_ = [datetime.datetime.strptime(date, '%Y-%m-%d') for date in dates]\n\n# get the indices in one line\ndates_ind = [np.argmin(np.abs(date - tindex)) for date in dates_]\nprint(f'Comparing image {dates_ind[0]} from {tindex[dates_ind[0]].date()} with {dates_ind[1]} from {tindex[dates_ind[1]].date()}')","key":"jd0GYXBqSN"},{"type":"output","id":"SE7_gIpKtnzdYpk8xJmJv","data":[],"key":"IsmT0bHtTF"}],"key":"aRpbWBNNit"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"da.time","key":"XuYtYPSkkQ"},{"type":"output","id":"66VedDR1LRt9JWpTbKfDp","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;time&#x27; (time: 8)&gt; Size: 64B\narray([&#x27;2025-11-02T22:06:39.000000000&#x27;, &#x27;2025-11-03T22:06:39.000000000&#x27;,\n       &#x27;2025-11-04T22:06:39.000000000&#x27;, &#x27;2025-11-05T22:06:39.000000000&#x27;,\n       &#x27;2025-11-06T22:06:39.000000000&#x27;, &#x27;2025-11-07T22:06:39.000000000&#x27;,\n       &#x27;2025-11-08T22:06:39.000000000&#x27;, &#x27;2025-11-09T22:06:39.000000000&#x27;],\n      dtype=&#x27;datetime64[ns]&#x27;)\nCoordinates:\n    frequency  &lt;U1 4B &#x27;A&#x27;\n  * time       (time) datetime64[ns] 64B 2025-11-02T22:06:39 ... 2025-11-09T2...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'time'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 8</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-3d3b4f1c-cc7a-4a07-ad44-6b4e1def7842' class='xr-array-in' type='checkbox' checked><label for='section-3d3b4f1c-cc7a-4a07-ad44-6b4e1def7842' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>2025-11-02T22:06:39 2025-11-03T22:06:39 ... 2025-11-09T22:06:39</span></div><div class='xr-array-data'><pre>array([&#x27;2025-11-02T22:06:39.000000000&#x27;, &#x27;2025-11-03T22:06:39.000000000&#x27;,\n       &#x27;2025-11-04T22:06:39.000000000&#x27;, &#x27;2025-11-05T22:06:39.000000000&#x27;,\n       &#x27;2025-11-06T22:06:39.000000000&#x27;, &#x27;2025-11-07T22:06:39.000000000&#x27;,\n       &#x27;2025-11-08T22:06:39.000000000&#x27;, &#x27;2025-11-09T22:06:39.000000000&#x27;],\n      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></div></li><li class='xr-section-item'><input id='section-ff0633b3-4d6c-4a80-aca6-e41d91708465' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ff0633b3-4d6c-4a80-aca6-e41d91708465' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>frequency</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;A&#x27;</div><input id='attrs-398614ec-4da9-4444-9cb3-80e8c0d7d217' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-398614ec-4da9-4444-9cb3-80e8c0d7d217' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-04ef3e1b-6a45-4305-8a3e-7e4b3abb9e65' class='xr-var-data-in' type='checkbox'><label for='data-04ef3e1b-6a45-4305-8a3e-7e4b3abb9e65' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(&#x27;A&#x27;, dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2025-11-02T22:06:39 ... 2025-11-...</div><input id='attrs-b44bbaec-940d-420c-8d6c-d8ab2b47cd60' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b44bbaec-940d-420c-8d6c-d8ab2b47cd60' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7dbb329b-9f04-4940-8c23-8edafddaab83' class='xr-var-data-in' type='checkbox'><label for='data-7dbb329b-9f04-4940-8c23-8edafddaab83' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2025-11-02T22:06:39.000000000&#x27;, &#x27;2025-11-03T22:06:39.000000000&#x27;,\n       &#x27;2025-11-04T22:06:39.000000000&#x27;, &#x27;2025-11-05T22:06:39.000000000&#x27;,\n       &#x27;2025-11-06T22:06:39.000000000&#x27;, &#x27;2025-11-07T22:06:39.000000000&#x27;,\n       &#x27;2025-11-08T22:06:39.000000000&#x27;, &#x27;2025-11-09T22:06:39.000000000&#x27;],\n      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-668661ac-428b-4cfe-bdd7-b40845dd245f' class='xr-section-summary-in' type='checkbox'  ><label for='section-668661ac-428b-4cfe-bdd7-b40845dd245f' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-15fd1a1a-fdd5-4e40-8431-5a591dc5383b' class='xr-index-data-in' type='checkbox'/><label for='index-15fd1a1a-fdd5-4e40-8431-5a591dc5383b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2025-11-02 22:06:39&#x27;, &#x27;2025-11-03 22:06:39&#x27;,\n               &#x27;2025-11-04 22:06:39&#x27;, &#x27;2025-11-05 22:06:39&#x27;,\n               &#x27;2025-11-06 22:06:39&#x27;, &#x27;2025-11-07 22:06:39&#x27;,\n               &#x27;2025-11-08 22:06:39&#x27;, &#x27;2025-11-09 22:06:39&#x27;],\n              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=&#x27;D&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3997733e-28ce-4651-a1b4-0b4e812c797f' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-3997733e-28ce-4651-a1b4-0b4e812c797f' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray 'time' (time: 8)> Size: 64B\narray(['2025-11-02T22:06:39.000000000', '2025-11-03T22:06:39.000000000',\n       '2025-11-04T22:06:39.000000000', '2025-11-05T22:06:39.000000000',\n       '2025-11-06T22:06:39.000000000', '2025-11-07T22:06:39.000000000',\n       '2025-11-08T22:06:39.000000000', '2025-11-09T22:06:39.000000000'],\n      dtype='datetime64[ns]')\nCoordinates:\n    frequency  <U1 4B 'A'\n  * time       (time) datetime64[ns] 64B 2025-11-02T22:06:39 ... 2025-11-09T2...","content_type":"text/plain"}}}],"key":"IWuNBtCwWf"}],"key":"q1T9hTWURq"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compute the log ratio in dB","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"n4YCnpLSpR"}],"key":"qpYabumSHG"},{"type":"text","value":", corresponding to the difference in dB","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T8cah6PB4T"}],"key":"Hg9bA4lA9K"}],"key":"qOavoSnXd9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# ratiodB = 10 * np.ma.log10(np.ma.divide(rasterstack[dates_ind[1], ...], rasterstack[dates_ind[0], ...]))","key":"vwehHu58tC"},{"type":"output","id":"Y4Ci15hB-LAqhBrCVcq3O","data":[],"key":"BicQ8hkHDY"}],"key":"oR7fyDoSyK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"date_0 = da.sel(time=\"2025-11-03\").squeeze(\"time\", drop=True)\ndate_1 = da.sel(time=\"2025-11-07\").squeeze(\"time\", drop=True)\n\nratiodB = 10 * np.log10(date_1 / date_0)\nratiodB","key":"SeppprS7fI"},{"type":"output","id":"5rqsKCcFSlcc0AI17NhtZ","data":[{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;HVHV&#x27; (y: 5000, x: 5000)&gt; Size: 200MB\ndask.array&lt;mul, shape=(5000, 5000), dtype=float64, chunksize=(2048, 2048), chunktype=numpy.ndarray&gt;\nCoordinates:\n    frequency  &lt;U1 4B &#x27;A&#x27;\n  * y          (y) float64 40kB 9.7e+06 9.7e+06 9.7e+06 ... 9.6e+06 9.6e+06\n  * x          (x) float64 40kB 4e+05 4e+05 4e+05 ... 5e+05 5e+05 5e+05</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'HVHV'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 5000</li><li><span class='xr-has-index'>x</span>: 5000</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-f9a52b78-a240-4314-85e3-c09d3a0d3f5b' class='xr-array-in' type='checkbox' checked><label for='section-f9a52b78-a240-4314-85e3-c09d3a0d3f5b' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(212, 656), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>\n    <tr>\n        <td>\n            <table style=\"border-collapse: collapse;\">\n                <thead>\n                    <tr>\n                        <td> </td>\n                        <th> Array </th>\n                        <th> Chunk </th>\n                    </tr>\n                </thead>\n                <tbody>\n                    \n                    <tr>\n                        <th> Bytes </th>\n                        <td> 190.73 MiB </td>\n                        <td> 32.00 MiB </td>\n                    </tr>\n                    \n                    <tr>\n                        <th> Shape </th>\n                        <td> (5000, 5000) </td>\n                        <td> (2048, 2048) </td>\n                    </tr>\n                    <tr>\n                        <th> Dask graph </th>\n                        <td colspan=\"2\"> 16 chunks in 63 graph layers </td>\n                    </tr>\n                    <tr>\n                        <th> Data type </th>\n                        <td colspan=\"2\"> float64 numpy.ndarray </td>\n                    </tr>\n                </tbody>\n            </table>\n        </td>\n        <td>\n        <svg width=\"170\" height=\"170\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n\n  <!-- Horizontal lines -->\n  <line x1=\"0\" y1=\"0\" x2=\"120\" y2=\"0\" style=\"stroke-width:2\" />\n  <line x1=\"0\" y1=\"5\" x2=\"120\" y2=\"5\" />\n  <line x1=\"0\" y1=\"54\" x2=\"120\" y2=\"54\" />\n  <line x1=\"0\" y1=\"103\" x2=\"120\" y2=\"103\" />\n  <line x1=\"0\" y1=\"120\" x2=\"120\" y2=\"120\" style=\"stroke-width:2\" />\n\n  <!-- Vertical lines -->\n  <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"120\" style=\"stroke-width:2\" />\n  <line x1=\"15\" y1=\"0\" x2=\"15\" y2=\"120\" />\n  <line x1=\"64\" y1=\"0\" x2=\"64\" y2=\"120\" />\n  <line x1=\"114\" y1=\"0\" x2=\"114\" y2=\"120\" />\n  <line x1=\"120\" y1=\"0\" x2=\"120\" y2=\"120\" style=\"stroke-width:2\" />\n\n  <!-- Colored Rectangle -->\n  <polygon points=\"0.0,0.0 120.0,0.0 120.0,120.0 0.0,120.0\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n\n  <!-- Text -->\n  <text x=\"60.000000\" y=\"140.000000\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >5000</text>\n  <text x=\"140.000000\" y=\"60.000000\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(-90,140.000000,60.000000)\">5000</text>\n</svg>\n        </td>\n    </tr>\n</table></div></div></li><li class='xr-section-item'><input id='section-3f559d0e-8f82-41d8-b52f-09773ae073c7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3f559d0e-8f82-41d8-b52f-09773ae073c7' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>frequency</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;A&#x27;</div><input id='attrs-8a048e28-09c7-400c-a506-d1f41ff5a089' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8a048e28-09c7-400c-a506-d1f41ff5a089' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8a8dab7b-c229-4261-bf46-5ae4d88bcca3' class='xr-var-data-in' type='checkbox'><label for='data-8a8dab7b-c229-4261-bf46-5ae4d88bcca3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(&#x27;A&#x27;, dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>9.7e+06 9.7e+06 ... 9.6e+06 9.6e+06</div><input id='attrs-e3aeb079-7841-4629-bb68-13ca10e85394' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e3aeb079-7841-4629-bb68-13ca10e85394' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ff69b130-b014-4649-96fc-056997bd1acb' class='xr-var-data-in' type='checkbox'><label for='data-ff69b130-b014-4649-96fc-056997bd1acb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([9699990., 9699970., 9699950., ..., 9600050., 9600030., 9600010.],\n      shape=(5000,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4e+05 4e+05 4e+05 ... 5e+05 5e+05</div><input id='attrs-ed0f6bf4-8031-4769-83c4-fa0f3d99bd93' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ed0f6bf4-8031-4769-83c4-fa0f3d99bd93' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-72e5edc6-d857-483a-bc0f-691d9d990f32' class='xr-var-data-in' type='checkbox'><label for='data-72e5edc6-d857-483a-bc0f-691d9d990f32' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([400010., 400030., 400050., ..., 499950., 499970., 499990.],\n      shape=(5000,))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c369deb1-f96c-4f9d-80f5-4f8b452fe37a' class='xr-section-summary-in' type='checkbox'  ><label for='section-c369deb1-f96c-4f9d-80f5-4f8b452fe37a' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-a3a45f3f-50b8-4b32-8bb7-d2dd4c346bed' class='xr-index-data-in' type='checkbox'/><label for='index-a3a45f3f-50b8-4b32-8bb7-d2dd4c346bed' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([9699990.0, 9699970.0, 9699950.0, 9699930.0, 9699910.0, 9699890.0,\n       9699870.0, 9699850.0, 9699830.0, 9699810.0,\n       ...\n       9600190.0, 9600170.0, 9600150.0, 9600130.0, 9600110.0, 9600090.0,\n       9600070.0, 9600050.0, 9600030.0, 9600010.0],\n      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=5000))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-67dda30f-896a-4a23-9c20-01595a1108e7' class='xr-index-data-in' type='checkbox'/><label for='index-67dda30f-896a-4a23-9c20-01595a1108e7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([400010.0, 400030.0, 400050.0, 400070.0, 400090.0, 400110.0, 400130.0,\n       400150.0, 400170.0, 400190.0,\n       ...\n       499810.0, 499830.0, 499850.0, 499870.0, 499890.0, 499910.0, 499930.0,\n       499950.0, 499970.0, 499990.0],\n      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=5000))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b7a7e907-f118-4bd0-b679-bea98b9c8a9d' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-b7a7e907-f118-4bd0-b679-bea98b9c8a9d' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray 'HVHV' (y: 5000, x: 5000)> Size: 200MB\ndask.array<mul, shape=(5000, 5000), dtype=float64, chunksize=(2048, 2048), chunktype=numpy.ndarray>\nCoordinates:\n    frequency  <U1 4B 'A'\n  * y          (y) float64 40kB 9.7e+06 9.7e+06 9.7e+06 ... 9.6e+06 9.6e+06\n  * x          (x) float64 40kB 4e+05 4e+05 4e+05 ... 5e+05 5e+05 5e+05","content_type":"text/plain"}}}],"key":"Jc1bJBeKth"}],"key":"L6TgOQiZ6I"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let us manually choose a threshold this time","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"klzQmzim9Y"}],"key":"Cmvp1ePSHj"}],"key":"VDslJAr9AX"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"thresh is the threshold, e.g. -2 dB","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uT4cHd4azl"}],"key":"WEO6tAwpka"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"thresh_type determines whether we mask everything below that (lower) or above (upper)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"U7OqIsbvLR"}],"key":"gS646txxJ8"}],"key":"w8YaP3gE7M"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# thresh = -2\n# thresh_type = 'lower' #'lower': mask everything below thresh, 'upper': mask everything above\n\n# copy_absRatiod = np.copy(np.abs(ratiodB))\n# # dynamic_range = np.nanpercentile(np.abs(ratiodB), 99)\n# dynamic_range = np.nanpercentile(copy_absRatiod, 99)\n# fig, axs = plt.subplots(ncols=3, nrows=1)\n# fig.set_size_inches(20, 4)\n# plt.subplots_adjust(hspace=0.4, right=0.85)\n\n# # h = axs[0].hist(\n# #         ratiodB.flatten(), bins=200, range=np.nanpercentile(ratiodB, [0.1, 99.9]))\n\n# h = axs[0].hist(\n#         ratiodB.flatten(), bins=200, range=np.nanpercentile(np.copy(ratiodB), [0.1, 99.9]))\n\n# axs[0].xaxis.set_label_text(f'difference [dB]')\n# axs[0].set_title('Histogram')\n# im0 = axs[1].imshow(ratiodB, cmap='RdBu', vmin=-dynamic_range, vmax=dynamic_range)\n# cbar = fig.colorbar(im0, orientation='vertical', ax=axs.ravel().tolist(), shrink=0.7)\n# cbar.set_label('[dB]')\n# axs[1].set_title('Image')\n# mask = (ratiodB > thresh if thresh_type == 'lower' else ratiodB < thresh).astype(np.int8)\n# axs[2].imshow(mask, cmap='gray')\n# axs[2].set_title('Mask')\n# fig.suptitle(f'{tindex[dates_ind[0]].date()} {tindex[dates_ind[0]].date()}')\n# logratiolabel = f'logratio_{tindex[dates_ind[0]].date()}_{tindex[dates_ind[0]].date()}'\n# plt.savefig(product_path/f'{logratiolabel}.png',\n#             dpi=200, transparent='true')\n# masks[logratiolabel] = np.logical_not(mask)","key":"VZ9vKvloQN"},{"type":"output","id":"Mb0GyqoyMqIaA1CRJouvx","data":[],"key":"NOS38XI9KQ"}],"key":"UPH5NXxHDP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# np.nanpercentile(np.copy(ratiodB), [0.1, 99.9])\nlow, high = (ratiodB.quantile([0.01, 0.99]))\nlow.compute().item()","key":"GZGfGWK3Uv"},{"type":"output","id":"LVN6L5YgW77kKQ1LCnKLb","data":[{"output_type":"execute_result","execution_count":92,"metadata":{},"data":{"text/plain":{"content":"-2.417687692831179","content_type":"text/plain"}}}],"key":"gYMexSmh7y"}],"key":"nKmbMa2sqH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"high.compute().item()","key":"fnP1MM37Hc"},{"type":"output","id":"NVK_BGYGHPatYQLljtT6V","data":[{"output_type":"execute_result","execution_count":93,"metadata":{},"data":{"text/plain":{"content":"-2.417687692831178","content_type":"text/plain"}}}],"key":"V6X6RATwJm"}],"key":"uEkRxbEoy6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"thresh = -2\na = ratiodB < thresh\na.max().compute().item()","key":"OdhaSWCX8L"},{"type":"output","id":"hpRaf8hcFPXixQ-E594Hy","data":[{"output_type":"execute_result","execution_count":99,"metadata":{},"data":{"text/plain":{"content":"True","content_type":"text/plain"}}}],"key":"r1NaHsCPRC"}],"key":"prVauC7bEN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"thresh = -2\nthresh_type = 'lower' #'lower': mask everything below thresh, 'upper': mask everything above\n\nabs_ratiodB = np.abs(ratiodB)\ndynamic_range = abs_ratiodB.quantile(0.99, skipna=True).compute().item()\n\n\nfig, axs = plt.subplots(ncols=3, nrows=1)\nfig.set_size_inches(20, 4)\nplt.subplots_adjust(hspace=0.4, right=0.85)\n\n# h = axs[0].hist(\n#         ratiodB.flatten(), bins=200, range=np.nanpercentile(ratiodB, [0.1, 99.9]))\n\naxs[0].hist(\n        ratiodB.values.ravel(), bins=10, range=np.nanpercentile(ratiodB, [0.1, 99.9]))\n\naxs[0].xaxis.set_label_text(f'difference [dB]')\naxs[0].set_title('Histogram')\n\nim0 = axs[1].imshow(ratiodB, cmap='RdBu', vmin=-dynamic_range, vmax=dynamic_range)\ncbar = fig.colorbar(im0, orientation='vertical', ax=axs.ravel().tolist(), shrink=0.7)\ncbar.set_label('[dB]')\naxs[1].set_title('Image')\n\nmask = (ratiodB > thresh if thresh_type == 'lower' else ratiodB < thresh).astype(np.int8)\n\naxs[2].imshow(mask, cmap='gray')\naxs[2].set_title('Mask')\nfig.suptitle(f'{tindex[dates_ind[0]].date()} {tindex[dates_ind[0]].date()}')\nlogratiolabel = f'logratio_{tindex[dates_ind[0]].date()}_{tindex[dates_ind[0]].date()}'\nplt.savefig(product_path/f'{logratiolabel}.png',\n            dpi=200, transparent='true')\nmasks[logratiolabel] = np.logical_not(mask)","key":"bOiB9hdLtg"},{"type":"output","id":"hpOZ9pMLQWn2pKdhcx_Ij","data":[{"ename":"ValueError","evalue":"Too many bins for data range. Cannot create 10 finite-sized bins.","output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mValueError\u001b[39m                                Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[101]\u001b[39m\u001b[32m, line 15\u001b[39m\n\u001b[32m     10\u001b[39m plt.subplots_adjust(hspace=\u001b[32m0.4\u001b[39m, right=\u001b[32m0.85\u001b[39m)\n\u001b[32m     12\u001b[39m \u001b[38;5;66;03m# h = axs[0].hist(\u001b[39;00m\n\u001b[32m     13\u001b[39m \u001b[38;5;66;03m#         ratiodB.flatten(), bins=200, range=np.nanpercentile(ratiodB, [0.1, 99.9]))\u001b[39;00m\n\u001b[32m---> \u001b[39m\u001b[32m15\u001b[39m \u001b[43maxs\u001b[49m\u001b[43m[\u001b[49m\u001b[32;43m0\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m.\u001b[49m\u001b[43mhist\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m     16\u001b[39m \u001b[43m        \u001b[49m\u001b[43mratiodB\u001b[49m\u001b[43m.\u001b[49m\u001b[43mvalues\u001b[49m\u001b[43m.\u001b[49m\u001b[43mravel\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mbins\u001b[49m\u001b[43m=\u001b[49m\u001b[32;43m10\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mrange\u001b[39;49m\u001b[43m=\u001b[49m\u001b[43mnp\u001b[49m\u001b[43m.\u001b[49m\u001b[43mnanpercentile\u001b[49m\u001b[43m(\u001b[49m\u001b[43mratiodB\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m[\u001b[49m\u001b[32;43m0.1\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[32;43m99.9\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     18\u001b[39m axs[\u001b[32m0\u001b[39m].xaxis.set_label_text(\u001b[33mf\u001b[39m\u001b[33m'\u001b[39m\u001b[33mdifference [dB]\u001b[39m\u001b[33m'\u001b[39m)\n\u001b[32m     19\u001b[39m axs[\u001b[32m0\u001b[39m].set_title(\u001b[33m'\u001b[39m\u001b[33mHistogram\u001b[39m\u001b[33m'\u001b[39m)\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/_api/deprecation.py:453\u001b[39m, in \u001b[36mmake_keyword_only.<locals>.wrapper\u001b[39m\u001b[34m(*args, **kwargs)\u001b[39m\n\u001b[32m    447\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mlen\u001b[39m(args) > name_idx:\n\u001b[32m    448\u001b[39m     warn_deprecated(\n\u001b[32m    449\u001b[39m         since, message=\u001b[33m\"\u001b[39m\u001b[33mPassing the \u001b[39m\u001b[38;5;132;01m%(name)s\u001b[39;00m\u001b[33m \u001b[39m\u001b[38;5;132;01m%(obj_type)s\u001b[39;00m\u001b[33m \u001b[39m\u001b[33m\"\u001b[39m\n\u001b[32m    450\u001b[39m         \u001b[33m\"\u001b[39m\u001b[33mpositionally is deprecated since Matplotlib \u001b[39m\u001b[38;5;132;01m%(since)s\u001b[39;00m\u001b[33m; the \u001b[39m\u001b[33m\"\u001b[39m\n\u001b[32m    451\u001b[39m         \u001b[33m\"\u001b[39m\u001b[33mparameter will become keyword-only in \u001b[39m\u001b[38;5;132;01m%(removal)s\u001b[39;00m\u001b[33m.\u001b[39m\u001b[33m\"\u001b[39m,\n\u001b[32m    452\u001b[39m         name=name, obj_type=\u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[33mparameter of \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mfunc.\u001b[34m__name__\u001b[39m\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m()\u001b[39m\u001b[33m\"\u001b[39m)\n\u001b[32m--> \u001b[39m\u001b[32m453\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mfunc\u001b[49m\u001b[43m(\u001b[49m\u001b[43m*\u001b[49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/__init__.py:1524\u001b[39m, in \u001b[36m_preprocess_data.<locals>.inner\u001b[39m\u001b[34m(ax, data, *args, **kwargs)\u001b[39m\n\u001b[32m   1521\u001b[39m \u001b[38;5;129m@functools\u001b[39m.wraps(func)\n\u001b[32m   1522\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34minner\u001b[39m(ax, *args, data=\u001b[38;5;28;01mNone\u001b[39;00m, **kwargs):\n\u001b[32m   1523\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m data \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[32m-> \u001b[39m\u001b[32m1524\u001b[39m         \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mfunc\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m   1525\u001b[39m \u001b[43m            \u001b[49m\u001b[43max\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1526\u001b[39m \u001b[43m            \u001b[49m\u001b[43m*\u001b[49m\u001b[38;5;28;43mmap\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43mcbook\u001b[49m\u001b[43m.\u001b[49m\u001b[43msanitize_sequence\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43margs\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1527\u001b[39m \u001b[43m            \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43m{\u001b[49m\u001b[43mk\u001b[49m\u001b[43m:\u001b[49m\u001b[43m \u001b[49m\u001b[43mcbook\u001b[49m\u001b[43m.\u001b[49m\u001b[43msanitize_sequence\u001b[49m\u001b[43m(\u001b[49m\u001b[43mv\u001b[49m\u001b[43m)\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mfor\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mk\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mv\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;129;43;01min\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m.\u001b[49m\u001b[43mitems\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m}\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   1529\u001b[39m     bound = new_sig.bind(ax, *args, **kwargs)\n\u001b[32m   1530\u001b[39m     auto_label = (bound.arguments.get(label_namer)\n\u001b[32m   1531\u001b[39m                   \u001b[38;5;129;01mor\u001b[39;00m bound.kwargs.get(label_namer))\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/axes/_axes.py:7132\u001b[39m, in \u001b[36mAxes.hist\u001b[39m\u001b[34m(self, x, bins, range, density, weights, cumulative, bottom, histtype, align, orientation, rwidth, log, color, label, stacked, **kwargs)\u001b[39m\n\u001b[32m   7128\u001b[39m \u001b[38;5;66;03m# Loop through datasets\u001b[39;00m\n\u001b[32m   7129\u001b[39m \u001b[38;5;28;01mfor\u001b[39;00m i \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(nx):\n\u001b[32m   7130\u001b[39m     \u001b[38;5;66;03m# this will automatically overwrite bins,\u001b[39;00m\n\u001b[32m   7131\u001b[39m     \u001b[38;5;66;03m# so that each histogram uses the same bins\u001b[39;00m\n\u001b[32m-> \u001b[39m\u001b[32m7132\u001b[39m     m, bins = \u001b[43mnp\u001b[49m\u001b[43m.\u001b[49m\u001b[43mhistogram\u001b[49m\u001b[43m(\u001b[49m\u001b[43mx\u001b[49m\u001b[43m[\u001b[49m\u001b[43mi\u001b[49m\u001b[43m]\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mbins\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mweights\u001b[49m\u001b[43m=\u001b[49m\u001b[43mw\u001b[49m\u001b[43m[\u001b[49m\u001b[43mi\u001b[49m\u001b[43m]\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mhist_kwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   7133\u001b[39m     tops.append(m)\n\u001b[32m   7134\u001b[39m tops = np.array(tops, \u001b[38;5;28mfloat\u001b[39m)  \u001b[38;5;66;03m# causes problems later if it's an int\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/numpy/lib/_histograms_impl.py:792\u001b[39m, in \u001b[36mhistogram\u001b[39m\u001b[34m(a, bins, range, density, weights)\u001b[39m\n\u001b[32m    687\u001b[39m \u001b[38;5;250m\u001b[39m\u001b[33mr\u001b[39m\u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m    688\u001b[39m \u001b[33;03mCompute the histogram of a dataset.\u001b[39;00m\n\u001b[32m    689\u001b[39m \n\u001b[32m   (...)\u001b[39m\u001b[32m    788\u001b[39m \n\u001b[32m    789\u001b[39m \u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m    790\u001b[39m a, weights = _ravel_and_check_weights(a, weights)\n\u001b[32m--> \u001b[39m\u001b[32m792\u001b[39m bin_edges, uniform_bins = \u001b[43m_get_bin_edges\u001b[49m\u001b[43m(\u001b[49m\u001b[43ma\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mbins\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mrange\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mweights\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    794\u001b[39m \u001b[38;5;66;03m# Histogram is an integer or a float array depending on the weights.\u001b[39;00m\n\u001b[32m    795\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m weights \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/numpy/lib/_histograms_impl.py:449\u001b[39m, in \u001b[36m_get_bin_edges\u001b[39m\u001b[34m(a, bins, range, weights)\u001b[39m\n\u001b[32m    445\u001b[39m     bin_edges = np.linspace(\n\u001b[32m    446\u001b[39m         first_edge, last_edge, n_equal_bins + \u001b[32m1\u001b[39m,\n\u001b[32m    447\u001b[39m         endpoint=\u001b[38;5;28;01mTrue\u001b[39;00m, dtype=bin_type)\n\u001b[32m    448\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m np.any(bin_edges[:-\u001b[32m1\u001b[39m] >= bin_edges[\u001b[32m1\u001b[39m:]):\n\u001b[32m--> \u001b[39m\u001b[32m449\u001b[39m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[32m    450\u001b[39m             \u001b[33mf\u001b[39m\u001b[33m'\u001b[39m\u001b[33mToo many bins for data range. Cannot create \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mn_equal_bins\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m \u001b[39m\u001b[33m'\u001b[39m\n\u001b[32m    451\u001b[39m             \u001b[33mf\u001b[39m\u001b[33m'\u001b[39m\u001b[33mfinite-sized bins.\u001b[39m\u001b[33m'\u001b[39m)\n\u001b[32m    452\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m bin_edges, (first_edge, last_edge, n_equal_bins)\n\u001b[32m    453\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\n\u001b[31mValueError\u001b[39m: Too many bins for data range. Cannot create 10 finite-sized bins."},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a5c94d99e1bb5465aeabd1ead728728d","path":"/NISAR_GCOV_Cookbook/build/a5c94d99e1bb5465aeabd1ead728728d.png"},"text/plain":{"content":"<Figure size 2000x400 with 3 Axes>","content_type":"text/plain"}}}],"key":"tFP5VJYVF3"}],"key":"HY9CFHLgcM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"DNuT7dkDfu"},{"type":"output","id":"S02wv2PKDuQ3ToGPc_p94","data":[],"key":"fvTD3QrH1g"}],"key":"BQriRYMUcG"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Do you think the threshold is appropriate? If not, try adjusting it.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dRYVXFLgAv"}],"key":"kLUjiLGlGF"}],"key":"T49T9gDSiJ"}],"key":"aMH1yMfGQN"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fakMenQwIG"},{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"7. Write Our Change Detection Results and Metrics Images to GeoTIFF files","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Gti7hKJwMo"}],"identifier":"id-7-write-our-change-detection-results-and-metrics-images-to-geotiff-files","label":"7. Write Our Change Detection Results and Metrics Images to GeoTIFF files","html_id":"id-7-write-our-change-detection-results-and-metrics-images-to-geotiff-files","implicit":true,"key":"Pi74eI8Y66"},{"type":"heading","depth":3,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"7.1 Determine Output Geometry","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"caqueGFEqT"}],"identifier":"id-7-1-determine-output-geometry","label":"7.1 Determine Output Geometry","html_id":"id-7-1-determine-output-geometry","implicit":true,"key":"zVOoLuTsjh"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"First, we need to ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"nQIkpETCxT"},{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"set the correct geotransformation and projection information","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"oO2rvjRLVA"}],"key":"mW4M0gtfsv"},{"type":"text","value":". We retrieve the values from the input images:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"kdKMscg88g"}],"key":"aWs68ftqfJ"}],"key":"tl2g7YQWkp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"proj=img.GetProjection()\ngeotrans=list(img.GetGeoTransform())\ngeotrans","key":"PN6zqFw8tH"},{"type":"output","id":"Xcli43KtGcmCOSTz2wee1","data":[],"key":"otSU4NLYft"}],"key":"jegIkcDSHp"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"7.2 Output Time Series Metrics Images","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BrsXsYOern"}],"identifier":"id-7-2-output-time-series-metrics-images","label":"7.2 Output Time Series Metrics Images","html_id":"id-7-2-output-time-series-metrics-images","implicit":true,"key":"NpB8jAOap6"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We use the root of the time series data stack name and append a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Tc1UbgoHeb"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"ts_metrics","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KDUv1QsQsE"}],"key":"BnsHwE7u90"},{"type":"text","value":"<metric>.tif ending as filenames:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MdGjQyh097"}],"key":"Z58sGqzIkU"}],"key":"OCu0AfEn02"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Time Series Metrics as image:\n# We make a new subdirectory where we will store the images\n\ndirname = analysis_dir/f\"{str(analysis_dir).split('/')[-1]}_tsmetrics_{pol}\"\nif not dirname.exists():\n    dirname.mkdir()\n\nprint(dirname)","key":"AsUjc5N4JT"},{"type":"output","id":"IBy--y8p_71gI3CDfrXXr","data":[],"key":"hwl09NcKoP"}],"key":"XLVRpIxF8y"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we can ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HzmyUuZ9ee"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"output the individual metrics as GeoTIFF images","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tjlKGPeMWk"}],"key":"lycLdD3TRD"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SvMxYtDTmb"}],"key":"rgqLrPWCQI"}],"key":"zDuDJLGETi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"names=[] # List to keep track of all the names\nfor metric in metrics:\n    name_ = dirname/f'{metric}_{labeldB}.tif'\n    create_geotiff(str(name_), metrics[metric], gdal.GDT_Float32, np.nan, [metric],\n                  geo_t=geotrans, projection=proj)\n    names.append(str(name_))","key":"m90xDoqb7G"},{"type":"output","id":"wqx3Rbg3F78h40dJpou1v","data":[],"key":"BQy9Ga1YHU"}],"key":"BU8onR3C78"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"7.3 Build a Virtual Raster Table on the Metrics GeoTIFF images","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yl9w3wwMI9"}],"identifier":"id-7-3-build-a-virtual-raster-table-on-the-metrics-geotiff-images","label":"7.3 Build a Virtual Raster Table on the Metrics GeoTIFF images","html_id":"id-7-3-build-a-virtual-raster-table-on-the-metrics-geotiff-images","implicit":true,"key":"uvmqsld8UK"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To tie the images into one new raster stack of time series metrics we build a virtual raster table with all the metrics.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rHgnCppIV7"}],"key":"I1DZwLmPWU"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Trick: Use ’ '.join(names) to build one long string of names separated by a space as input to ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wMfTV6EP3k"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"gdalbuildvrt","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"OaRCnbV4J0"}],"key":"FFnTn62Sfq"},{"type":"text","value":":","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"aoeiC4OQe9"}],"key":"EIn5NUB05z"}],"key":"ErL2xEFSzy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cmd=f'gdalbuildvrt -separate -overwrite -vrtnodata nan {str(dirname)}' +\\\nf'_{labeldB}.vrt '+' '.join(names)\nprint(cmd)\n\n_ = system(cmd)","key":"umodTRYptA"},{"type":"output","id":"Zx0H3pTp5DprlEZxfsG21","data":[],"key":"LBcjOr6Qp5"}],"key":"EN1ifYxHgP"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"7.4 Create GeoTIFFs for the Change Iamges from our Four Change Detection Attempts","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P0BEqC7K2A"}],"identifier":"id-7-4-create-geotiffs-for-the-change-iamges-from-our-four-change-detection-attempts","label":"7.4 Create GeoTIFFs for the Change Iamges from our Four Change Detection Attempts","html_id":"id-7-4-create-geotiffs-for-the-change-iamges-from-our-four-change-detection-attempts","implicit":true,"key":"Q5JdFtogyC"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We are going to write GeoTIFF output files that stores the results from the classifiers:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yS0y8ZjDmt"}],"key":"xPhFVryVWH"}],"key":"QBhNR3cFm9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for metric in masks:  \n    fnmetric = dirname/f\"{str(analysis_dir).split('/')[-1]}_{labeldB}_{metric}_thresholds.tif\"\n    print(fnmetric)\n\n    create_geotiff(str(fnmetric), masks[metric], gdal.GDT_Byte, np.nan, \n                  geo_t=geotrans, projection=proj)","key":"Nb6DLxfchk"},{"type":"output","id":"YW3OeOMej93kxSnq7h3o9","data":[],"key":"iPPXOyuZ3s"}],"key":"H9qpjjbSF8"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"SARChangeDetectionMethods_From_Prepared_Data_Stack - Version 1.4.2 - November 2021","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cqhoO6G3tD"}],"key":"Zkxgv9YucM"}],"key":"GKsWk2cJkk"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Version Changes","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FUvVdqcJLi"}],"key":"BohYb4MjsS"}],"key":"XGYCgZDe2K"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"update get_date function","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"fYt22k2sZl"}],"key":"OkTMbnDX7T"}],"key":"S94pNgmSWT"}],"key":"dlqymFgLwq"}],"key":"IKgGaiqnkX"}],"key":"joEB4nwSoU"}],"key":"kP9W4pJBpC"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Explore an Example NISAR GCOV Backscatter Time Series","url":"/notebooks/nisar-gcov-time-series-example","group":"Placeholder (unorganized notebooks)"}}},"domain":"http://localhost:3000"}