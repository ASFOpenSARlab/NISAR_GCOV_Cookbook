<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>An Introduction to Simple SAR Change Detection Methods - NISAR GCOV Cookbook</title><meta property="og:title" content="An Introduction to Simple SAR Change Detection Methods - NISAR GCOV Cookbook"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><meta name="image" content="/NISAR_GCOV_Cookbook/build/thumbnail-026dbb82f595025330104291f168d4b8.png"/><meta property="og:image" content="/NISAR_GCOV_Cookbook/build/thumbnail-026dbb82f595025330104291f168d4b8.png"/><link rel="stylesheet" href="/NISAR_GCOV_Cookbook/build/_assets/app-PKKJHBHV.css"/><link rel="stylesheet" href="/NISAR_GCOV_Cookbook/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/NISAR_GCOV_Cookbook/favicon.ico"/><link rel="stylesheet" href="/NISAR_GCOV_Cookbook/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="https://asf.alaska.edu/"><div class="p-1 mr-3 dark:bg-white dark:rounded"><img src="/NISAR_GCOV_Cookbook/build/config-item-08e8db8a-6ef1367255b30e794122aa323fd27dd2.svg" class="h-9" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"><div class="relative inline-block mx-2 grow-0" data-headlessui-state=""><div class="inline-block"><button class="inline-flex items-center justify-center w-full py-1 mx-2 font-medium rounded-md text-md text-stone-900 dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75" id="headlessui-menu-button-:R4j58p:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span>ASF</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="ml-2 -mr-1 text-violet-200 hover:text-violet-100"><path fill-rule="evenodd" d="M12.53 16.28a.75.75 0 0 1-1.06 0l-7.5-7.5a.75.75 0 0 1 1.06-1.06L12 14.69l6.97-6.97a.75.75 0 1 1 1.06 1.06l-7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div></div><div class="relative inline-block mx-2 grow-0"><a class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75" href="/NISAR_GCOV_Cookbookhttps://www.earthdata.nasa.gov/">NASA Earthdata</a></div><div class="relative inline-block mx-2 grow-0"><a class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75" href="/NISAR_GCOV_Cookbookhttps://projectpythia.org">Project Pythia</a></div><div class="relative inline-block mx-2 grow-0"><a class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75" href="/NISAR_GCOV_Cookbookhttps://github.com/ASFOpenSARlab">SAR Cookbooks</a></div></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R758p:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"><div class="relative" data-headlessui-state=""><div><button class="flex text-sm bg-transparent rounded-full focus:outline-none" id="headlessui-menu-button-:Rr58p:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open Menu</span><div class="flex items-center text-stone-200 hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="p-1"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="hidden sm:block"><a href="https://asf.alaska.edu/" target="_blank" rel="noopener noreferrer" class="inline-block px-4 py-2 mx-1 mt-0 leading-none border rounded text-md border-stone-700 dark:border-white text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 hover:bg-neutral-100">ASF</a></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a class="py-2 grow" href="/NISAR_GCOV_Cookbookundefined">ASF</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rapop:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rapop:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><a class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded" href="/NISAR_GCOV_Cookbookhttps://www.earthdata.nasa.gov/">NASA Earthdata</a><a class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded" href="/NISAR_GCOV_Cookbookhttps://projectpythia.org">Project Pythia</a><a class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded" href="/NISAR_GCOV_Cookbookhttps://github.com/ASFOpenSARlab">SAR Cookbooks</a></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="NISAR GCOV Cookbook" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/NISAR_GCOV_Cookbook/">NISAR GCOV Cookbook</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Introduction to NISAR GCOV data" class="block break-words rounded py-2 grow cursor-pointer">Introduction to NISAR GCOV data</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmpop:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmpop:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Prerequisites" class="block break-words rounded py-2 grow cursor-pointer">Prerequisites</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rupop:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rupop:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Placeholder (unorganized notebooks)" class="block break-words rounded py-2 grow cursor-pointer">Placeholder (unorganized notebooks)</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R16pop:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R16pop:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center mb-5 h-6 text-sm font-light"><div class="flex-grow"></div><a href="https://opensource.org/licenses/BSD-3-Clause" target="_blank" rel="noopener noreferrer" title="Content License: BSD 3-Clause &quot;New&quot; or &quot;Revised&quot; License (BSD-3-Clause)" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="mx-1 inline-block opacity-60 hover:opacity-100 hover:text-[#599F46]"><path d="M13.2 15.6c1.4-.5 2.1-1.6 2.1-3.3S13.8 8.9 12 8.9c-1.9 0-3.3 1.6-3.3 3.3 0 1.8.8 3 2.2 3.4l-2.3 5.9c-3.1-.8-6.3-4.6-6.3-9.3 0-5.5 4.3-10 9.7-10s9.8 4.5 9.8 10c0 4.7-3.1 8.5-6.3 9.3l-2.3-5.9z"></path></svg></a><a href="https://en.wikipedia.org/wiki/Open_access" target="_blank" rel="noopener noreferrer" title="Open Access" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="mr-1 inline-block opacity-60 hover:opacity-100 hover:text-[#E18435]"><path d="M17.1 12.6h-2V7.5c0-1.7-1.4-3.1-3-3.1-.8 0-1.6.3-2.2.9-.6.5-.9 1.3-.9 2.2v.7H7v-.7c0-1.4.5-2.7 1.5-3.7s2.2-1.5 3.6-1.5 2.6.5 3.6 1.5 1.5 2.3 1.5 3.7v5.1z"></path><path d="M12 21.8c-.8 0-1.6-.2-2.3-.5-.7-.3-1.4-.8-1.9-1.3-.6-.6-1-1.2-1.3-2-.3-.8-.5-1.6-.5-2.4s.2-1.6.5-2.4c.3-.7.7-1.4 1.3-2s1.2-1 1.9-1.3c.7-.3 1.5-.5 2.3-.5.8 0 1.6.2 2.3.5.7.3 1.4.8 1.9 1.3.6.6 1 1.2 1.3 2 .3.8.5 1.6.5 2.4s-.2 1.6-.5 2.4c-.3.7-.7 1.4-1.3 2-.6.6-1.2 1-1.9 1.3-.7.3-1.5.5-2.3.5zm0-10.3c-2.2 0-4 1.8-4 4.1s1.8 4.1 4 4.1 4-1.8 4-4.1-1.8-4.1-4-4.1z"></path><circle cx="12" cy="15.6" r="1.7"></circle></svg></a><a href="https://github.com/ASFOpenSARlab/NISAR_GCOV_Cookbook" title="GitHub Repository: ASFOpenSARlab/NISAR_GCOV_Cookbook" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><a href="https://github.com/ASFOpenSARlab/NISAR_GCOV_Cookbook/edit/main/notebooks/NISAR_GCOV_SARChangeDetectionMethods.ipynb" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8u8p:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div><button class="inline-flex size-[24px] hover:text-[#E18435] items-center justify-center" aria-label="Launch in external computing interface" title="Launch in external computing interface" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Re8u8p:" data-state="closed"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.85357 3.85355L7.65355 3.05353C8.2981 2.40901 9.42858 1.96172 10.552 1.80125C11.1056 1.72217 11.6291 1.71725 12.0564 1.78124C12.4987 1.84748 12.7698 1.97696 12.8965 2.10357C13.0231 2.23018 13.1526 2.50125 13.2188 2.94357C13.2828 3.37086 13.2779 3.89439 13.1988 4.44801C13.0383 5.57139 12.591 6.70188 11.9464 7.34645L7.49999 11.7929L6.35354 10.6465C6.15827 10.4512 5.84169 10.4512 5.64643 10.6465C5.45117 10.8417 5.45117 11.1583 5.64643 11.3536L7.14644 12.8536C7.34171 13.0488 7.65829 13.0488 7.85355 12.8536L8.40073 12.3064L9.57124 14.2572C9.65046 14.3893 9.78608 14.4774 9.9389 14.4963C10.0917 14.5151 10.2447 14.4624 10.3535 14.3536L12.3535 12.3536C12.4648 12.2423 12.5172 12.0851 12.495 11.9293L12.0303 8.67679L12.6536 8.05355C13.509 7.19808 14.0117 5.82855 14.1887 4.58943C14.2784 3.9618 14.2891 3.33847 14.2078 2.79546C14.1287 2.26748 13.9519 1.74482 13.6035 1.39645C13.2552 1.04809 12.7325 0.871332 12.2045 0.792264C11.6615 0.710945 11.0382 0.721644 10.4105 0.8113C9.17143 0.988306 7.80189 1.491 6.94644 2.34642L6.32322 2.96968L3.07071 2.50504C2.91492 2.48278 2.75773 2.53517 2.64645 2.64646L0.646451 4.64645C0.537579 4.75533 0.484938 4.90829 0.50375 5.0611C0.522563 5.21391 0.61073 5.34954 0.742757 5.42876L2.69364 6.59928L2.14646 7.14645C2.0527 7.24022 2.00002 7.3674 2.00002 7.50001C2.00002 7.63261 2.0527 7.75979 2.14646 7.85356L3.64647 9.35356C3.84173 9.54883 4.15831 9.54883 4.35357 9.35356C4.54884 9.1583 4.54884 8.84172 4.35357 8.64646L3.20712 7.50001L3.85357 6.85356L6.85357 3.85355ZM10.0993 13.1936L9.12959 11.5775L11.1464 9.56067L11.4697 11.8232L10.0993 13.1936ZM3.42251 5.87041L5.43935 3.85356L3.17678 3.53034L1.80638 4.90074L3.42251 5.87041ZM2.35356 10.3535C2.54882 10.1583 2.54882 9.8417 2.35356 9.64644C2.1583 9.45118 1.84171 9.45118 1.64645 9.64644L0.646451 10.6464C0.451188 10.8417 0.451188 11.1583 0.646451 11.3535C0.841713 11.5488 1.1583 11.5488 1.35356 11.3535L2.35356 10.3535ZM3.85358 11.8536C4.04884 11.6583 4.04885 11.3417 3.85359 11.1465C3.65833 10.9512 3.34175 10.9512 3.14648 11.1465L1.14645 13.1464C0.95119 13.3417 0.951187 13.6583 1.14645 13.8535C1.34171 14.0488 1.65829 14.0488 1.85355 13.8536L3.85358 11.8536ZM5.35356 13.3535C5.54882 13.1583 5.54882 12.8417 5.35356 12.6464C5.1583 12.4512 4.84171 12.4512 4.64645 12.6464L3.64645 13.6464C3.45119 13.8417 3.45119 14.1583 3.64645 14.3535C3.84171 14.5488 4.1583 14.5488 4.35356 14.3535L5.35356 13.3535ZM9.49997 6.74881C10.1897 6.74881 10.7488 6.1897 10.7488 5.5C10.7488 4.8103 10.1897 4.25118 9.49997 4.25118C8.81026 4.25118 8.25115 4.8103 8.25115 5.5C8.25115 6.1897 8.81026 6.74881 9.49997 6.74881Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></button></div><h1 class="mb-0">An Introduction to Simple SAR Change Detection Methods</h1><header class="mt-4 not-prose"><div><span class="font-semibold text-sm inline-block"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78u8p:" data-state="closed">The Alaska Satellite Facility</button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div class="sticky top-[60px] pb-[14px] flex justify-end w-full z-20 pointer-events-none"><div class="flex p-1 m-1 space-x-1 border rounded-full shadow pointer-events-auto border-stone-300 bg-white/80 dark:bg-stone-900/80 backdrop-blur"><div class="rounded"><button class="flex text-center rounded-full cursor-pointer text-stone-800 dark:text-white hover:opacity-100 opacity-60" aria-label="start compute environment"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="inline-block w-6 h-6 align-top"><title>Launch kernel</title><path stroke-linecap="round" stroke-linejoin="round" d="M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"></path></svg></button></div></div></div><div id="skip-to-article"></div><div id="aXJO0Q6los" class="relative group/block"><img id="jLVLvAErfw" style="margin:0 auto" src="/myst_assets_folderNotebookAddons/blackboard-banner.png" alt="OpenSARlab notebook banner" class=""/><h1 id="an-introduction-to-simple-sar-change-detection-methods" class="relative group"><span class="heading-text">An Introduction to Simple SAR Change Detection Methods</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#an-introduction-to-simple-sar-change-detection-methods" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><h3 id="franz-j-meyer-university-of-alaska-fairbanks" class="relative group"><span class="heading-text">Franz J Meyer; University of Alaska Fairbanks</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#franz-j-meyer-university-of-alaska-fairbanks" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><img id="r9zqEmfMYn" style="width:170px;margin:0 auto" src="/myst_assets_folderNotebookAddons/UAFLogo_A_647.png" class=""/><p>This notebook introduces you to a some popular change detection methods that can be applied on SAR time series data. SAR is an excellent tool for change detection. As SAR sensors are weather and illumination independent, and as SAR’s carry their own illumination source (active sensor), differences between repeated images are a direct indication of changes on the surface. This fact is exploited by the change detection methods introduced below.</p><p>The exercise is done in the framework of <em>Jupyter Notebooks</em>. The Jupyter Notebook environment is easy to launch in any web browser for interactive data exploration with provided or new training data. Notebooks are comprised of text written in a combination of executable python code and markdown formatting including latex style mathematical equations. Another advantage of Jupyter Notebooks is that they can easily be expanded, changed, and shared with new data sets or newly available time series steps. Therefore, they provide an excellent basis for collaborative and repeatable data analysis.</p><p><strong>This notebook covers the following data analysis concepts:</strong></p><ul><li><p>Time series metrics  95<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> and 5<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> percentile difference thresholding</p></li><li><p>Time series coefficient of variation thresholding</p></li><li><p>Log Ratio-based change detection from image pairs</p></li></ul></div><div id="rq52k1goF5" class="relative group/block"><hr class="py-2 my-5 translate-y-2"/><p><strong>0. Importing Relevant Python Packages</strong></p><p>In this notebook we will use the following scientific libraries:</p><ol start="1"><li><p><strong><a target="_blank" rel="noreferrer" href="https://pandas.pydata.org/" class="">Pandas</a></strong> is a Python library that provides high-level data structures and a vast variety of tools for analysis. The great feature of this package is the ability to translate rather complex operations with data into one or two commands. Pandas contains many built-in methods for filtering and combining data, as well as the time-series functionality.</p></li><li><p><strong><a target="_blank" rel="noreferrer" href="https://www.gdal.org/" class="">GDAL</a></strong> is a software library for reading and writing raster and vector geospatial data formats. It includes a collection of programs tailored for geospatial data processing. Most modern GIS systems (such as ArcGIS or QGIS) use GDAL in the background.</p></li><li><p><strong><a target="_blank" rel="noreferrer" href="http://www.numpy.org/" class="">NumPy</a></strong> is one of the principal packages for scientific applications of Python. It is intended for processing large multidimensional arrays and matrices, and an extensive collection of high-level mathematical functions and implemented methods makes it possible to perform various operations with these objects.</p></li><li><p><strong><a target="_blank" rel="noreferrer" href="https://matplotlib.org/index.html" class="">Matplotlib</a></strong> is a low-level library for creating two-dimensional diagrams and graphs. With its help, you can build diverse charts, from histograms and scatterplots to non-Cartesian coordinates graphs. Moreover, many popular plotting libraries are designed to work in conjunction with matplotlib.</p></li><li><p>The <strong><a target="_blank" rel="noreferrer" href="https://www.pydoc.io/pypi/asf-hyp3-1.1.1/index.html" class="">asf-hyp3 API</a></strong> provides useful functions and scripts for accessing and processing SAR data via the Alaska Satellite Facility&#x27;s Hybrid Pluggable Processing Pipeline, or HyP3 (pronounced &quot;hype&quot;).</p></li><li><p><strong><a target="_blank" rel="noreferrer" href="https://www.scipy.org/about.html" class="">SciPY</a></strong> is a library that provides functions for numerical integration, interpolation, optimization, linear algebra and statistics.</p></li></ol><p>Our first step is to <strong>import them:</strong></p></div><div id="nvFji2Yrgl" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># %%capture
# from pathlib import Path
# from os import system
# import datetime # for date
# import re

# import pandas as pd # for DatetimeIndex
# from osgeo import gdal # for Info
# gdal.UseExceptions()

# %matplotlib inline
# import matplotlib.pyplot as plt
# from matplotlib import animation
# from matplotlib import rc
# import numpy as np

# from ipyfilechooser import FileChooser

# from IPython.display import HTML

# import opensarlab_lib as asfn
# asfn.jupytertheme_matplotlib_format()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="cJdgUOFR5bDSDZFnfg-sb" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="BXGvmrwcqy" class="relative group/block"><h2 id="id-1-load-data-stack" class="relative group"><span class="heading-text">1. Load Data Stack</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-load-data-stack" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>In the Exercise4A-SARChangeDetectionMethods.ipynb notebook will used a dense 12-day repeat Sentinel-1 C-band SAR data stack. It contained imagery acquired during the year 2018 in Guatemala. The data was already prepared for you. Now, you will later learn how to download and pre-process Sentinel-1 images using the services of the <a target="_blank" rel="noreferrer" href="https://www.asf.alaska.edu/" class="">Alaska Satellite Facility</a>.</p><p><strong>Begin by writing a function to retrieve the absolute paths to each of our tiffs:</strong></p></div><div id="gLZSNPBXIr" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># def get_tiff_paths(paths):
#     tiff_paths = !ls $paths | sort -t_ -k5,5
#     return tiff_paths</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="-MCaFdW36y3wSQzODha0J" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="suIOHgRcGb" class="relative group/block"><p><strong>Select the directory holding your tiffs</strong></p><ul><li><p>Click the <code>Select</code> button</p></li><li><p>Navigate to your data directory</p></li><li><p>Click the <code>Select</code> button</p></li><li><p>Confirm that the desired path appears in green text</p></li><li><p>Click the <code>Change</code> button to alter your selection</p></li></ul></div><div id="fATjb0ozJU" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># fc = FileChooser(Path.cwd())
# display(fc)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="JxcLDiBBKAoNUu07DWIcD" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="nJSmEI7Ucy" class="relative group/block"><p><strong>Determine the path to the analysis directory containing the tiff directory:</strong></p></div><div id="ebstEBoWiP" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from pathlib import Path

change_detection_example_dir = Path.cwd() / &quot;change_detection_example&quot;

data_dir = change_detection_example_dir / &quot;data&quot;
data_dir.mkdir(parents=True, exist_ok=True)

plot_dir = change_detection_example_dir / &quot;plots&quot;
plot_dir.mkdir(exist_ok=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="GApTYIjGz_9RwF39pHehr" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="qsPN0pOgTS" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import os
import asf_search as asf
# from getpass import getpass


wkt = &quot;POLYGON((-57.759 -3.5099,-56.459 -3.5099,-56.459 -2.6352,-57.759 -2.6352,-57.759 -3.5099))&quot;

opts=asf.ASFSearchOptions(**{
    &quot;maxResults&quot;: 250,
    &quot;intersectsWith&quot;: wkt,
    &quot;processingLevel&quot;: [
        &quot;GCOV&quot;
    ],
    &quot;dataset&quot;: [
        &quot;NISAR&quot;
    ],
    &quot;productionConfiguration&quot;: [
        &quot;PR&quot;
    ],
    &quot;host&quot;: &quot;cmr.uat.earthdata.nasa.gov&quot;
})

session = asf.ASFSession(cmr_host=&#x27;cmr.uat.earthdata.nasa.gov&#x27;)
# session.auth_with_token(getpass(&#x27;UAT EDL token&#x27;))
session.auth_with_token(os.environ[&quot;UAT_TOKEN&quot;])

response = asf.search(opts=opts)

hdf5_files = response.find_urls(extension=&#x27;.h5&#x27;, pattern=r&#x27;^(?!.*STATS).*DHDH.*&#x27;, directAccess=False)
asf.download_urls(hdf5_files, data_dir, session=session, processes=4)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="_JnLcJpLaNgq28R48CIpT" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="qZl0cgjnoN" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># TODO: Delete when we have real NISAR data
# Duplicates the one sample GCOV file we have
import shutil

f = list(data_dir.glob(&#x27;*.h5&#x27;))[0]
for i in range(7): 
    shutil.copy(f, f.parent / f&quot;{f.stem}_{i}.h5&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="OYGrgMixboLs5zkD5rzYU" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="jJ3E1hIoiz" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">gcov_files = sorted(list(data_dir.glob(&quot;*.h5&quot;)))
gcov_files</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="jWgc5euFFp-Qn-4sxaiID" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>[PosixPath(&#x27;/home/jovyan/opensarlab-notebooks/SAR_Training/English/Master/change_detection_example/data/NISAR_L2_PR_GCOV_087_039_D_090_2005_DHDH_A_20251102T220639_20251102T220714_T00407_N_F_J_001.h5&#x27;),
 PosixPath(&#x27;/home/jovyan/opensarlab-notebooks/SAR_Training/English/Master/change_detection_example/data/NISAR_L2_PR_GCOV_087_039_D_090_2005_DHDH_A_20251102T220639_20251102T220714_T00407_N_F_J_001_0.h5&#x27;),
 PosixPath(&#x27;/home/jovyan/opensarlab-notebooks/SAR_Training/English/Master/change_detection_example/data/NISAR_L2_PR_GCOV_087_039_D_090_2005_DHDH_A_20251102T220639_20251102T220714_T00407_N_F_J_001_1.h5&#x27;),
 PosixPath(&#x27;/home/jovyan/opensarlab-notebooks/SAR_Training/English/Master/change_detection_example/data/NISAR_L2_PR_GCOV_087_039_D_090_2005_DHDH_A_20251102T220639_20251102T220714_T00407_N_F_J_001_2.h5&#x27;),
 PosixPath(&#x27;/home/jovyan/opensarlab-notebooks/SAR_Training/English/Master/change_detection_example/data/NISAR_L2_PR_GCOV_087_039_D_090_2005_DHDH_A_20251102T220639_20251102T220714_T00407_N_F_J_001_3.h5&#x27;),
 PosixPath(&#x27;/home/jovyan/opensarlab-notebooks/SAR_Training/English/Master/change_detection_example/data/NISAR_L2_PR_GCOV_087_039_D_090_2005_DHDH_A_20251102T220639_20251102T220714_T00407_N_F_J_001_4.h5&#x27;),
 PosixPath(&#x27;/home/jovyan/opensarlab-notebooks/SAR_Training/English/Master/change_detection_example/data/NISAR_L2_PR_GCOV_087_039_D_090_2005_DHDH_A_20251102T220639_20251102T220714_T00407_N_F_J_001_5.h5&#x27;),
 PosixPath(&#x27;/home/jovyan/opensarlab-notebooks/SAR_Training/English/Master/change_detection_example/data/NISAR_L2_PR_GCOV_087_039_D_090_2005_DHDH_A_20251102T220639_20251102T220714_T00407_N_F_J_001_6.h5&#x27;)]</span></code></div></div></div><div id="IA7qbbgk68" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import re
import h5py
import numpy as np
import xarray as xr
import dask.array as da
from dask import delayed

_date_regex = re.compile(r&quot;_(\d{8}T\d{6})_&quot;)
def _get_ts(filename):
    match = _date_regex.search(filename)
    if match:
        ts_str = match.group(1)
        return np.datetime64(f&quot;{ts_str[:4]}-{ts_str[4:6]}-{ts_str[6:8]}T{ts_str[9:11]}:{ts_str[11:13]}:{ts_str[13:15]}&quot;) 
    return np.datetime64(&quot;NaT&quot;)

def open_gcov(gcov_paths, vars_to_load=(&quot;HHHH&quot;, &quot;HVHV&quot;, &quot;mask&quot;, &quot;numberOfLooks&quot;, &quot;rtcGammaToSigmaFactor&quot;), freqs=(&quot;A&quot;,&quot;B&quot;), max_xy_chunk=2048):
    gcov_paths = sorted(gcov_paths)
    group = {f: f&quot;/science/LSAR/GCOV/grids/frequency{f}&quot; for f in freqs}
    with h5py.File(gcov_paths[0], &quot;r&quot;) as f0:
        g = f0[group[freqs[0]]]
        x, y = g[&quot;xCoordinates&quot;][...], g[&quot;yCoordinates&quot;][...]
        proj = g[&quot;projection&quot;][()]
    ny, nx = len(y), len(x)
    time = np.array([_get_ts(p.name) for p in gcov_paths])
    chunks = (1, 1, min(ny, max_xy_chunk), min(nx, max_xy_chunk))  # (time, frequency, y, x)

    data_vars = {}
    for v in vars_to_load:
        per_freq = []
        for freq in freqs:
            with h5py.File(gcov_paths[0], &quot;r&quot;) as f0:
                dt = f0[f&quot;{group[freq]}/{v}&quot;].dtype
            planes = [da.from_delayed(delayed(lambda p, d: h5py.File(p,&quot;r&quot;)[d][...])(p, f&quot;{group[freq]}/{v}&quot;),
                                      shape=(ny, nx), dtype=dt)[None, None, ...]
                      for p in gcov_paths]
            per_freq.append(da.concatenate(planes, axis=0))
        stacked = da.concatenate(per_freq, axis=1).rechunk(chunks)
        data_vars[v] = ((&quot;time&quot;,&quot;frequency&quot;,&quot;y&quot;,&quot;x&quot;), stacked)

    return xr.Dataset(
        data_vars=data_vars,
        coords={&quot;time&quot;: time, &quot;frequency&quot;: np.array(list(freqs)), &quot;y&quot;: y, &quot;x&quot;: x},
        attrs={&quot;source&quot;: &quot;NISAR L2 GCOV&quot;, &quot;projection&quot;: proj},
    )</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="M7_asucSrXJcBkqOJODRj" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="VuCZer9YB7" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">ds = open_gcov(gcov_files)
ds</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="wuuZQuibYCt0R5SdoeQTJ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="A0uhfpQrZk" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># TODO: remove this when there is real NISAR data
# Fakes a time series by updating dates and backscatter

import pandas as pd

fake_times = pd.date_range(
    start=&quot;2025-11-02T22:06:39&quot;,
    periods=ds.sizes[&quot;time&quot;],
    freq=&quot;D&quot;
)

ds = ds.assign_coords(time=fake_times)

# adjust each duplicated time step&#x27;s backscatter values for better test visualization
factors = 1 + 0.3 * np.sin(np.linspace(0, 2*np.pi, ds.sizes[&quot;time&quot;]))
scaled = ds * xr.DataArray(factors, dims=[&quot;time&quot;])
scaled = scaled.assign_attrs(ds.attrs)
ds = scaled
ds</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Aw5FzE3y_tBrH-FvHbAmZ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="fJ8upNgHkT" class="relative group/block"><p><strong>Determine the path to the analysis directory containing the tiff directory:</strong></p></div><div id="FRmbWp5dSq" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># polarization = asfn.select_parameter([&#x27;VV&#x27;, &#x27;VH&#x27;], &#x27;polarization:&#x27;)
# polarization</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="tinJzvJMX6xm5RAm7fGEQ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="yAXIddrXjK" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%%time
polarization = &quot;HVHV&quot;
frequency = &quot;A&quot;

da = ds[polarization].sel(frequency=frequency,
                          x=slice(400000.0, 500000.0),
                          y=slice(9700000.0, 9600000.0))
da = da.assign_attrs({**ds.attrs, **da.attrs})
# da.load()
da</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Vg8Rvid5pZdvNqeNk7ZvU" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="IjPtQUMMKK" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># pol = polarization.value
# print(f&#x27;polarization: {pol}&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="dASSouy97XWVIisrWJ78g" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="YGfskXjDrP" class="relative group/block"><p><strong>Create a wildcard path to the tiffs:</strong></p></div><div id="f6jmL3n2UO" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># if pol == &#x27;VV&#x27;:
#     wildcard_path = f&quot;{tiff_dir}/*VV*.tif*&quot;
# else:
#     wildcard_path = f&quot;{tiff_dir}/*VH*.tif*&quot;
# print(f&#x27;wildcard_path: \n{wildcard_path}&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="a5sJygclQSzpcUa_ebirZ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="IxnZkrN9vR" class="relative group/block"><p><strong>Write a function to extract the tiff dates from a wildcard path.</strong></p></div><div id="I4bzQ1Blf0" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># def get_date(pth):
#     date_regex = r&#x27;(?&lt;=_)\d{8}(?=T\d{6})&#x27;
#     try:
#         return re.search(date_regex, str(pth)).group(0)
#     except AttributeError:
#         raise Exception(f&quot;Date string not found in {pth}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="1FPA5IUN_C4aD6SuDkpp-" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="qEVSSAYfTH" class="relative group/block"><p><strong>Call get_dates() to collect the product acquisition dates:</strong></p></div><div id="jKQFxFddS4" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># file_ext = None
# if pol == &#x27;VV&#x27;:
#     file_ext = f&#x27;*VV*.tif*&#x27;
# else:
#     file_ext = f&#x27;*VH*.tif*&#x27;

# dates = sorted([get_date(d) for d in tiff_dir.rglob(file_ext)])
# print(f&#x27;dates: \n{dates}&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="y3W-3RzKAVGdcG6neatLA" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="JStWAHUPgM" class="relative group/block"><h2 id="id-2-create-the-vrts" class="relative group"><span class="heading-text">2. Create the VRTs</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-create-the-vrts" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p><strong>Create the virtual raster table for the GeoTiffs:</strong></p></div><div id="zyxNduie6S" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># raster_path = f&quot;{analysis_dir}/raster_stack_{pol}.vrt&quot;
# !gdalbuildvrt -separate $raster_path $wildcard_path</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="8is8JEJtNfiOuMLP8eqja" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ZRdkStiFk5" class="relative group/block"><h2 id="id-3-define-some-python-helper-functions-for-this-notebook" class="relative group"><span class="heading-text">3. Define Some Python Helper Functions for this Notebook</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-define-some-python-helper-functions-for-this-notebook" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>We are defining two helper functions for this notebook:</p><ul><li><p><strong>CreateGeoTiff()</strong> to write out images</p></li><li><p><strong>timeseries_metrics()</strong> to compute various metrics from a time series data stack</p></li></ul></div><div id="YKuIQ7V19i" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def create_geotiff(name, array, data_type, ndv, bandnames=None, 
                   ref_image=None, geo_t=None, projection=None):
    # If it&#x27;s a 2D image we fake a third dimension:
    if len(array.shape) == 2:
        array = np.array([array])
    if ref_image == None and (geo_t == None or projection == None):
        raise RuntimeWarning(&#x27;ref_image or settings required.&#x27;)
    if bandnames != None:
        if len(bandnames) != array.shape[0]:
            raise RuntimeError(f&#x27;Need {Array.shape[0]} bandnames. {len(bandnames)} given&#x27;)
    else:
        bandnames = [f&#x27;Band {i+1}&#x27; for i in range(array.shape[0])]
    if ref_image != None:
        refimg = gdal.Open(ref_image)
        geo_t = refimg.GetGeoTransform()
        Projection = refimg.GetProjection()
    driver = gdal.GetDriverByName(&#x27;GTIFF&#x27;)
    array[np.isnan(array)] = ndv
    dataset = driver.Create(name, array.shape[2], array.shape[1], 
                            array.shape[0], data_type)
    dataset.SetGeoTransform(geo_t)
    dataset.SetProjection(projection)
    for i, image in enumerate(array, 1):
        dataset.GetRasterBand(i).WriteArray(image)
        dataset.GetRasterBand(i).SetNoDataValue(ndv)
        dataset.SetDescription(bandnames[i-1])
    dataset.FlushCache()
    return name</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="AGw4oZLuMtN3RNlsSB_cG" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="r4NpVKcilX" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">da</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="fnZvWmZ9HtVoAyHzxyA-u" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="zj9AWAHlTd" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># def timeseries_metrics(raster, ndv=np.nan):     
#     # Make us of numpy nan functions
#     # Check if type is a float array
#     if not raster.dtype.name.find(&#x27;float&#x27;)&gt;-1:
#         raster = raster.astype(np.float64)
#     # Set ndv to nan
#     if not np.isnan(ndv):
#         raster[np.equal(raster,ndv)] = np.nan
#     # Build dictionary of the metrics
#     tsmetrics={}
#     rperc = np.nanpercentile(raster,[5,50,95], axis=0)
#     tsmetrics[&#x27;mean&#x27;] = np.nanmean(raster, axis=0)
#     tsmetrics[&#x27;max&#x27;] = np.nanmax(raster, axis=0)
#     tsmetrics[&#x27;min&#x27;] = np.nanmin(raster, axis=0)
#     tsmetrics[&#x27;range&#x27;] = tsmetrics[&#x27;max&#x27;] - tsmetrics[&#x27;min&#x27;]
#     tsmetrics[&#x27;median&#x27;] = rperc[1]
#     tsmetrics[&#x27;p5&#x27;] = rperc[0]
#     tsmetrics[&#x27;p95&#x27;] = rperc[2]
#     tsmetrics[&#x27;prange&#x27;] = rperc[2]-rperc[0]
    # tsmetrics[&#x27;var&#x27;] = np.nanvar(raster, axis=0)
    # tsmetrics[&#x27;std&#x27;] = np.sqrt(tsmetrics[&#x27;var&#x27;])
    # tsmetrics[&#x27;CV&#x27;] = np.abs(tsmetrics[&#x27;var&#x27;] / tsmetrics[&#x27;mean&#x27;])
#     return tsmetrics</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="CroEyUrD-zwvtyjsG97sE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="jJkWYnPpra" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def timeseries_metrics(da):     
    q = da.quantile([0.05, 0.5, 0.95], dim=&quot;time&quot;)
    p05 = q.sel(quantile=0.05, drop=True)
    p50 = q.sel(quantile=0.50, drop=True)
    p95 = q.sel(quantile=0.95, drop=True)
    prange = p95 - p05
    
    max = da.max(dim=&quot;time&quot;)
    min = da.min(dim=&quot;time&quot;)
    range = max - min

    mean = da.mean(dim=&quot;time&quot;)
    var = da.var(dim=&quot;time&quot;)
    std = da.std(dim=&quot;time&quot;)
    cv = std / xr.where(mean != 0, mean, np.nan)
    
    return xr.Dataset(
        dict(
            min=min, max=max, range=range,
            mean=mean, var=var, std=std, CV=cv,
            p05=p05, p50=p50, p95=p95,
            prange=p95 - p05
        )
    )</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="YQ4h3ubmyv1ful2txM9yk" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="dPhot1wUgP" class="relative group/block"><h2 id="id-4-create-a-pandas-time-index-and-display-the-vrt-band-dates" class="relative group"><span class="heading-text">4. Create a Pandas Time Index and Display the VRT Band Dates</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-4-create-a-pandas-time-index-and-display-the-vrt-band-dates" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p><strong>Create an index of timedelta64 data with Pandas:</strong></p></div><div id="cZ67Yangpk" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># tindex = pd.DatetimeIndex(dates)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="aWnWE28yaR7e4zrteCg3e" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="cCuRMgcYPj" class="relative group/block"><p><strong>Print the bands and dates for all images in the virtual raster table (VRT):</strong></p></div><div id="dRNZyLVpOf" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># j = 1
# print(f&quot;Bands and dates for {raster_path}&quot;)
# for i in tindex:
#     print(&quot;{:4d} {}&quot;.format(j, i.date()), end=&#x27; &#x27;)
#     j += 1
#     if j%5 == 1:
#         print()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="uPHAng1_Khq7bFygT8tIL" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Pe2IaI8Uzd" class="relative group/block"><hr class="py-2 my-5 translate-y-2"/><h2 id="id-4-create-a-time-series-animation-to-get-an-idea-of-the-dynamics-at-the-site" class="relative group"><span class="heading-text">4. Create a Time Series Animation to get an Idea of the Dynamics at the Site</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-4-create-a-time-series-animation-to-get-an-idea-of-the-dynamics-at-the-site" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="id-4-1-load-time-series-stack" class="relative group"><span class="heading-text">4.1 Load Time Series Stack</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-4-1-load-time-series-stack" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Now we are ready to create a time series animation from the calibrated SAR data.</p><p><strong>First, create a raster from band 0 and a raster stack from all the images:</strong></p></div><div id="wrcQW2MOIB" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># img = gdal.Open(raster_path)
# band = img.GetRasterBand(1)
# raster0 = band.ReadAsArray()
# band_number = 0 # Needed for updates
# rasterstack = img.ReadAsArray()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="9FS2pK_m4g-UEmXFEpOWR" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="wNqEb2EUvM" class="relative group/block"><p><strong>Print the bands, pixels, and lines:</strong></p></div><div id="BEw2hbXLrt" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># print(f&quot;Number of  bands: {img.RasterCount}&quot;)
# print(f&quot;Number of pixels: {img.RasterXSize}&quot;)
# print(f&quot;Number of  lines: {img.RasterYSize}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="g13yjhpvBRm0eXOzcMCxI" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ib7W37gg9z" class="relative group/block"><h2 id="id-4-2-data-conversion-between-db-and-power-scales" class="relative group"><span class="heading-text">4.2 Data Conversion between dB and Power Scales</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-4-2-data-conversion-between-db-and-power-scales" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The data at hand are radiometrically terrain corrected images, which are often expressed as terrain flattened <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>γ</mi><mn>0</mn></msup></mrow><annotation encoding="application/x-tex">\gamma^0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span> backscattering coefficients. For forest and land cover monitoring applications <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>γ</mi><mn>0</mn></msup></mrow><annotation encoding="application/x-tex">\gamma^0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span> is the preferred metric.</p><p>To use a logarithmic scale instead of the natural power scale, <strong>you can set the following variable to True:</strong></p></div><div id="NiiVoFEKco" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># todB = True

# labeldB = &#x27;dB&#x27; if todB else &#x27;linear&#x27;

# def convert(raster, todB=todB):
#     if todB:
#         return 10 * np.ma.log10(raster)
#     else:
#         return raster</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="I1LVkrFclS_RviBEtqHjz" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="NvzlHsMEbf" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%%time
da_db = 10*np.log10(da)
da_db</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="US4zKt0i_iPQS05DDxnDx" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="dsIrnBHMmK" class="relative group/block"><h2 id="id-4-3-create-time-series-animation" class="relative group"><span class="heading-text">4.3 Create Time Series Animation</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-4-3-create-time-series-animation" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p><strong>Create and move into a directory in which to store our plots and animations:</strong></p></div><div id="HHohoTazAb" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># product_path = analysis_dir/f&#x27;plots_and_animations&#x27;

# if not product_path.exists():
#     print(f&#x27;{product_path} created&#x27;)
#     product_path.mkdir()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="OfhUkl6aCPHyt51tPq1gX" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="MfZQMvQ7Za" class="relative group/block"><p>Now we can <strong>create the information needed to animate our data:</strong></p></div><div id="ATqjIl5O4l" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%%time
from matplotlib import pyplot as plt
from matplotlib.animation import FuncAnimation
from matplotlib.animation import FFMpegWriter, PillowWriter

vmin, vmax = (da_db.quantile([0.05, 0.95], skipna=True).values.astype(float))

fig, ax = plt.subplots(figsize=(6, 6))
frame_0 = da_db.isel(time=0).values
im = ax.imshow(frame_0, vmin=vmin, vmax=vmax, origin=&quot;upper&quot;, cmap=&quot;grey&quot;)
cb = fig.colorbar(im, ax=ax, label=&quot;γ⁰ (dB)&quot;)
ax.set_title(np.datetime_as_string(da_db.time.values[0], unit=&#x27;s&#x27;))
ax.set_axis_off()

def animate(i):
    frame = da_db.isel(time=i).values
    im.set_data(frame)
    ax.set_title(np.datetime_as_string(da_db.time.values[i], unit=&#x27;s&#x27;))
    return (im,)

ani = FuncAnimation(fig, animate, frames=da_db.sizes[&quot;time&quot;], interval=300, blit=False)

plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5bafqlua1TKSIFWLl-7jN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/NISAR_GCOV_Cookbook/build/d022eab9578ec221e699aa3dc4ae40b0.png" alt="&lt;Figure size 600x600 with 2 Axes&gt;"/><div><pre class="text-sm font-thin font-system"><code><span>CPU times: user 25.2 s, sys: 3.47 s, total: 28.7 s
Wall time: 23.2 s
</span></code></pre></div></div></div><div id="dcQrtO3tAC" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from IPython.display import HTML

HTML(ani.to_jshtml())</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ABrTK9-hue5HMVVpri9Lo" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="J71xxoRNVE" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># %%capture 
# fig = plt.figure(figsize=(10, 5))
# ax = fig.subplots()
# ax.axis(&#x27;off&#x27;)

# copyRaster = np.copy(convert(rasterstack))
# vmin = np.nanpercentile(copyRaster, 1)
# vmax = np.nanpercentile(copyRaster, 99)

# im = ax.imshow(convert(raster0), cmap=&#x27;inferno&#x27;, vmin=vmin, vmax=vmax)
# cbar = fig.colorbar(im)
# cbar.set_label(labeldB)
# ax.set_title(&quot;{}&quot;.format(tindex[0].date()))
# plt.rcParams.update({&#x27;font.size&#x27;: 14})

# def animate(i):
#     ax.set_title(&quot;{}&quot;.format(tindex[i].date()))
#     im.set_data(convert(rasterstack[i]))

# # Interval is given in milliseconds
# ani = animation.FuncAnimation(fig, animate, frames=rasterstack.shape[0], interval=300)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="U-CdvE27aCOs4NDI3u1ob" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="YX01A25PhM" class="relative group/block"><p><strong>Configure matplotlib’s RC settings for the animation:</strong></p></div><div id="o4HaqNelly" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># rc(&#x27;animation&#x27;, embed_limit=40971520.0)  # We need to increase the limit maybe to show the entire animation</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="w0GNlj-nNq5D7v_tIjFY2" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="EXG0ZiENYi" class="relative group/block"><p><strong>Create a javascript animation of the time-series running inline in the notebook:</strong></p></div><div id="kwLq0eCvDR" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># HTML(ani.to_jshtml())</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="gdIVC6kjNnwIMVBpYWtCw" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="YuX8p1w4Er" class="relative group/block"><p><strong>Delete the dummy png that was saved to the current working directory while generating the javascript animation in the last code cell.</strong></p></div><div id="VaBKGceGRg" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># try:
#     Path(&#x27;/home/jovyan/notebooks/SAR_Training/English/Master/None0000000.png&#x27;).unlink()
# except FileNotFoundError:
#     pass</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="bBb7S7ojej5is7nIRTndx" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="xU4eOZpjyz" class="relative group/block"><p><strong>Save the animation (animation.gif):</strong></p></div><div id="erqh5ikihc" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">ani.save(plot_dir/f&#x27;animation.gif&#x27;, writer=&#x27;pillow&#x27;, fps=2)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="wsOj4RqYOO1DlgCGV-uVf" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="AT7npwmoHI" class="relative group/block"><hr class="py-2 my-5 translate-y-2"/><h2 id="id-5-computation-and-visualization-of-time-series-metrics" class="relative group"><span class="heading-text">5. Computation and Visualization of Time Series Metrics</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-5-computation-and-visualization-of-time-series-metrics" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Once a time-series was constructed, we can compute <strong>a set of metrics</strong> for each pixel in the stack:</p><ul><li><p>Mean</p></li><li><p>Median</p></li><li><p>Maximum</p></li><li><p>Minimum</p></li><li><p>Range (Maximum - Minimum)</p></li><li><p>5th Percentile</p></li><li><p>95th Percentile</p></li><li><p>PRange (95th - 5th Percentile)</p></li><li><p>Variance</p></li><li><p>Coefficient of Variation (Variance/Mean)</p></li></ul><hr class="py-2 my-5 translate-y-2"/><p>First, we <strong>mask out pixels</strong> that are zero (e.g. beyond the edge of the swath). Then we <strong>calculate the time series metrics:</strong></p></div><div id="UuOUdZwbDx" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># mask = (rasterstack == 0)
# raster = np.ma.array(convert(rasterstack), mask=mask, dtype=np.float64)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="eZ_Oy2BaELhUGMSyLE_Bf" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Tose8BFZSR" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"></code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="RVBw1UuAWcS1H-Lt1a9On" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="BavtH6zywX" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%%time
# calc metric in power
metrics = timeseries_metrics(da)
metrics.load()
metrics</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="4sCZewdsVEBLJ6iyp9Rer" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="kC7F81bOFm" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># metrics.keys()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="7tGKzVXKOutxw1NTmZNLE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Cn8WNH7ofI" class="relative group/block"><p>Let’s look at the histograms for the time series variance and coeficient of variation to aid displaying those images:</p></div><div id="cKtWQLOfBk" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># fig, ax = plt.subplots(1,2,figsize=(16,4))
# ax[0].hist(metrics[&#x27;var&#x27;].flatten(), bins=100, range=np.nanpercentile(metrics[&#x27;var&#x27;], [1,99]))
# ax[1].hist(metrics[&#x27;CV&#x27;].flatten(), bins=100, range=np.nanpercentile(metrics[&#x27;CV&#x27;], [1,99]))
# _ = ax[0].set_title(&#x27;Variance&#x27;)
# _ = ax[1].set_title(&#x27;Coefficient of Variation&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="mFrf_n_T_IlhZ_Hnu-q90" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="mdwTBcV8JK" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">np.min(cv)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="x4eb8IfTKD33nEbuOP0Dk" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="GowlXMUAnL" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">np.max(cv)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ljSuSmt60_1OW043aPXC4" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="y1Be7yhVai" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">len(cv)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="P1jzvfu-QP2u4eUWfcqkE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="LSHjmHR5QE" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from matplotlib import pyplot as plt

fig, ax = plt.subplots(1,2,figsize=(9, 3))

var = metrics[&quot;var&quot;].values.ravel()
ax[0].hist(var, bins=100, range=np.nanpercentile(var, [1,99]))
ax[0].set_title(&#x27;Variance&#x27;)

cv = metrics[&quot;CV&quot;].values.ravel()
ax[1].hist(cv, bins=100, range=np.nanpercentile(cv, [1,99]))
ax[1].set_title(&#x27;Coefficient of Variation&#x27;)

plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Xxd4Um4UUMG00ptfCAbr7" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system jupyter-error"><code><span style="color:rgb(187, 0, 0)">---------------------------------------------------------------------------</span><span>
</span><span style="color:rgb(187, 0, 0)">ValueError</span><span>                                Traceback (most recent call last)
</span><span style="color:rgb(0, 187, 187)">Cell</span><span style="color:rgb(0, 187, 187)"> </span><span style="color:rgb(0, 187, 0)">In[12]</span><span style="color:rgb(0, 187, 0)">, line 10</span><span>
</span><span style="color:rgb(0, 187, 0)">      7</span><span> ax[</span><span style="color:rgb(0, 187, 0)">0</span><span>].set_title(</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span style="color:rgb(187, 187, 0)">Variance</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span>)
</span><span style="color:rgb(0, 187, 0)">      9</span><span> cv = metrics[</span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">CV</span><span style="color:rgb(187, 187, 0)">&quot;</span><span>].values.ravel()
</span><span style="color:rgb(0, 187, 0)">---&gt; </span><span style="color:rgb(0, 187, 0)">10</span><span> </span><span style="background-color:rgb(187, 187, 0)">ax</span><span style="background-color:rgb(187, 187, 0)">[</span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 187, 0)">1</span><span style="background-color:rgb(187, 187, 0)">]</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">hist</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">cv</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">bins</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 187, 0)">100</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0)">range</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0)">np</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">nanpercentile</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">cv</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">[</span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 187, 0)">1</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 187, 0)">99</span><span style="background-color:rgb(187, 187, 0)">]</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">     11</span><span> ax[</span><span style="color:rgb(0, 187, 0)">1</span><span>].set_title(</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span style="color:rgb(187, 187, 0)">Coefficient of Variation</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span>)
</span><span style="color:rgb(0, 187, 0)">     13</span><span> plt.show()

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/_api/deprecation.py:453</span><span>, in </span><span style="color:rgb(0, 187, 187)">make_keyword_only.&lt;locals&gt;.wrapper</span><span style="color:rgb(0, 0, 187)">(*args, **kwargs)</span><span>
</span><span style="color:rgb(0, 187, 0)">    447</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">if</span><span> </span><span style="color:rgb(0, 135, 0)">len</span><span>(args) &gt; name_idx:
</span><span style="color:rgb(0, 187, 0)">    448</span><span>     warn_deprecated(
</span><span style="color:rgb(0, 187, 0)">    449</span><span>         since, message=</span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">Passing the </span><span style="color:rgb(175, 95, 135);font-weight:bold">%(name)s</span><span style="color:rgb(187, 187, 0)"> </span><span style="color:rgb(175, 95, 135);font-weight:bold">%(obj_type)s</span><span style="color:rgb(187, 187, 0)"> </span><span style="color:rgb(187, 187, 0)">&quot;</span><span>
</span><span style="color:rgb(0, 187, 0)">    450</span><span>         </span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">positionally is deprecated since Matplotlib </span><span style="color:rgb(175, 95, 135);font-weight:bold">%(since)s</span><span style="color:rgb(187, 187, 0)">; the </span><span style="color:rgb(187, 187, 0)">&quot;</span><span>
</span><span style="color:rgb(0, 187, 0)">    451</span><span>         </span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">parameter will become keyword-only in </span><span style="color:rgb(175, 95, 135);font-weight:bold">%(removal)s</span><span style="color:rgb(187, 187, 0)">.</span><span style="color:rgb(187, 187, 0)">&quot;</span><span>,
</span><span style="color:rgb(0, 187, 0)">    452</span><span>         name=name, obj_type=</span><span style="color:rgb(187, 187, 0)">f</span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">parameter of </span><span style="color:rgb(175, 95, 135);font-weight:bold">{</span><span>func.</span><span style="color:rgb(0, 0, 187)">__name__</span><span style="color:rgb(175, 95, 135);font-weight:bold">}</span><span style="color:rgb(187, 187, 0)">()</span><span style="color:rgb(187, 187, 0)">&quot;</span><span>)
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">453</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">return</span><span> </span><span style="background-color:rgb(187, 187, 0)">func</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">args</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">kwargs</span><span style="background-color:rgb(187, 187, 0)">)</span><span>

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/__init__.py:1524</span><span>, in </span><span style="color:rgb(0, 187, 187)">_preprocess_data.&lt;locals&gt;.inner</span><span style="color:rgb(0, 0, 187)">(ax, data, *args, **kwargs)</span><span>
</span><span style="color:rgb(0, 187, 0)">   1521</span><span> </span><span style="color:rgb(175, 0, 255)">@functools</span><span>.wraps(func)
</span><span style="color:rgb(0, 187, 0)">   1522</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">def</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 0, 187)">inner</span><span>(ax, *args, data=</span><span style="color:rgb(0, 135, 0);font-weight:bold">None</span><span>, **kwargs):
</span><span style="color:rgb(0, 187, 0)">   1523</span><span>     </span><span style="color:rgb(0, 135, 0);font-weight:bold">if</span><span> data </span><span style="color:rgb(175, 0, 255);font-weight:bold">is</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">None</span><span>:
</span><span style="color:rgb(0, 187, 0)">-&gt; </span><span style="color:rgb(0, 187, 0)">1524</span><span>         </span><span style="color:rgb(0, 135, 0);font-weight:bold">return</span><span> </span><span style="background-color:rgb(187, 187, 0)">func</span><span style="background-color:rgb(187, 187, 0)">(</span><span>
</span><span style="color:rgb(0, 187, 0)">   1525</span><span> </span><span style="background-color:rgb(187, 187, 0)">            </span><span style="background-color:rgb(187, 187, 0)">ax</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">   1526</span><span> </span><span style="background-color:rgb(187, 187, 0)">            </span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0)">map</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">cbook</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">sanitize_sequence</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">args</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">   1527</span><span> </span><span style="background-color:rgb(187, 187, 0)">            </span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">{</span><span style="background-color:rgb(187, 187, 0)">k</span><span style="background-color:rgb(187, 187, 0)">:</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">cbook</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">sanitize_sequence</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">v</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0);font-weight:bold">for</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">k</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">v</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0);color:rgb(175, 0, 255);font-weight:bold">in</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">kwargs</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">items</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)">}</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">   1529</span><span>     bound = new_sig.bind(ax, *args, **kwargs)
</span><span style="color:rgb(0, 187, 0)">   1530</span><span>     auto_label = (bound.arguments.get(label_namer)
</span><span style="color:rgb(0, 187, 0)">   1531</span><span>                   </span><span style="color:rgb(175, 0, 255);font-weight:bold">or</span><span> bound.kwargs.get(label_namer))

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/axes/_axes.py:7132</span><span>, in </span><span style="color:rgb(0, 187, 187)">Axes.hist</span><span style="color:rgb(0, 0, 187)">(self, x, bins, range, density, weights, cumulative, bottom, histtype, align, orientation, rwidth, log, color, label, stacked, **kwargs)</span><span>
</span><span style="color:rgb(0, 187, 0)">   7128</span><span> </span><span style="color:rgb(95, 135, 135);font-style:italic"># Loop through datasets</span><span>
</span><span style="color:rgb(0, 187, 0)">   7129</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">for</span><span> i </span><span style="color:rgb(175, 0, 255);font-weight:bold">in</span><span> </span><span style="color:rgb(0, 135, 0)">range</span><span>(nx):
</span><span style="color:rgb(0, 187, 0)">   7130</span><span>     </span><span style="color:rgb(95, 135, 135);font-style:italic"># this will automatically overwrite bins,</span><span>
</span><span style="color:rgb(0, 187, 0)">   7131</span><span>     </span><span style="color:rgb(95, 135, 135);font-style:italic"># so that each histogram uses the same bins</span><span>
</span><span style="color:rgb(0, 187, 0)">-&gt; </span><span style="color:rgb(0, 187, 0)">7132</span><span>     m, bins = </span><span style="background-color:rgb(187, 187, 0)">np</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">histogram</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">x</span><span style="background-color:rgb(187, 187, 0)">[</span><span style="background-color:rgb(187, 187, 0)">i</span><span style="background-color:rgb(187, 187, 0)">]</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">bins</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">weights</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0)">w</span><span style="background-color:rgb(187, 187, 0)">[</span><span style="background-color:rgb(187, 187, 0)">i</span><span style="background-color:rgb(187, 187, 0)">]</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">hist_kwargs</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">   7133</span><span>     tops.append(m)
</span><span style="color:rgb(0, 187, 0)">   7134</span><span> tops = np.array(tops, </span><span style="color:rgb(0, 135, 0)">float</span><span>)  </span><span style="color:rgb(95, 135, 135);font-style:italic"># causes problems later if it&#x27;s an int</span><span>

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/.local/envs/uwg_demo/lib/python3.13/site-packages/numpy/lib/_histograms_impl.py:792</span><span>, in </span><span style="color:rgb(0, 187, 187)">histogram</span><span style="color:rgb(0, 0, 187)">(a, bins, range, density, weights)</span><span>
</span><span style="color:rgb(0, 187, 0)">    687</span><span> </span><span style="color:rgb(187, 187, 0)">r</span><span style="color:rgb(187, 187, 0);font-style:italic">&quot;&quot;&quot;</span><span>
</span><span style="color:rgb(0, 187, 0)">    688</span><span> </span><span style="color:rgb(187, 187, 0);font-style:italic">Compute the histogram of a dataset.</span><span>
</span><span style="color:rgb(0, 187, 0)">    689</span><span> 
</span><span style="color:rgb(0, 187, 0)">   (...)</span><span style="color:rgb(0, 187, 0)">    788</span><span> 
</span><span style="color:rgb(0, 187, 0)">    789</span><span> </span><span style="color:rgb(187, 187, 0);font-style:italic">&quot;&quot;&quot;</span><span>
</span><span style="color:rgb(0, 187, 0)">    790</span><span> a, weights = _ravel_and_check_weights(a, weights)
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">792</span><span> bin_edges, uniform_bins = </span><span style="background-color:rgb(187, 187, 0)">_get_bin_edges</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">a</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">bins</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0)">range</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">weights</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">    794</span><span> </span><span style="color:rgb(95, 135, 135);font-style:italic"># Histogram is an integer or a float array depending on the weights.</span><span>
</span><span style="color:rgb(0, 187, 0)">    795</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">if</span><span> weights </span><span style="color:rgb(175, 0, 255);font-weight:bold">is</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">None</span><span>:

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/.local/envs/uwg_demo/lib/python3.13/site-packages/numpy/lib/_histograms_impl.py:449</span><span>, in </span><span style="color:rgb(0, 187, 187)">_get_bin_edges</span><span style="color:rgb(0, 0, 187)">(a, bins, range, weights)</span><span>
</span><span style="color:rgb(0, 187, 0)">    445</span><span>     bin_edges = np.linspace(
</span><span style="color:rgb(0, 187, 0)">    446</span><span>         first_edge, last_edge, n_equal_bins + </span><span style="color:rgb(0, 187, 0)">1</span><span>,
</span><span style="color:rgb(0, 187, 0)">    447</span><span>         endpoint=</span><span style="color:rgb(0, 135, 0);font-weight:bold">True</span><span>, dtype=bin_type)
</span><span style="color:rgb(0, 187, 0)">    448</span><span>     </span><span style="color:rgb(0, 135, 0);font-weight:bold">if</span><span> np.any(bin_edges[:-</span><span style="color:rgb(0, 187, 0)">1</span><span>] &gt;= bin_edges[</span><span style="color:rgb(0, 187, 0)">1</span><span>:]):
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">449</span><span>         </span><span style="color:rgb(0, 135, 0);font-weight:bold">raise</span><span> </span><span style="color:rgb(215, 95, 95);font-weight:bold">ValueError</span><span>(
</span><span style="color:rgb(0, 187, 0)">    450</span><span>             </span><span style="color:rgb(187, 187, 0)">f</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span style="color:rgb(187, 187, 0)">Too many bins for data range. Cannot create </span><span style="color:rgb(175, 95, 135);font-weight:bold">{</span><span>n_equal_bins</span><span style="color:rgb(175, 95, 135);font-weight:bold">}</span><span style="color:rgb(187, 187, 0)"> </span><span style="color:rgb(187, 187, 0)">&#x27;</span><span>
</span><span style="color:rgb(0, 187, 0)">    451</span><span>             </span><span style="color:rgb(187, 187, 0)">f</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span style="color:rgb(187, 187, 0)">finite-sized bins.</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span>)
</span><span style="color:rgb(0, 187, 0)">    452</span><span>     </span><span style="color:rgb(0, 135, 0);font-weight:bold">return</span><span> bin_edges, (first_edge, last_edge, n_equal_bins)
</span><span style="color:rgb(0, 187, 0)">    453</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">else</span><span>:

</span><span style="color:rgb(187, 0, 0)">ValueError</span><span>: Too many bins for data range. Cannot create 100 finite-sized bins.</span></code></pre></div><img src="/NISAR_GCOV_Cookbook/build/4df5c407fd0d935de67f4c07a4c89540.png" alt="&lt;Figure size 900x300 with 2 Axes&gt;"/></div></div><div id="nKXs83qqhW" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># # List the metrics keys you want to plot
# metric_keys=[&#x27;mean&#x27;, &#x27;median&#x27;, &#x27;max&#x27;, &#x27;min&#x27;, 
#              &#x27;p95&#x27;, &#x27;p5&#x27;, &#x27;prange&#x27;, &#x27;var&#x27;, &#x27;std&#x27;, &#x27;CV&#x27;]
# fig= plt.figure(figsize=(16,40))
# idx=1
# for i in metric_keys:
#     ax = fig.add_subplot(5,2,idx)
#     vmin, vmax = np.nanpercentile(metrics[i], [1, 99])
#     ax.imshow(metrics[i],vmin=vmin,vmax=vmax,cmap=&#x27;inferno&#x27;)
#     ax.set_title(i.upper())
#     ax.axis(&#x27;off&#x27;)
#     idx+=1</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="7WV0jVRy-mhuzcvKPkQNf" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="o58FEHyun8" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">metrics</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Z5WG6gZ2oyCfsRdN3xxTf" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="VzXDuV8q6t" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># List the metrics keys you want to plot
metric_keys=[&#x27;mean&#x27;, &#x27;p50&#x27;, &#x27;max&#x27;, &#x27;min&#x27;, 
             &#x27;p95&#x27;, &#x27;p05&#x27;, &#x27;prange&#x27;, &#x27;var&#x27;, &#x27;std&#x27;, &#x27;CV&#x27;]
fig= plt.figure(figsize=(16,40))
idx=1
for i in metric_keys:
    ax = fig.add_subplot(5,2,idx)
    vmin, vmax = np.nanpercentile(metrics[i], [1, 99])
    ax.imshow(metrics[i],vmin=vmin,vmax=vmax,cmap=&#x27;inferno&#x27;)
    ax.set_title(i.upper())
    ax.axis(&#x27;off&#x27;)
    idx+=1</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="0UsU1JnzThgXFJ_Pl-Qcf" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/NISAR_GCOV_Cookbook/build/cdf02963424843d5363c231615f85944.png" alt="&lt;Figure size 1600x4000 with 10 Axes&gt;"/></div></div><div id="TXaZEqFUgm" class="relative group/block"><p>You might have noticed white patches in the images above. These do not contain any data. The reason is that they are in the radar shadow of terrain that is closer to the satellite.</p><hr class="py-2 my-5 translate-y-2"/><h2 id="id-6-some-popular-sar-change-detection-methods" class="relative group"><span class="heading-text">6. Some Popular SAR Change Detection Methods</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-6-some-popular-sar-change-detection-methods" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>This section will introduce you to the following popular and simple change detection methods:</p><ul><li><p>Time series metrics  95<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> and 5<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> percentile difference and standard deviation thresholding</p></li><li><p>Time series coefficient of variation thresholding</p></li></ul><hr class="py-2 my-5 translate-y-2"/><h3 id="id-6-1-change-detection-with-the-percentile-difference-and-the-variance-threshold-method" class="relative group"><span class="heading-text">6.1 Change Detection with the Percentile Difference and the Variance Threshold Method</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-6-1-change-detection-with-the-percentile-difference-and-the-variance-threshold-method" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>In this method we find thresholds on the <strong>95<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> and 5<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> percentile difference</strong> or the <strong>temporal pixel-by-pixel gray value cariance</strong>. Let’s start with the 95<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> and 5<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> percentile difference. The advantage to look at percentiles verus maximum minus minimum is that it is more robust to outliers.</p><p>First, let us define a <strong>function for plotting histograms:</strong></p></div><div id="gA8a0UywK1" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def plot_histogram_cdf(metric=&#x27;std&#x27;):
    plt.rcParams.update({&#x27;font.size&#x27;: 12})
    fig = plt.figure(figsize=(14, 4)) # Initialize figure with a size
    ax1 = fig.add_subplot(121)  # 121 determines: 2 rows, 2 plots, first plot
    ax2 = fig.add_subplot(122)

    h = ax1.hist(
        metrics[metric].values.ravel(), range=np.nanpercentile(metrics[metric], [1, 99]))
    ax1.xaxis.set_label_text(f&#x27;{metric}&#x27;)
    ax1.set_title(&#x27;Histogram&#x27;)

    n, bins, patches = ax2.hist(
        metrics[metric].values.ravel(), range=np.nanpercentile(metrics[metric], [1, 99]),
        cumulative=&#x27;True&#x27;, density=&#x27;True&#x27;, histtype=&#x27;step&#x27;, label=&#x27;Empirical&#x27;)

    ax2.xaxis.set_label_text(f&#x27;{metric}&#x27;)
    ax2.set_title(&#x27;CDF&#x27;)

    outind = np.where(n &gt; 0.95)   
    threshind = np.min(outind)
    thresh = bins[threshind]
    ax1.axvline(thresh,color=&#x27;red&#x27;)
    _ = ax2.axvline(thresh,color=&#x27;red&#x27;)
    plt.savefig(plot_dir/f&#x27;{metric}_histogram.png&#x27;,
                dpi=200, transparent=&#x27;true&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="FxITjze0ssSZ9AuukY3vS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="kCfDTBA2Cn" class="relative group/block"><p><strong>Now let’s look at the 95th - 5th percentile range</strong></p></div><div id="RNIuqBZxxK" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">plot_histogram_cdf(metric=&#x27;prange&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="wOqnveVJ1_hWCE7HycKlg" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/NISAR_GCOV_Cookbook/build/8710e7d305ef2852661bcee12d4e5abc.png" alt="&lt;Figure size 1400x400 with 2 Axes&gt;"/></div></div><div id="diXS7F6eJd" class="relative group/block"><p>Let’s visualize the 5% of all pixels with the largest (95th - 5th percentile) difference in the time series. We will refer to the pixels (x,y) that exceed this threshold <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span> as likely <strong>change pixels (cp):</strong></p><p><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>c</mi><mi>p</mi></mrow><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow></msub><mo>=</mo><msubsup><mi>P</mi><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><mrow><mn>95</mn><mi>t</mi><mi>h</mi></mrow></msubsup><mo>−</mo><msubsup><mi>P</mi><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><mrow><mn>5</mn><mi>t</mi><mi>h</mi></mrow></msubsup><mo>&gt;</mo><mi>t</mi></mrow><annotation encoding="application/x-tex">{cp}_{x,y} = P_{x,y}^{95th} - P_{x,y}^{5th} &gt; t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8108em;vertical-align:-0.3802em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">c</span><span class="mord mathnormal">p</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0573em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3802em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2322em;vertical-align:-0.3831em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">95</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2322em;vertical-align:-0.3831em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span></p><p>If we define <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span> to correspond to the 5% of pixels with highest (95th - 5th percentile) difference, the image looks like:</p></div><div id="Cnmn2VvpXV" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def plot_threshold_classifier(metric=&#x27;prange&#x27;, percentage_cutoff=5):
    plt.figure(figsize=(8,8))
    thresh = np.nanpercentile(metrics[metric], 100 - percentage_cutoff)
    mask = metrics[metric] &lt; thresh # For display we prepare the inverse mask
    plt.imshow(mask, cmap=&#x27;gray&#x27;)
    _=plt.title(f&#x27;Threshold Classifier on {metric} &gt; %1.8f&#x27; % thresh)
    plt.savefig(plot_dir/f&#x27;changes_{metric}.png&#x27;,
            dpi=200, transparent=&#x27;true&#x27;)
    return np.logical_not(mask)

metric = &#x27;prange&#x27;
masks = {metric: plot_threshold_classifier(metric=metric)}</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="4v7X0gPRN6e8kkc7n3fAI" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/NISAR_GCOV_Cookbook/build/4121dcc6a28815f57f25f226e2ef3cc9.png" alt="&lt;Figure size 800x800 with 1 Axes&gt;"/></div></div><div id="rNmRG2tGH2" class="relative group/block"><p>Instead of applying a threshold on the 95th - 5th percentile difference data, we can also attempt to threshold other metrics. The <strong>standard deviation</strong> (or variance) variable seems a useful indicator for change as it identifies pixels for which radar brightness has changed strongly within the time series. Hence, in the following we use this metric for change identification according to:</p><p><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>c</mi><mi>p</mi></mrow><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow></msub><mo>=</mo><mi>σ</mi><mo>&gt;</mo><mi>t</mi></mrow><annotation encoding="application/x-tex">{cp}_{x,y} = \sigma &gt; t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8108em;vertical-align:-0.3802em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">c</span><span class="mord mathnormal">p</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0573em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3802em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span></p><p>with <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mi>C</mi><mi>D</mi><msub><mi>F</mi><mi>σ</mi></msub><mo>&gt;</mo><mn>0.95</mn></mrow><annotation encoding="application/x-tex">t=CDF_{\sigma} &gt; 0.95</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.95</span></span></span></span></span> (5% pixels with highest standard deviation):</p></div><div id="isRmoKen4H" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">plot_histogram_cdf(metric=&#x27;std&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="IUHnoc4EfYE1YOuMNaFGb" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/NISAR_GCOV_Cookbook/build/121597439082e37604a170032487480b.png" alt="&lt;Figure size 1400x400 with 2 Axes&gt;"/></div></div><div id="OAsg1uXzei" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">metric = &#x27;std&#x27;
masks[metric] = plot_threshold_classifier(metric=metric)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="JaRen8H8nbq2YT5vEnDf9" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/NISAR_GCOV_Cookbook/build/473070a9d286e08b40709d01950c7244.png" alt="&lt;Figure size 800x800 with 1 Axes&gt;"/></div></div><div id="e4eGyl5ZL9" class="relative group/block"><h3 id="id-6-2-change-detection-with-the-coefficient-of-variation-method" class="relative group"><span class="heading-text">6.2 Change Detection with the Coefficient of Variation Method</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-6-2-change-detection-with-the-coefficient-of-variation-method" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>We can also set a threshold <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span> for the <strong>coefficient of variation image</strong>
to classify change in the time series:</p><p><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>C</mi><mi>V</mi></mrow><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow></msub><mo>=</mo><mfrac><msub><mi>σ</mi><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow></msub><msub><mover accent="true"><mi>X</mi><mo stretchy="true">‾</mo></mover><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow></msub></mfrac><mo>&gt;</mo><mi>t</mi></mrow><annotation encoding="application/x-tex">{CV}_{x,y} = \frac{\sigma_{x,y}}{\overline{X}_{x,y}} &gt; t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.4659em;vertical-align:-0.6572em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8087em;"><span style="top:-2.5402em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord overline mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9283em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">X</span></span></span><span style="top:-3.8303em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line mtight" style="border-bottom-width:0.049em;"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.5073em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6572em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span></p><p>Let’s look at the histogram and the Cumulative Distribution Function (CDF) of the coefficient of variation:</p></div><div id="TgVGmsep3W" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">plot_histogram_cdf(metric=&#x27;CV&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="FIpOaQThrs50eGZDsMS4O" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system jupyter-error"><code><span style="color:rgb(187, 0, 0)">---------------------------------------------------------------------------</span><span>
</span><span style="color:rgb(187, 0, 0)">ValueError</span><span>                                Traceback (most recent call last)
</span><span style="color:rgb(0, 187, 187)">Cell</span><span style="color:rgb(0, 187, 187)"> </span><span style="color:rgb(0, 187, 0)">In[31]</span><span style="color:rgb(0, 187, 0)">, line 1</span><span>
</span><span style="color:rgb(0, 187, 0)">----&gt; </span><span style="color:rgb(0, 187, 0)">1</span><span> </span><span style="background-color:rgb(187, 187, 0)">plot_histogram_cdf</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">metric</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">&#x27;</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">CV</span><span style="background-color:rgb(187, 187, 0);color:rgb(187, 187, 0)">&#x27;</span><span style="background-color:rgb(187, 187, 0)">)</span><span>

</span><span style="color:rgb(0, 187, 187)">Cell</span><span style="color:rgb(0, 187, 187)"> </span><span style="color:rgb(0, 187, 0)">In[24]</span><span style="color:rgb(0, 187, 0)">, line 7</span><span>, in </span><span style="color:rgb(0, 187, 187)">plot_histogram_cdf</span><span style="color:rgb(0, 0, 187)">(metric)</span><span>
</span><span style="color:rgb(0, 187, 0)">      4</span><span> ax1 = fig.add_subplot(</span><span style="color:rgb(0, 187, 0)">121</span><span>)  </span><span style="color:rgb(95, 135, 135);font-style:italic"># 121 determines: 2 rows, 2 plots, first plot</span><span>
</span><span style="color:rgb(0, 187, 0)">      5</span><span> ax2 = fig.add_subplot(</span><span style="color:rgb(0, 187, 0)">122</span><span>)
</span><span style="color:rgb(0, 187, 0)">----&gt; </span><span style="color:rgb(0, 187, 0)">7</span><span> h = </span><span style="background-color:rgb(187, 187, 0)">ax1</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">hist</span><span style="background-color:rgb(187, 187, 0)">(</span><span>
</span><span style="color:rgb(0, 187, 0)">      8</span><span> </span><span style="background-color:rgb(187, 187, 0)">    </span><span style="background-color:rgb(187, 187, 0)">metrics</span><span style="background-color:rgb(187, 187, 0)">[</span><span style="background-color:rgb(187, 187, 0)">metric</span><span style="background-color:rgb(187, 187, 0)">]</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">values</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">ravel</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0)">range</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0)">np</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">nanpercentile</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">metrics</span><span style="background-color:rgb(187, 187, 0)">[</span><span style="background-color:rgb(187, 187, 0)">metric</span><span style="background-color:rgb(187, 187, 0)">]</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">[</span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 187, 0)">1</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 187, 0)">99</span><span style="background-color:rgb(187, 187, 0)">]</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">      9</span><span> ax1.xaxis.set_label_text(</span><span style="color:rgb(187, 187, 0)">f</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span style="color:rgb(175, 95, 135);font-weight:bold">{</span><span>metric</span><span style="color:rgb(175, 95, 135);font-weight:bold">}</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span>)
</span><span style="color:rgb(0, 187, 0)">     10</span><span> ax1.set_title(</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span style="color:rgb(187, 187, 0)">Histogram</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span>)

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/_api/deprecation.py:453</span><span>, in </span><span style="color:rgb(0, 187, 187)">make_keyword_only.&lt;locals&gt;.wrapper</span><span style="color:rgb(0, 0, 187)">(*args, **kwargs)</span><span>
</span><span style="color:rgb(0, 187, 0)">    447</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">if</span><span> </span><span style="color:rgb(0, 135, 0)">len</span><span>(args) &gt; name_idx:
</span><span style="color:rgb(0, 187, 0)">    448</span><span>     warn_deprecated(
</span><span style="color:rgb(0, 187, 0)">    449</span><span>         since, message=</span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">Passing the </span><span style="color:rgb(175, 95, 135);font-weight:bold">%(name)s</span><span style="color:rgb(187, 187, 0)"> </span><span style="color:rgb(175, 95, 135);font-weight:bold">%(obj_type)s</span><span style="color:rgb(187, 187, 0)"> </span><span style="color:rgb(187, 187, 0)">&quot;</span><span>
</span><span style="color:rgb(0, 187, 0)">    450</span><span>         </span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">positionally is deprecated since Matplotlib </span><span style="color:rgb(175, 95, 135);font-weight:bold">%(since)s</span><span style="color:rgb(187, 187, 0)">; the </span><span style="color:rgb(187, 187, 0)">&quot;</span><span>
</span><span style="color:rgb(0, 187, 0)">    451</span><span>         </span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">parameter will become keyword-only in </span><span style="color:rgb(175, 95, 135);font-weight:bold">%(removal)s</span><span style="color:rgb(187, 187, 0)">.</span><span style="color:rgb(187, 187, 0)">&quot;</span><span>,
</span><span style="color:rgb(0, 187, 0)">    452</span><span>         name=name, obj_type=</span><span style="color:rgb(187, 187, 0)">f</span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">parameter of </span><span style="color:rgb(175, 95, 135);font-weight:bold">{</span><span>func.</span><span style="color:rgb(0, 0, 187)">__name__</span><span style="color:rgb(175, 95, 135);font-weight:bold">}</span><span style="color:rgb(187, 187, 0)">()</span><span style="color:rgb(187, 187, 0)">&quot;</span><span>)
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">453</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">return</span><span> </span><span style="background-color:rgb(187, 187, 0)">func</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">args</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">kwargs</span><span style="background-color:rgb(187, 187, 0)">)</span><span>

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/__init__.py:1524</span><span>, in </span><span style="color:rgb(0, 187, 187)">_preprocess_data.&lt;locals&gt;.inner</span><span style="color:rgb(0, 0, 187)">(ax, data, *args, **kwargs)</span><span>
</span><span style="color:rgb(0, 187, 0)">   1521</span><span> </span><span style="color:rgb(175, 0, 255)">@functools</span><span>.wraps(func)
</span><span style="color:rgb(0, 187, 0)">   1522</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">def</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 0, 187)">inner</span><span>(ax, *args, data=</span><span style="color:rgb(0, 135, 0);font-weight:bold">None</span><span>, **kwargs):
</span><span style="color:rgb(0, 187, 0)">   1523</span><span>     </span><span style="color:rgb(0, 135, 0);font-weight:bold">if</span><span> data </span><span style="color:rgb(175, 0, 255);font-weight:bold">is</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">None</span><span>:
</span><span style="color:rgb(0, 187, 0)">-&gt; </span><span style="color:rgb(0, 187, 0)">1524</span><span>         </span><span style="color:rgb(0, 135, 0);font-weight:bold">return</span><span> </span><span style="background-color:rgb(187, 187, 0)">func</span><span style="background-color:rgb(187, 187, 0)">(</span><span>
</span><span style="color:rgb(0, 187, 0)">   1525</span><span> </span><span style="background-color:rgb(187, 187, 0)">            </span><span style="background-color:rgb(187, 187, 0)">ax</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">   1526</span><span> </span><span style="background-color:rgb(187, 187, 0)">            </span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0)">map</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">cbook</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">sanitize_sequence</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">args</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">   1527</span><span> </span><span style="background-color:rgb(187, 187, 0)">            </span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">{</span><span style="background-color:rgb(187, 187, 0)">k</span><span style="background-color:rgb(187, 187, 0)">:</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">cbook</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">sanitize_sequence</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">v</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0);font-weight:bold">for</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">k</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">v</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0);color:rgb(175, 0, 255);font-weight:bold">in</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">kwargs</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">items</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)">}</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">   1529</span><span>     bound = new_sig.bind(ax, *args, **kwargs)
</span><span style="color:rgb(0, 187, 0)">   1530</span><span>     auto_label = (bound.arguments.get(label_namer)
</span><span style="color:rgb(0, 187, 0)">   1531</span><span>                   </span><span style="color:rgb(175, 0, 255);font-weight:bold">or</span><span> bound.kwargs.get(label_namer))

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/axes/_axes.py:7132</span><span>, in </span><span style="color:rgb(0, 187, 187)">Axes.hist</span><span style="color:rgb(0, 0, 187)">(self, x, bins, range, density, weights, cumulative, bottom, histtype, align, orientation, rwidth, log, color, label, stacked, **kwargs)</span><span>
</span><span style="color:rgb(0, 187, 0)">   7128</span><span> </span><span style="color:rgb(95, 135, 135);font-style:italic"># Loop through datasets</span><span>
</span><span style="color:rgb(0, 187, 0)">   7129</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">for</span><span> i </span><span style="color:rgb(175, 0, 255);font-weight:bold">in</span><span> </span><span style="color:rgb(0, 135, 0)">range</span><span>(nx):
</span><span style="color:rgb(0, 187, 0)">   7130</span><span>     </span><span style="color:rgb(95, 135, 135);font-style:italic"># this will automatically overwrite bins,</span><span>
</span><span style="color:rgb(0, 187, 0)">   7131</span><span>     </span><span style="color:rgb(95, 135, 135);font-style:italic"># so that each histogram uses the same bins</span><span>
</span><span style="color:rgb(0, 187, 0)">-&gt; </span><span style="color:rgb(0, 187, 0)">7132</span><span>     m, bins = </span><span style="background-color:rgb(187, 187, 0)">np</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">histogram</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">x</span><span style="background-color:rgb(187, 187, 0)">[</span><span style="background-color:rgb(187, 187, 0)">i</span><span style="background-color:rgb(187, 187, 0)">]</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">bins</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">weights</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0)">w</span><span style="background-color:rgb(187, 187, 0)">[</span><span style="background-color:rgb(187, 187, 0)">i</span><span style="background-color:rgb(187, 187, 0)">]</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">hist_kwargs</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">   7133</span><span>     tops.append(m)
</span><span style="color:rgb(0, 187, 0)">   7134</span><span> tops = np.array(tops, </span><span style="color:rgb(0, 135, 0)">float</span><span>)  </span><span style="color:rgb(95, 135, 135);font-style:italic"># causes problems later if it&#x27;s an int</span><span>

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/.local/envs/uwg_demo/lib/python3.13/site-packages/numpy/lib/_histograms_impl.py:792</span><span>, in </span><span style="color:rgb(0, 187, 187)">histogram</span><span style="color:rgb(0, 0, 187)">(a, bins, range, density, weights)</span><span>
</span><span style="color:rgb(0, 187, 0)">    687</span><span> </span><span style="color:rgb(187, 187, 0)">r</span><span style="color:rgb(187, 187, 0);font-style:italic">&quot;&quot;&quot;</span><span>
</span><span style="color:rgb(0, 187, 0)">    688</span><span> </span><span style="color:rgb(187, 187, 0);font-style:italic">Compute the histogram of a dataset.</span><span>
</span><span style="color:rgb(0, 187, 0)">    689</span><span> 
</span><span style="color:rgb(0, 187, 0)">   (...)</span><span style="color:rgb(0, 187, 0)">    788</span><span> 
</span><span style="color:rgb(0, 187, 0)">    789</span><span> </span><span style="color:rgb(187, 187, 0);font-style:italic">&quot;&quot;&quot;</span><span>
</span><span style="color:rgb(0, 187, 0)">    790</span><span> a, weights = _ravel_and_check_weights(a, weights)
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">792</span><span> bin_edges, uniform_bins = </span><span style="background-color:rgb(187, 187, 0)">_get_bin_edges</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">a</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">bins</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0)">range</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">weights</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">    794</span><span> </span><span style="color:rgb(95, 135, 135);font-style:italic"># Histogram is an integer or a float array depending on the weights.</span><span>
</span><span style="color:rgb(0, 187, 0)">    795</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">if</span><span> weights </span><span style="color:rgb(175, 0, 255);font-weight:bold">is</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">None</span><span>:

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/.local/envs/uwg_demo/lib/python3.13/site-packages/numpy/lib/_histograms_impl.py:449</span><span>, in </span><span style="color:rgb(0, 187, 187)">_get_bin_edges</span><span style="color:rgb(0, 0, 187)">(a, bins, range, weights)</span><span>
</span><span style="color:rgb(0, 187, 0)">    445</span><span>     bin_edges = np.linspace(
</span><span style="color:rgb(0, 187, 0)">    446</span><span>         first_edge, last_edge, n_equal_bins + </span><span style="color:rgb(0, 187, 0)">1</span><span>,
</span><span style="color:rgb(0, 187, 0)">    447</span><span>         endpoint=</span><span style="color:rgb(0, 135, 0);font-weight:bold">True</span><span>, dtype=bin_type)
</span><span style="color:rgb(0, 187, 0)">    448</span><span>     </span><span style="color:rgb(0, 135, 0);font-weight:bold">if</span><span> np.any(bin_edges[:-</span><span style="color:rgb(0, 187, 0)">1</span><span>] &gt;= bin_edges[</span><span style="color:rgb(0, 187, 0)">1</span><span>:]):
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">449</span><span>         </span><span style="color:rgb(0, 135, 0);font-weight:bold">raise</span><span> </span><span style="color:rgb(215, 95, 95);font-weight:bold">ValueError</span><span>(
</span><span style="color:rgb(0, 187, 0)">    450</span><span>             </span><span style="color:rgb(187, 187, 0)">f</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span style="color:rgb(187, 187, 0)">Too many bins for data range. Cannot create </span><span style="color:rgb(175, 95, 135);font-weight:bold">{</span><span>n_equal_bins</span><span style="color:rgb(175, 95, 135);font-weight:bold">}</span><span style="color:rgb(187, 187, 0)"> </span><span style="color:rgb(187, 187, 0)">&#x27;</span><span>
</span><span style="color:rgb(0, 187, 0)">    451</span><span>             </span><span style="color:rgb(187, 187, 0)">f</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span style="color:rgb(187, 187, 0)">finite-sized bins.</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span>)
</span><span style="color:rgb(0, 187, 0)">    452</span><span>     </span><span style="color:rgb(0, 135, 0);font-weight:bold">return</span><span> bin_edges, (first_edge, last_edge, n_equal_bins)
</span><span style="color:rgb(0, 187, 0)">    453</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">else</span><span>:

</span><span style="color:rgb(187, 0, 0)">ValueError</span><span>: Too many bins for data range. Cannot create 10 finite-sized bins.</span></code></pre></div><img src="/NISAR_GCOV_Cookbook/build/f4b04bbcde8a212dbc2cd49756eeee1c.png" alt="&lt;Figure size 1400x400 with 2 Axes&gt;"/></div></div><div id="CUraTLXZKw" class="relative group/block"><p>With a threshold of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mi>C</mi><mi>D</mi><msub><mi>F</mi><mrow><mi>C</mi><mi>V</mi></mrow></msub><mo>&gt;</mo><mn>0.95</mn></mrow><annotation encoding="application/x-tex">t=CDF_{CV} &gt; 0.95</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.95</span></span></span></span></span> (5% pixels with highest variance) the change pixels would look like the following image:</p></div><div id="ALqbMKodRK" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">metric = &#x27;CV&#x27;
masks[metric] = plot_threshold_classifier(metric=metric)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="QYs5zoNqKmBEjkFArBM4o" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/NISAR_GCOV_Cookbook/build/cbca4bf5566363a3beff8fda9ee98427.png" alt="&lt;Figure size 800x800 with 1 Axes&gt;"/></div></div><div id="WGrsjeMdWR" class="relative group/block"><h3 id="id-6-3-pair-wise-change-detection" class="relative group"><span class="heading-text">6.3 Pair-wise change detection</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-6-3-pair-wise-change-detection" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>To analyze temporal changes between two images, it is useful to compute metrics that are sensitive to discrepancies between the two images. In radar remote sensing, the standard way is to look at ratios (in the linearly scaled power domain) or, equivalently, at differences in the logarithmic dB domain.</p></div><div id="GXMs4I5qfy" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># dates = (&#x27;2018-05-27&#x27;, &#x27;2018-06-08&#x27;) # around first eruption

# # convert to datetime objects
# dates_ = [datetime.datetime.strptime(date, &#x27;%Y-%m-%d&#x27;) for date in dates]

# # get the indices in one line
# dates_ind = [np.argmin(np.abs(date - tindex)) for date in dates_]
# print(f&#x27;Comparing image {dates_ind[0]} from {tindex[dates_ind[0]].date()} with {dates_ind[1]} from {tindex[dates_ind[1]].date()}&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="1PobY0dvvI9E-1-51N6d2" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="qoc1U2CW6U" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">dates = (&#x27;2025-11-03&#x27;, &#x27;2025-11-07&#x27;) # around first eruption

# convert to datetime objects
dates_ = [datetime.datetime.strptime(date, &#x27;%Y-%m-%d&#x27;) for date in dates]

# get the indices in one line
dates_ind = [np.argmin(np.abs(date - tindex)) for date in dates_]
print(f&#x27;Comparing image {dates_ind[0]} from {tindex[dates_ind[0]].date()} with {dates_ind[1]} from {tindex[dates_ind[1]].date()}&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="gFhk93N9iyRY91dzase9C" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="vpMJ6Yk1UY" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">da.time</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="C5_gMtq6oz4efN0k-U7CR" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="Wt88xAKzgN" class="relative group/block"><p><strong>Compute the log ratio in dB</strong>, corresponding to the difference in dB</p></div><div id="r8CMUfAkIk" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># ratiodB = 10 * np.ma.log10(np.ma.divide(rasterstack[dates_ind[1], ...], rasterstack[dates_ind[0], ...]))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="lqNyWdT3w7DZIA12y74aZ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="DFA8yiBS3Z" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">date_0 = da.sel(time=&quot;2025-11-03&quot;).squeeze(&quot;time&quot;, drop=True)
date_1 = da.sel(time=&quot;2025-11-07&quot;).squeeze(&quot;time&quot;, drop=True)

ratiodB = 10 * np.log10(date_1 / date_0)
ratiodB</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5EiUkOkzWDmYuNBeFIx0H" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="cXWVvTfg1J" class="relative group/block"><p><strong>Let us manually choose a threshold this time</strong></p><p>thresh is the threshold, e.g. -2 dB</p><p>thresh_type determines whether we mask everything below that (lower) or above (upper)</p></div><div id="OYgNUROIlW" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># thresh = -2
# thresh_type = &#x27;lower&#x27; #&#x27;lower&#x27;: mask everything below thresh, &#x27;upper&#x27;: mask everything above

# copy_absRatiod = np.copy(np.abs(ratiodB))
# # dynamic_range = np.nanpercentile(np.abs(ratiodB), 99)
# dynamic_range = np.nanpercentile(copy_absRatiod, 99)
# fig, axs = plt.subplots(ncols=3, nrows=1)
# fig.set_size_inches(20, 4)
# plt.subplots_adjust(hspace=0.4, right=0.85)

# # h = axs[0].hist(
# #         ratiodB.flatten(), bins=200, range=np.nanpercentile(ratiodB, [0.1, 99.9]))

# h = axs[0].hist(
#         ratiodB.flatten(), bins=200, range=np.nanpercentile(np.copy(ratiodB), [0.1, 99.9]))

# axs[0].xaxis.set_label_text(f&#x27;difference [dB]&#x27;)
# axs[0].set_title(&#x27;Histogram&#x27;)
# im0 = axs[1].imshow(ratiodB, cmap=&#x27;RdBu&#x27;, vmin=-dynamic_range, vmax=dynamic_range)
# cbar = fig.colorbar(im0, orientation=&#x27;vertical&#x27;, ax=axs.ravel().tolist(), shrink=0.7)
# cbar.set_label(&#x27;[dB]&#x27;)
# axs[1].set_title(&#x27;Image&#x27;)
# mask = (ratiodB &gt; thresh if thresh_type == &#x27;lower&#x27; else ratiodB &lt; thresh).astype(np.int8)
# axs[2].imshow(mask, cmap=&#x27;gray&#x27;)
# axs[2].set_title(&#x27;Mask&#x27;)
# fig.suptitle(f&#x27;{tindex[dates_ind[0]].date()} {tindex[dates_ind[0]].date()}&#x27;)
# logratiolabel = f&#x27;logratio_{tindex[dates_ind[0]].date()}_{tindex[dates_ind[0]].date()}&#x27;
# plt.savefig(product_path/f&#x27;{logratiolabel}.png&#x27;,
#             dpi=200, transparent=&#x27;true&#x27;)
# masks[logratiolabel] = np.logical_not(mask)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="VEDpjXx1wIKF2AAiGuS2o" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="VsWC8em4Em" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># np.nanpercentile(np.copy(ratiodB), [0.1, 99.9])
low, high = (ratiodB.quantile([0.01, 0.99]))
low.compute().item()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="XNJ2M-zR93dlzQFzLS9Am" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>-2.417687692831179</span></code></div></div></div><div id="E0UOJQIqA1" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">high.compute().item()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="xOtOCLMcY_N4sF8V-4c2c" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>-2.417687692831178</span></code></div></div></div><div id="PLSFFyJ7Hu" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">thresh = -2
a = ratiodB &lt; thresh
a.max().compute().item()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="m3Q_JygmUut1yF4SUtDkk" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>True</span></code></div></div></div><div id="kLbZ9EAYhD" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">thresh = -2
thresh_type = &#x27;lower&#x27; #&#x27;lower&#x27;: mask everything below thresh, &#x27;upper&#x27;: mask everything above

abs_ratiodB = np.abs(ratiodB)
dynamic_range = abs_ratiodB.quantile(0.99, skipna=True).compute().item()


fig, axs = plt.subplots(ncols=3, nrows=1)
fig.set_size_inches(20, 4)
plt.subplots_adjust(hspace=0.4, right=0.85)

# h = axs[0].hist(
#         ratiodB.flatten(), bins=200, range=np.nanpercentile(ratiodB, [0.1, 99.9]))

axs[0].hist(
        ratiodB.values.ravel(), bins=10, range=np.nanpercentile(ratiodB, [0.1, 99.9]))

axs[0].xaxis.set_label_text(f&#x27;difference [dB]&#x27;)
axs[0].set_title(&#x27;Histogram&#x27;)

im0 = axs[1].imshow(ratiodB, cmap=&#x27;RdBu&#x27;, vmin=-dynamic_range, vmax=dynamic_range)
cbar = fig.colorbar(im0, orientation=&#x27;vertical&#x27;, ax=axs.ravel().tolist(), shrink=0.7)
cbar.set_label(&#x27;[dB]&#x27;)
axs[1].set_title(&#x27;Image&#x27;)

mask = (ratiodB &gt; thresh if thresh_type == &#x27;lower&#x27; else ratiodB &lt; thresh).astype(np.int8)

axs[2].imshow(mask, cmap=&#x27;gray&#x27;)
axs[2].set_title(&#x27;Mask&#x27;)
fig.suptitle(f&#x27;{tindex[dates_ind[0]].date()} {tindex[dates_ind[0]].date()}&#x27;)
logratiolabel = f&#x27;logratio_{tindex[dates_ind[0]].date()}_{tindex[dates_ind[0]].date()}&#x27;
plt.savefig(product_path/f&#x27;{logratiolabel}.png&#x27;,
            dpi=200, transparent=&#x27;true&#x27;)
masks[logratiolabel] = np.logical_not(mask)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="gYtS0XHqOa66xdpPkrrTy" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system jupyter-error"><code><span style="color:rgb(187, 0, 0)">---------------------------------------------------------------------------</span><span>
</span><span style="color:rgb(187, 0, 0)">ValueError</span><span>                                Traceback (most recent call last)
</span><span style="color:rgb(0, 187, 187)">Cell</span><span style="color:rgb(0, 187, 187)"> </span><span style="color:rgb(0, 187, 0)">In[101]</span><span style="color:rgb(0, 187, 0)">, line 15</span><span>
</span><span style="color:rgb(0, 187, 0)">     10</span><span> plt.subplots_adjust(hspace=</span><span style="color:rgb(0, 187, 0)">0.4</span><span>, right=</span><span style="color:rgb(0, 187, 0)">0.85</span><span>)
</span><span style="color:rgb(0, 187, 0)">     12</span><span> </span><span style="color:rgb(95, 135, 135);font-style:italic"># h = axs[0].hist(</span><span>
</span><span style="color:rgb(0, 187, 0)">     13</span><span> </span><span style="color:rgb(95, 135, 135);font-style:italic">#         ratiodB.flatten(), bins=200, range=np.nanpercentile(ratiodB, [0.1, 99.9]))</span><span>
</span><span style="color:rgb(0, 187, 0)">---&gt; </span><span style="color:rgb(0, 187, 0)">15</span><span> </span><span style="background-color:rgb(187, 187, 0)">axs</span><span style="background-color:rgb(187, 187, 0)">[</span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 187, 0)">0</span><span style="background-color:rgb(187, 187, 0)">]</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">hist</span><span style="background-color:rgb(187, 187, 0)">(</span><span>
</span><span style="color:rgb(0, 187, 0)">     16</span><span> </span><span style="background-color:rgb(187, 187, 0)">        </span><span style="background-color:rgb(187, 187, 0)">ratiodB</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">values</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">ravel</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">bins</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 187, 0)">10</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0)">range</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0)">np</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">nanpercentile</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">ratiodB</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">[</span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 187, 0)">0.1</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 187, 0)">99.9</span><span style="background-color:rgb(187, 187, 0)">]</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">     18</span><span> axs[</span><span style="color:rgb(0, 187, 0)">0</span><span>].xaxis.set_label_text(</span><span style="color:rgb(187, 187, 0)">f</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span style="color:rgb(187, 187, 0)">difference [dB]</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span>)
</span><span style="color:rgb(0, 187, 0)">     19</span><span> axs[</span><span style="color:rgb(0, 187, 0)">0</span><span>].set_title(</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span style="color:rgb(187, 187, 0)">Histogram</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span>)

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/_api/deprecation.py:453</span><span>, in </span><span style="color:rgb(0, 187, 187)">make_keyword_only.&lt;locals&gt;.wrapper</span><span style="color:rgb(0, 0, 187)">(*args, **kwargs)</span><span>
</span><span style="color:rgb(0, 187, 0)">    447</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">if</span><span> </span><span style="color:rgb(0, 135, 0)">len</span><span>(args) &gt; name_idx:
</span><span style="color:rgb(0, 187, 0)">    448</span><span>     warn_deprecated(
</span><span style="color:rgb(0, 187, 0)">    449</span><span>         since, message=</span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">Passing the </span><span style="color:rgb(175, 95, 135);font-weight:bold">%(name)s</span><span style="color:rgb(187, 187, 0)"> </span><span style="color:rgb(175, 95, 135);font-weight:bold">%(obj_type)s</span><span style="color:rgb(187, 187, 0)"> </span><span style="color:rgb(187, 187, 0)">&quot;</span><span>
</span><span style="color:rgb(0, 187, 0)">    450</span><span>         </span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">positionally is deprecated since Matplotlib </span><span style="color:rgb(175, 95, 135);font-weight:bold">%(since)s</span><span style="color:rgb(187, 187, 0)">; the </span><span style="color:rgb(187, 187, 0)">&quot;</span><span>
</span><span style="color:rgb(0, 187, 0)">    451</span><span>         </span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">parameter will become keyword-only in </span><span style="color:rgb(175, 95, 135);font-weight:bold">%(removal)s</span><span style="color:rgb(187, 187, 0)">.</span><span style="color:rgb(187, 187, 0)">&quot;</span><span>,
</span><span style="color:rgb(0, 187, 0)">    452</span><span>         name=name, obj_type=</span><span style="color:rgb(187, 187, 0)">f</span><span style="color:rgb(187, 187, 0)">&quot;</span><span style="color:rgb(187, 187, 0)">parameter of </span><span style="color:rgb(175, 95, 135);font-weight:bold">{</span><span>func.</span><span style="color:rgb(0, 0, 187)">__name__</span><span style="color:rgb(175, 95, 135);font-weight:bold">}</span><span style="color:rgb(187, 187, 0)">()</span><span style="color:rgb(187, 187, 0)">&quot;</span><span>)
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">453</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">return</span><span> </span><span style="background-color:rgb(187, 187, 0)">func</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">args</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">kwargs</span><span style="background-color:rgb(187, 187, 0)">)</span><span>

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/__init__.py:1524</span><span>, in </span><span style="color:rgb(0, 187, 187)">_preprocess_data.&lt;locals&gt;.inner</span><span style="color:rgb(0, 0, 187)">(ax, data, *args, **kwargs)</span><span>
</span><span style="color:rgb(0, 187, 0)">   1521</span><span> </span><span style="color:rgb(175, 0, 255)">@functools</span><span>.wraps(func)
</span><span style="color:rgb(0, 187, 0)">   1522</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">def</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 0, 187)">inner</span><span>(ax, *args, data=</span><span style="color:rgb(0, 135, 0);font-weight:bold">None</span><span>, **kwargs):
</span><span style="color:rgb(0, 187, 0)">   1523</span><span>     </span><span style="color:rgb(0, 135, 0);font-weight:bold">if</span><span> data </span><span style="color:rgb(175, 0, 255);font-weight:bold">is</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">None</span><span>:
</span><span style="color:rgb(0, 187, 0)">-&gt; </span><span style="color:rgb(0, 187, 0)">1524</span><span>         </span><span style="color:rgb(0, 135, 0);font-weight:bold">return</span><span> </span><span style="background-color:rgb(187, 187, 0)">func</span><span style="background-color:rgb(187, 187, 0)">(</span><span>
</span><span style="color:rgb(0, 187, 0)">   1525</span><span> </span><span style="background-color:rgb(187, 187, 0)">            </span><span style="background-color:rgb(187, 187, 0)">ax</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">   1526</span><span> </span><span style="background-color:rgb(187, 187, 0)">            </span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0)">map</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">cbook</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">sanitize_sequence</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">args</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)">,</span><span>
</span><span style="color:rgb(0, 187, 0)">   1527</span><span> </span><span style="background-color:rgb(187, 187, 0)">            </span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">{</span><span style="background-color:rgb(187, 187, 0)">k</span><span style="background-color:rgb(187, 187, 0)">:</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">cbook</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">sanitize_sequence</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">v</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0);font-weight:bold">for</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">k</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">v</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0);color:rgb(175, 0, 255);font-weight:bold">in</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">kwargs</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">items</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">)</span><span style="background-color:rgb(187, 187, 0)">}</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">   1529</span><span>     bound = new_sig.bind(ax, *args, **kwargs)
</span><span style="color:rgb(0, 187, 0)">   1530</span><span>     auto_label = (bound.arguments.get(label_namer)
</span><span style="color:rgb(0, 187, 0)">   1531</span><span>                   </span><span style="color:rgb(175, 0, 255);font-weight:bold">or</span><span> bound.kwargs.get(label_namer))

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/axes/_axes.py:7132</span><span>, in </span><span style="color:rgb(0, 187, 187)">Axes.hist</span><span style="color:rgb(0, 0, 187)">(self, x, bins, range, density, weights, cumulative, bottom, histtype, align, orientation, rwidth, log, color, label, stacked, **kwargs)</span><span>
</span><span style="color:rgb(0, 187, 0)">   7128</span><span> </span><span style="color:rgb(95, 135, 135);font-style:italic"># Loop through datasets</span><span>
</span><span style="color:rgb(0, 187, 0)">   7129</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">for</span><span> i </span><span style="color:rgb(175, 0, 255);font-weight:bold">in</span><span> </span><span style="color:rgb(0, 135, 0)">range</span><span>(nx):
</span><span style="color:rgb(0, 187, 0)">   7130</span><span>     </span><span style="color:rgb(95, 135, 135);font-style:italic"># this will automatically overwrite bins,</span><span>
</span><span style="color:rgb(0, 187, 0)">   7131</span><span>     </span><span style="color:rgb(95, 135, 135);font-style:italic"># so that each histogram uses the same bins</span><span>
</span><span style="color:rgb(0, 187, 0)">-&gt; </span><span style="color:rgb(0, 187, 0)">7132</span><span>     m, bins = </span><span style="background-color:rgb(187, 187, 0)">np</span><span style="background-color:rgb(187, 187, 0)">.</span><span style="background-color:rgb(187, 187, 0)">histogram</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">x</span><span style="background-color:rgb(187, 187, 0)">[</span><span style="background-color:rgb(187, 187, 0)">i</span><span style="background-color:rgb(187, 187, 0)">]</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">bins</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">weights</span><span style="background-color:rgb(187, 187, 0)">=</span><span style="background-color:rgb(187, 187, 0)">w</span><span style="background-color:rgb(187, 187, 0)">[</span><span style="background-color:rgb(187, 187, 0)">i</span><span style="background-color:rgb(187, 187, 0)">]</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">*</span><span style="background-color:rgb(187, 187, 0)">hist_kwargs</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">   7133</span><span>     tops.append(m)
</span><span style="color:rgb(0, 187, 0)">   7134</span><span> tops = np.array(tops, </span><span style="color:rgb(0, 135, 0)">float</span><span>)  </span><span style="color:rgb(95, 135, 135);font-style:italic"># causes problems later if it&#x27;s an int</span><span>

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/.local/envs/uwg_demo/lib/python3.13/site-packages/numpy/lib/_histograms_impl.py:792</span><span>, in </span><span style="color:rgb(0, 187, 187)">histogram</span><span style="color:rgb(0, 0, 187)">(a, bins, range, density, weights)</span><span>
</span><span style="color:rgb(0, 187, 0)">    687</span><span> </span><span style="color:rgb(187, 187, 0)">r</span><span style="color:rgb(187, 187, 0);font-style:italic">&quot;&quot;&quot;</span><span>
</span><span style="color:rgb(0, 187, 0)">    688</span><span> </span><span style="color:rgb(187, 187, 0);font-style:italic">Compute the histogram of a dataset.</span><span>
</span><span style="color:rgb(0, 187, 0)">    689</span><span> 
</span><span style="color:rgb(0, 187, 0)">   (...)</span><span style="color:rgb(0, 187, 0)">    788</span><span> 
</span><span style="color:rgb(0, 187, 0)">    789</span><span> </span><span style="color:rgb(187, 187, 0);font-style:italic">&quot;&quot;&quot;</span><span>
</span><span style="color:rgb(0, 187, 0)">    790</span><span> a, weights = _ravel_and_check_weights(a, weights)
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">792</span><span> bin_edges, uniform_bins = </span><span style="background-color:rgb(187, 187, 0)">_get_bin_edges</span><span style="background-color:rgb(187, 187, 0)">(</span><span style="background-color:rgb(187, 187, 0)">a</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">bins</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0);color:rgb(0, 135, 0)">range</span><span style="background-color:rgb(187, 187, 0)">,</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">weights</span><span style="background-color:rgb(187, 187, 0)">)</span><span>
</span><span style="color:rgb(0, 187, 0)">    794</span><span> </span><span style="color:rgb(95, 135, 135);font-style:italic"># Histogram is an integer or a float array depending on the weights.</span><span>
</span><span style="color:rgb(0, 187, 0)">    795</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">if</span><span> weights </span><span style="color:rgb(175, 0, 255);font-weight:bold">is</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">None</span><span>:

</span><span style="color:rgb(0, 187, 187)">File </span><span style="color:rgb(0, 187, 0)">~/.local/envs/uwg_demo/lib/python3.13/site-packages/numpy/lib/_histograms_impl.py:449</span><span>, in </span><span style="color:rgb(0, 187, 187)">_get_bin_edges</span><span style="color:rgb(0, 0, 187)">(a, bins, range, weights)</span><span>
</span><span style="color:rgb(0, 187, 0)">    445</span><span>     bin_edges = np.linspace(
</span><span style="color:rgb(0, 187, 0)">    446</span><span>         first_edge, last_edge, n_equal_bins + </span><span style="color:rgb(0, 187, 0)">1</span><span>,
</span><span style="color:rgb(0, 187, 0)">    447</span><span>         endpoint=</span><span style="color:rgb(0, 135, 0);font-weight:bold">True</span><span>, dtype=bin_type)
</span><span style="color:rgb(0, 187, 0)">    448</span><span>     </span><span style="color:rgb(0, 135, 0);font-weight:bold">if</span><span> np.any(bin_edges[:-</span><span style="color:rgb(0, 187, 0)">1</span><span>] &gt;= bin_edges[</span><span style="color:rgb(0, 187, 0)">1</span><span>:]):
</span><span style="color:rgb(0, 187, 0)">--&gt; </span><span style="color:rgb(0, 187, 0)">449</span><span>         </span><span style="color:rgb(0, 135, 0);font-weight:bold">raise</span><span> </span><span style="color:rgb(215, 95, 95);font-weight:bold">ValueError</span><span>(
</span><span style="color:rgb(0, 187, 0)">    450</span><span>             </span><span style="color:rgb(187, 187, 0)">f</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span style="color:rgb(187, 187, 0)">Too many bins for data range. Cannot create </span><span style="color:rgb(175, 95, 135);font-weight:bold">{</span><span>n_equal_bins</span><span style="color:rgb(175, 95, 135);font-weight:bold">}</span><span style="color:rgb(187, 187, 0)"> </span><span style="color:rgb(187, 187, 0)">&#x27;</span><span>
</span><span style="color:rgb(0, 187, 0)">    451</span><span>             </span><span style="color:rgb(187, 187, 0)">f</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span style="color:rgb(187, 187, 0)">finite-sized bins.</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span>)
</span><span style="color:rgb(0, 187, 0)">    452</span><span>     </span><span style="color:rgb(0, 135, 0);font-weight:bold">return</span><span> bin_edges, (first_edge, last_edge, n_equal_bins)
</span><span style="color:rgb(0, 187, 0)">    453</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">else</span><span>:

</span><span style="color:rgb(187, 0, 0)">ValueError</span><span>: Too many bins for data range. Cannot create 10 finite-sized bins.</span></code></pre></div><img src="/NISAR_GCOV_Cookbook/build/a5c94d99e1bb5465aeabd1ead728728d.png" alt="&lt;Figure size 2000x400 with 3 Axes&gt;"/></div></div><div id="wM6M6XLOOW" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"></code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="BuZa73OJh9LZeH9GHvUI8" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="EK5V2ylM9B" class="relative group/block"><p><strong>Do you think the threshold is appropriate? If not, try adjusting it.</strong></p></div><div id="r5VqKcJYVv" class="relative group/block"><hr class="py-2 my-5 translate-y-2"/><h2 id="id-7-write-our-change-detection-results-and-metrics-images-to-geotiff-files" class="relative group"><span class="heading-text">7. Write Our Change Detection Results and Metrics Images to GeoTIFF files</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-7-write-our-change-detection-results-and-metrics-images-to-geotiff-files" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="id-7-1-determine-output-geometry" class="relative group"><span class="heading-text">7.1 Determine Output Geometry</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-7-1-determine-output-geometry" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>First, we need to <strong>set the correct geotransformation and projection information</strong>. We retrieve the values from the input images:</p></div><div id="wVPrXPq8VH" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">proj=img.GetProjection()
geotrans=list(img.GetGeoTransform())
geotrans</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5ZyKdgFoLpLqdcJlRBntO" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="kRTzQmK5w2" class="relative group/block"><h3 id="id-7-2-output-time-series-metrics-images" class="relative group"><span class="heading-text">7.2 Output Time Series Metrics Images</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-7-2-output-time-series-metrics-images" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>We use the root of the time series data stack name and append a <em>ts_metrics</em>&lt;metric&gt;.tif ending as filenames:</p></div><div id="aB8z7em0R6" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Time Series Metrics as image:
# We make a new subdirectory where we will store the images

dirname = analysis_dir/f&quot;{str(analysis_dir).split(&#x27;/&#x27;)[-1]}_tsmetrics_{pol}&quot;
if not dirname.exists():
    dirname.mkdir()

print(dirname)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="O898Ou1KKGTuDi0yFdpVm" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="qO7mOmLwRB" class="relative group/block"><p>Now we can <strong>output the individual metrics as GeoTIFF images</strong>:</p></div><div id="slusVI05jW" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">names=[] # List to keep track of all the names
for metric in metrics:
    name_ = dirname/f&#x27;{metric}_{labeldB}.tif&#x27;
    create_geotiff(str(name_), metrics[metric], gdal.GDT_Float32, np.nan, [metric],
                  geo_t=geotrans, projection=proj)
    names.append(str(name_))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="_ihWTl7yJ8amnSUwCe9EM" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="xJf9a9bFCa" class="relative group/block"><h3 id="id-7-3-build-a-virtual-raster-table-on-the-metrics-geotiff-images" class="relative group"><span class="heading-text">7.3 Build a Virtual Raster Table on the Metrics GeoTIFF images</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-7-3-build-a-virtual-raster-table-on-the-metrics-geotiff-images" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>To tie the images into one new raster stack of time series metrics we build a virtual raster table with all the metrics.</p><p>Trick: Use ’ &#x27;.join(names) to build one long string of names separated by a space as input to <em>gdalbuildvrt</em>:</p></div><div id="UnI7t3rbQ2" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">cmd=f&#x27;gdalbuildvrt -separate -overwrite -vrtnodata nan {str(dirname)}&#x27; +\
f&#x27;_{labeldB}.vrt &#x27;+&#x27; &#x27;.join(names)
print(cmd)

_ = system(cmd)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="CMVXhuiKyHnUVK_jjp97Q" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="AL9Jz4vR5j" class="relative group/block"><h3 id="id-7-4-create-geotiffs-for-the-change-iamges-from-our-four-change-detection-attempts" class="relative group"><span class="heading-text">7.4 Create GeoTIFFs for the Change Iamges from our Four Change Detection Attempts</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-7-4-create-geotiffs-for-the-change-iamges-from-our-four-change-detection-attempts" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>We are going to write GeoTIFF output files that stores the results from the classifiers:</p></div><div id="hrQR4KtZve" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">for metric in masks:  
    fnmetric = dirname/f&quot;{str(analysis_dir).split(&#x27;/&#x27;)[-1]}_{labeldB}_{metric}_thresholds.tif&quot;
    print(fnmetric)

    create_geotiff(str(fnmetric), masks[metric], gdal.GDT_Byte, np.nan, 
                  geo_t=geotrans, projection=proj)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="4AQ4f5nbbvgBjmsm0CTab" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="BjIQESgDsi" class="relative group/block"><p><em>SARChangeDetectionMethods_From_Prepared_Data_Stack - Version 1.4.2 - November 2021</em></p><p><em>Version Changes</em></p><ul><li><p><em>update get_date function</em></p></li></ul></div><div></div><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/NISAR_GCOV_Cookbook/notebooks/nisar-gcov-time-series-example"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">Placeholder (unorganized notebooks)</div>Explore an Example NISAR GCOV Backscatter Time Series</div></div></a></div></article></main><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/NISAR_GCOV_Cookbook/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/NISAR_GCOV_Cookbook/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/NISAR_GCOV_Cookbook/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/NISAR_GCOV_Cookbook/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/NISAR_GCOV_Cookbook/build/_shared/chunk-N2N6M3QH.js"/><link rel="modulepreload" href="/NISAR_GCOV_Cookbook/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/NISAR_GCOV_Cookbook/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/NISAR_GCOV_Cookbook/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/NISAR_GCOV_Cookbook/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/NISAR_GCOV_Cookbook/build/_shared/chunk-CPTH56EW.js"/><link rel="modulepreload" href="/NISAR_GCOV_Cookbook/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/NISAR_GCOV_Cookbook/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/NISAR_GCOV_Cookbook/build/_shared/chunk-S4SWV34C.js"/><link rel="modulepreload" href="/NISAR_GCOV_Cookbook/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/NISAR_GCOV_Cookbook/build/root-ZJZ4LRPY.js"/><link rel="modulepreload" href="/NISAR_GCOV_Cookbook/build/_shared/chunk-KGDL62ZF.js"/><link rel="modulepreload" href="/NISAR_GCOV_Cookbook/build/routes/$-23AHH5XS.js"/><script>window.__remixContext = {"url":"/notebooks/nisar-gcov-sarchangedetectionmethods","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.4","options":{"favicon":"/NISAR_GCOV_Cookbook/build/config-item-2358b6c8-446b3a832c2ec0c76a9da22784cfff56.svg","logo":"/NISAR_GCOV_Cookbook/build/config-item-08e8db8a-6ef1367255b30e794122aa323fd27dd2.svg","logo_url":"https://asf.alaska.edu/","folders":true},"parts":{},"nav":[{"title":"ASF","children":[{"title":"ASF","url":"https://asf.alaska.edu/"},{"title":"ASF OpenScienceLab","url":"https://opensciencelab.asf.alaska.edu/"},{"title":"ASF Data Search (Vertex)","url":"https://search.asf.alaska.edu/#/"},{"title":"ASF HyP3","url":"https://hyp3-docs.asf.alaska.edu/hyp3-docs/about/"}]},{"title":"NASA Earthdata","url":"https://www.earthdata.nasa.gov/"},{"title":"Project Pythia","url":"https://projectpythia.org"},{"title":"SAR Cookbooks","url":"https://github.com/ASFOpenSARlab"}],"actions":[{"title":"ASF","url":"https://asf.alaska.edu/","internal":false,"static":false}],"projects":[{"open_access":true,"license":{"content":{"id":"BSD-3-Clause","url":"https://opensource.org/licenses/BSD-3-Clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","free":true,"osi":true}},"title":"NISAR GCOV Cookbook","authors":[{"nameParsed":{"literal":"The Alaska Satellite Facility","given":"The Alaska Satellite","family":"Facility"},"name":"The Alaska Satellite Facility","id":"contributors-myst-generated-uid-0"}],"contributors":[{"id":"Alex-Lewandowski","nameParsed":{"literal":"Alex Lewandowski","given":"Alex","family":"Lewandowski"},"name":"Alex Lewandowski","orcid":"0009-0006-9584-0687","email":"aflewandowski@alaska.edu","affiliations":["ASF"],"github":"Alex-Lewandowski","linkedin":"https://www.linkedin.com/in/brian-rose-37bb55106/"},{"id":"julia-white","nameParsed":{"literal":"Julia White","given":"Julia","family":"White"},"name":"Julia White","affiliations":["UAF"]}],"github":"https://github.com/ASFOpenSARlab/NISAR_GCOV_Cookbook","affiliations":[{"id":"UAF","name":"University of Alaska Fairbanks","department":"Geophysical Institute","url":"https://www.gi.alaska.edu/"},{"id":"ASF","name":"Alaska Satellite Facility","url":"https://asf.alaska.edu/"}],"copyright":"2025","thebe":{"binder":{"url":"https://mybinder.org/","provider":"github","repo":"ASFOpenSARlab/NISAR_GCOV_Cookbook","ref":"HEAD"}},"toc":[{"file":"README.md"},{"children":[{"file":"notebooks/GCOV_intro.md"},{"url":"https://nisar.asf.earthdatacloud.nasa.gov/NISAR-SAMPLE-DATA/DOCS/NISAR_D-102274_RevE_NASA_SDS_Product_Specification_L2_GCOV_Nov8_2024_w-sigs.pdf","title":"NISAR GCOV Product Specification"}],"title":"Introduction to NISAR GCOV data"},{"children":[{"file":"notebooks/create_software_environment.ipynb"},{"file":"notebooks/set_up_Earthdata_Login.md"}],"title":"Prerequisites"},{"children":[{"file":"notebooks/NISAR_GCOV_Time_Series_Example.ipynb"},{"file":"notebooks/NISAR_GCOV_SARChangeDetectionMethods.ipynb"}],"title":"Placeholder (unorganized notebooks)"}],"thumbnail":"/NISAR_GCOV_Cookbook/build/thumbnail-026dbb82f595025330104291f168d4b8.png","exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Introduction to NISAR GCOV data"},{"slug":"notebooks.gcov-intro","title":"NISAR Level 2 Geocoded Covariance (GCOV) Product","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"NISAR GCOV Product Specification","url":"https://nisar.asf.earthdatacloud.nasa.gov/NISAR-SAMPLE-DATA/DOCS/NISAR_D-102274_RevE_NASA_SDS_Product_Specification_L2_GCOV_Nov8_2024_w-sigs.pdf","level":2},{"level":1,"title":"Prerequisites"},{"slug":"notebooks.create-software-environment","title":"Install Required Sorftware","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.set-up-earthdata-login","title":"Set Up an Earthdata Login Account for NISAR Data Access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Placeholder (unorganized notebooks)"},{"slug":"notebooks.nisar-gcov-time-series-example","title":"Explore an Example NISAR GCOV Backscatter Time Series","description":"","date":"","thumbnail":"/NISAR_GCOV_Cookbook/build/124abe7b9f98c2cf05d8765a59216420.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.nisar-gcov-sarchangedetectionmethods","title":"An Introduction to Simple SAR Change Detection Methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/NISAR_GCOV_Cookbook"},"routes/$":{"config":{"version":2,"myst":"1.6.4","options":{"favicon":"/NISAR_GCOV_Cookbook/build/config-item-2358b6c8-446b3a832c2ec0c76a9da22784cfff56.svg","logo":"/NISAR_GCOV_Cookbook/build/config-item-08e8db8a-6ef1367255b30e794122aa323fd27dd2.svg","logo_url":"https://asf.alaska.edu/","folders":true},"parts":{},"nav":[{"title":"ASF","children":[{"title":"ASF","url":"https://asf.alaska.edu/"},{"title":"ASF OpenScienceLab","url":"https://opensciencelab.asf.alaska.edu/"},{"title":"ASF Data Search (Vertex)","url":"https://search.asf.alaska.edu/#/"},{"title":"ASF HyP3","url":"https://hyp3-docs.asf.alaska.edu/hyp3-docs/about/"}]},{"title":"NASA Earthdata","url":"https://www.earthdata.nasa.gov/"},{"title":"Project Pythia","url":"https://projectpythia.org"},{"title":"SAR Cookbooks","url":"https://github.com/ASFOpenSARlab"}],"actions":[{"title":"ASF","url":"https://asf.alaska.edu/","internal":false,"static":false}],"projects":[{"open_access":true,"license":{"content":{"id":"BSD-3-Clause","url":"https://opensource.org/licenses/BSD-3-Clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","free":true,"osi":true}},"title":"NISAR GCOV Cookbook","authors":[{"nameParsed":{"literal":"The Alaska Satellite Facility","given":"The Alaska Satellite","family":"Facility"},"name":"The Alaska Satellite Facility","id":"contributors-myst-generated-uid-0"}],"contributors":[{"id":"Alex-Lewandowski","nameParsed":{"literal":"Alex Lewandowski","given":"Alex","family":"Lewandowski"},"name":"Alex Lewandowski","orcid":"0009-0006-9584-0687","email":"aflewandowski@alaska.edu","affiliations":["ASF"],"github":"Alex-Lewandowski","linkedin":"https://www.linkedin.com/in/brian-rose-37bb55106/"},{"id":"julia-white","nameParsed":{"literal":"Julia White","given":"Julia","family":"White"},"name":"Julia White","affiliations":["UAF"]}],"github":"https://github.com/ASFOpenSARlab/NISAR_GCOV_Cookbook","affiliations":[{"id":"UAF","name":"University of Alaska Fairbanks","department":"Geophysical Institute","url":"https://www.gi.alaska.edu/"},{"id":"ASF","name":"Alaska Satellite Facility","url":"https://asf.alaska.edu/"}],"copyright":"2025","thebe":{"binder":{"url":"https://mybinder.org/","provider":"github","repo":"ASFOpenSARlab/NISAR_GCOV_Cookbook","ref":"HEAD"}},"toc":[{"file":"README.md"},{"children":[{"file":"notebooks/GCOV_intro.md"},{"url":"https://nisar.asf.earthdatacloud.nasa.gov/NISAR-SAMPLE-DATA/DOCS/NISAR_D-102274_RevE_NASA_SDS_Product_Specification_L2_GCOV_Nov8_2024_w-sigs.pdf","title":"NISAR GCOV Product Specification"}],"title":"Introduction to NISAR GCOV data"},{"children":[{"file":"notebooks/create_software_environment.ipynb"},{"file":"notebooks/set_up_Earthdata_Login.md"}],"title":"Prerequisites"},{"children":[{"file":"notebooks/NISAR_GCOV_Time_Series_Example.ipynb"},{"file":"notebooks/NISAR_GCOV_SARChangeDetectionMethods.ipynb"}],"title":"Placeholder (unorganized notebooks)"}],"thumbnail":"/NISAR_GCOV_Cookbook/build/thumbnail-026dbb82f595025330104291f168d4b8.png","exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Introduction to NISAR GCOV data"},{"slug":"notebooks.gcov-intro","title":"NISAR Level 2 Geocoded Covariance (GCOV) Product","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"NISAR GCOV Product Specification","url":"https://nisar.asf.earthdatacloud.nasa.gov/NISAR-SAMPLE-DATA/DOCS/NISAR_D-102274_RevE_NASA_SDS_Product_Specification_L2_GCOV_Nov8_2024_w-sigs.pdf","level":2},{"level":1,"title":"Prerequisites"},{"slug":"notebooks.create-software-environment","title":"Install Required Sorftware","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.set-up-earthdata-login","title":"Set Up an Earthdata Login Account for NISAR Data Access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Placeholder (unorganized notebooks)"},{"slug":"notebooks.nisar-gcov-time-series-example","title":"Explore an Example NISAR GCOV Backscatter Time Series","description":"","date":"","thumbnail":"/NISAR_GCOV_Cookbook/build/124abe7b9f98c2cf05d8765a59216420.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.nisar-gcov-sarchangedetectionmethods","title":"An Introduction to Simple SAR Change Detection Methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"version":2,"kind":"Notebook","sha256":"f3776ed277c57a8594d9f9dd07f39c73efd7d16c71f6f6d6b47d3a13eb7e75ac","slug":"notebooks.nisar-gcov-sarchangedetectionmethods","location":"/notebooks/NISAR_GCOV_SARChangeDetectionMethods.ipynb","dependencies":[],"frontmatter":{"title":"An Introduction to Simple SAR Change Detection Methods","content_includes_title":true,"kernelspec":{"name":"conda-env-.local-uwg_demo-uwg_demo","display_name":"uwg_demo [conda env:.local-uwg_demo]","language":"python"},"authors":[{"nameParsed":{"literal":"The Alaska Satellite Facility","given":"The Alaska Satellite","family":"Facility"},"name":"The Alaska Satellite Facility","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"BSD-3-Clause","url":"https://opensource.org/licenses/BSD-3-Clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","free":true,"osi":true}},"github":"https://github.com/ASFOpenSARlab/NISAR_GCOV_Cookbook","copyright":"2025","affiliations":[{"id":"UAF","name":"University of Alaska Fairbanks","department":"Geophysical Institute","url":"https://www.gi.alaska.edu/"},{"id":"ASF","name":"Alaska Satellite Facility","url":"https://asf.alaska.edu/"}],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/ASFOpenSARlab/NISAR_GCOV_Cookbook/blob/main/notebooks/NISAR_GCOV_SARChangeDetectionMethods.ipynb","edit_url":"https://github.com/ASFOpenSARlab/NISAR_GCOV_Cookbook/edit/main/notebooks/NISAR_GCOV_SARChangeDetectionMethods.ipynb","exports":[{"format":"ipynb","filename":"NISAR_GCOV_SARChangeDetectionMethods.ipynb","url":"/NISAR_GCOV_Cookbook/build/NISAR_GCOV_SARChange-059ba8ac7eb3ce59b83856ec2f35d975.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"hide_input":false},"children":[{"type":"image","url":"/myst_assets_folderNotebookAddons/blackboard-banner.png","alt":"OpenSARlab notebook banner","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jLVLvAErfw"},{"type":"heading","depth":1,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"An Introduction to Simple SAR Change Detection Methods","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"b8XHQX0NDS"}],"identifier":"an-introduction-to-simple-sar-change-detection-methods","label":"An Introduction to Simple SAR Change Detection Methods","html_id":"an-introduction-to-simple-sar-change-detection-methods","implicit":true,"key":"GOQ2qLNyCV"},{"type":"heading","depth":3,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Franz J Meyer; University of Alaska Fairbanks","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"lvZBywaiQF"}],"identifier":"franz-j-meyer-university-of-alaska-fairbanks","label":"Franz J Meyer; University of Alaska Fairbanks","html_id":"franz-j-meyer-university-of-alaska-fairbanks","implicit":true,"key":"Suens86DCH"},{"type":"image","style":{"padding":"5px"},"url":"/myst_assets_folderNotebookAddons/UAFLogo_A_647.png","width":170,"key":"r9zqEmfMYn"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"This notebook introduces you to a some popular change detection methods that can be applied on SAR time series data. SAR is an excellent tool for change detection. As SAR sensors are weather and illumination independent, and as SAR’s carry their own illumination source (active sensor), differences between repeated images are a direct indication of changes on the surface. This fact is exploited by the change detection methods introduced below.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"uzZ8Tp9TIE"}],"key":"Zq8PIiyaCf"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"The exercise is done in the framework of ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"oQ4yd0e25s"},{"type":"emphasis","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Jupyter Notebooks","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"yi51Nx9k43"}],"key":"cJF7194Is4"},{"type":"text","value":". The Jupyter Notebook environment is easy to launch in any web browser for interactive data exploration with provided or new training data. Notebooks are comprised of text written in a combination of executable python code and markdown formatting including latex style mathematical equations. Another advantage of Jupyter Notebooks is that they can easily be expanded, changed, and shared with new data sets or newly available time series steps. Therefore, they provide an excellent basis for collaborative and repeatable data analysis.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"XN8Gm12Hkg"}],"key":"EOzUP99GYM"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"This notebook covers the following data analysis concepts:","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"LLZNEhzpKh"}],"key":"tyYa5DPdod"}],"key":"i4og3Pnurj"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":15,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Time series metrics  95","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"TSJF09YFz8"},{"type":"inlineMath","value":"^{th}","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmrow\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmi\u003eh\u003c/mi\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e^{th}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8491em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8491em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003et\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eh\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"S10kluMvMu"},{"type":"text","value":" and 5","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Anrbd6yXT4"},{"type":"inlineMath","value":"^{th}","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmrow\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmi\u003eh\u003c/mi\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e^{th}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8491em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8491em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003et\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eh\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"x17pKJcZS2"},{"type":"text","value":" percentile difference thresholding","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"F0cxK2Vqml"}],"key":"tst9IJl5vS"}],"key":"yfuZlvwBOW"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Time series coefficient of variation thresholding","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"qPmNFgcJip"}],"key":"FN0pqkHuOa"}],"key":"qM3ZTeyiqO"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Log Ratio-based change detection from image pairs","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"bIM33Nk3ne"}],"key":"A6NIzDAumn"}],"key":"Y2bY7bVCI1"}],"key":"ZMqWAqYcQ7"}],"key":"aXJO0Q6los"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","key":"nyYdKqMAYD"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","children":[{"type":"text","value":"0. Importing Relevant Python Packages","key":"YK7zKTSwBr"}],"key":"IdO0fiI8KX"}],"key":"b8cjqwsGNJ"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"In this notebook we will use the following scientific libraries:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"T816ESZ3fo"}],"key":"QDkJA9qK26"},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"link","url":"https://pandas.pydata.org/","children":[{"type":"text","value":"Pandas","key":"M98slQ3dkN"}],"urlSource":"https://pandas.pydata.org/","key":"qLTRSUT3aB"}],"key":"W6EFJ4jnDm"},{"type":"text","value":" is a Python library that provides high-level data structures and a vast variety of tools for analysis. The great feature of this package is the ability to translate rather complex operations with data into one or two commands. Pandas contains many built-in methods for filtering and combining data, as well as the time-series functionality.","key":"Et9edoFSYm"}],"key":"XX21MaODRh"}],"key":"Xcm2QuLCtV"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"link","url":"https://www.gdal.org/","children":[{"type":"text","value":"GDAL","key":"soF63AXgBv"}],"urlSource":"https://www.gdal.org/","key":"BAKZM3hHIR"}],"key":"m0mcjnmxtv"},{"type":"text","value":" is a software library for reading and writing raster and vector geospatial data formats. It includes a collection of programs tailored for geospatial data processing. Most modern GIS systems (such as ArcGIS or QGIS) use GDAL in the background.","key":"uPhFa2t5wo"}],"key":"fOCRZzWF6Q"}],"key":"iEZq4wUEsj"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"link","url":"http://www.numpy.org/","children":[{"type":"text","value":"NumPy","key":"qIitVdMkvq"}],"urlSource":"http://www.numpy.org/","key":"c0UoIUzli2"}],"key":"tZcOAJ5FpW"},{"type":"text","value":" is one of the principal packages for scientific applications of Python. It is intended for processing large multidimensional arrays and matrices, and an extensive collection of high-level mathematical functions and implemented methods makes it possible to perform various operations with these objects.","key":"AE1pHZVAba"}],"key":"VH5zjmz6Dn"}],"key":"urouE8daqe"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"link","url":"https://matplotlib.org/index.html","children":[{"type":"text","value":"Matplotlib","key":"NFNUURkfSZ"}],"urlSource":"https://matplotlib.org/index.html","key":"mLqGQNWEcu"}],"key":"TMgcLY4r6z"},{"type":"text","value":" is a low-level library for creating two-dimensional diagrams and graphs. With its help, you can build diverse charts, from histograms and scatterplots to non-Cartesian coordinates graphs. Moreover, many popular plotting libraries are designed to work in conjunction with matplotlib.","key":"gfT0gM1LWY"}],"key":"jQRclK6nxq"}],"key":"dyDA8jHb06"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The ","key":"m8Zbq4Tzd5"},{"type":"strong","children":[{"type":"link","url":"https://www.pydoc.io/pypi/asf-hyp3-1.1.1/index.html","children":[{"type":"text","value":"asf-hyp3 API","key":"y6R9ng0pam"}],"urlSource":"https://www.pydoc.io/pypi/asf-hyp3-1.1.1/index.html","key":"KclJ4uLgXm"}],"key":"FzX4NWXZk5"},{"type":"text","value":" provides useful functions and scripts for accessing and processing SAR data via the Alaska Satellite Facility's Hybrid Pluggable Processing Pipeline, or HyP3 (pronounced \"hype\").","key":"oiFcUpMJ6F"}],"key":"V75JknWO3W"}],"key":"tV5cZNejOS"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"link","url":"https://www.scipy.org/about.html","children":[{"type":"text","value":"SciPY","key":"ePMvIWlvQN"}],"urlSource":"https://www.scipy.org/about.html","key":"PATy80MfQx"}],"key":"EdvWzxYKvu"},{"type":"text","value":" is a library that provides functions for numerical integration, interpolation, optimization, linear algebra and statistics.","key":"yyuBaNtMhF"}],"key":"cuPNh7tvM5"}],"key":"cyuxbPXCwO"}],"key":"hVzz3da8NX"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Our first step is to ","key":"b14rcha2py"},{"type":"strong","children":[{"type":"text","value":"import them:","key":"LWr7ReFFpo"}],"key":"CfOpbjBrPd"}],"key":"EdPxTQ5ygV"}],"key":"rq52k1goF5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# %%capture\n# from pathlib import Path\n# from os import system\n# import datetime # for date\n# import re\n\n# import pandas as pd # for DatetimeIndex\n# from osgeo import gdal # for Info\n# gdal.UseExceptions()\n\n# %matplotlib inline\n# import matplotlib.pyplot as plt\n# from matplotlib import animation\n# from matplotlib import rc\n# import numpy as np\n\n# from ipyfilechooser import FileChooser\n\n# from IPython.display import HTML\n\n# import opensarlab_lib as asfn\n# asfn.jupytertheme_matplotlib_format()","key":"ezjOcstScg"},{"type":"output","id":"cJdgUOFR5bDSDZFnfg-sb","data":[],"key":"Zb4WmHFfOZ"}],"key":"nvFji2Yrgl"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1. Load Data Stack","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RpZEqaq0Ob"}],"identifier":"id-1-load-data-stack","label":"1. Load Data Stack","html_id":"id-1-load-data-stack","implicit":true,"key":"o2P8Pb8axd"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In the Exercise4A-SARChangeDetectionMethods.ipynb notebook will used a dense 12-day repeat Sentinel-1 C-band SAR data stack. It contained imagery acquired during the year 2018 in Guatemala. The data was already prepared for you. Now, you will later learn how to download and pre-process Sentinel-1 images using the services of the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FvPvjViTfd"},{"type":"link","url":"https://www.asf.alaska.edu/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Alaska Satellite Facility","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZAmu1F8fZ9"}],"urlSource":"https://www.asf.alaska.edu/","key":"YBv0EFSmUh"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PVVbjK008b"}],"key":"EvRVpEx3Eh"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Begin by writing a function to retrieve the absolute paths to each of our tiffs:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"J8qZoFluqu"}],"key":"FlE2m9i0J5"}],"key":"efGEKJFYuq"}],"key":"BXGvmrwcqy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# def get_tiff_paths(paths):\n#     tiff_paths = !ls $paths | sort -t_ -k5,5\n#     return tiff_paths","key":"okm9ifmcFL"},{"type":"output","id":"-MCaFdW36y3wSQzODha0J","data":[],"key":"jKQUTawqae"}],"key":"gLZSNPBXIr"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Select the directory holding your tiffs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oN8QXenDzN"}],"key":"PB02dpnl8x"}],"key":"xNp2WgbR39"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Click the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"IL4owbP5Hh"},{"type":"inlineCode","value":"Select","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"pFKpCke6x7"},{"type":"text","value":" button","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"QDVTxqg87r"}],"key":"SPKlAPK4fN"}],"key":"JClaf2VDd4"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Navigate to your data directory","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tFTKVMLtBs"}],"key":"HTHSq6UrBg"}],"key":"d2ySO4Ayqu"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Click the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"rtXRYrxpLX"},{"type":"inlineCode","value":"Select","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"JchZC0nlRM"},{"type":"text","value":" button","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"D87La2EIDv"}],"key":"k0OiIfXb5b"}],"key":"SVJspsIxiy"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Confirm that the desired path appears in green text","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"hvhbyjrMGH"}],"key":"m0jibg5oUU"}],"key":"WLvBLFYhGu"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Click the ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"kcYNRwHbpZ"},{"type":"inlineCode","value":"Change","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"num3NX74lU"},{"type":"text","value":" button to alter your selection","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"T6K4O6CHyG"}],"key":"MJnyYjkpax"}],"key":"TmJe0Ab8Bb"}],"key":"GpQwFwkQ5S"}],"key":"suIOHgRcGb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# fc = FileChooser(Path.cwd())\n# display(fc)","key":"WiZMdyEaNZ"},{"type":"output","id":"JxcLDiBBKAoNUu07DWIcD","data":[],"key":"uCQIereC6D"}],"key":"fATjb0ozJU"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine the path to the analysis directory containing the tiff directory:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uWLweoux3o"}],"key":"wK3jZD150x"}],"key":"UQusQg7e5H"}],"key":"nJSmEI7Ucy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from pathlib import Path\n\nchange_detection_example_dir = Path.cwd() / \"change_detection_example\"\n\ndata_dir = change_detection_example_dir / \"data\"\ndata_dir.mkdir(parents=True, exist_ok=True)\n\nplot_dir = change_detection_example_dir / \"plots\"\nplot_dir.mkdir(exist_ok=True)","key":"xf7D6OIAW7"},{"type":"output","id":"GApTYIjGz_9RwF39pHehr","data":[],"key":"dXXwNczeLm"}],"key":"ebstEBoWiP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\nimport asf_search as asf\n# from getpass import getpass\n\n\nwkt = \"POLYGON((-57.759 -3.5099,-56.459 -3.5099,-56.459 -2.6352,-57.759 -2.6352,-57.759 -3.5099))\"\n\nopts=asf.ASFSearchOptions(**{\n    \"maxResults\": 250,\n    \"intersectsWith\": wkt,\n    \"processingLevel\": [\n        \"GCOV\"\n    ],\n    \"dataset\": [\n        \"NISAR\"\n    ],\n    \"productionConfiguration\": [\n        \"PR\"\n    ],\n    \"host\": \"cmr.uat.earthdata.nasa.gov\"\n})\n\nsession = asf.ASFSession(cmr_host='cmr.uat.earthdata.nasa.gov')\n# session.auth_with_token(getpass('UAT EDL token'))\nsession.auth_with_token(os.environ[\"UAT_TOKEN\"])\n\nresponse = asf.search(opts=opts)\n\nhdf5_files = response.find_urls(extension='.h5', pattern=r'^(?!.*STATS).*DHDH.*', directAccess=False)\nasf.download_urls(hdf5_files, data_dir, session=session, processes=4)","key":"SgjKVbsdUy"},{"type":"output","id":"_JnLcJpLaNgq28R48CIpT","data":[],"key":"w6ONiNoOpb"}],"key":"qsPN0pOgTS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# TODO: Delete when we have real NISAR data\n# Duplicates the one sample GCOV file we have\nimport shutil\n\nf = list(data_dir.glob('*.h5'))[0]\nfor i in range(7): \n    shutil.copy(f, f.parent / f\"{f.stem}_{i}.h5\")","key":"BGCRm98mXI"},{"type":"output","id":"OYGrgMixboLs5zkD5rzYU","data":[],"key":"MlBRtrzD6f"}],"key":"qZl0cgjnoN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"gcov_files = sorted(list(data_dir.glob(\"*.h5\")))\ngcov_files","key":"G5Bw7JwTIM"},{"type":"output","id":"jWgc5euFFp-Qn-4sxaiID","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"[PosixPath('/home/jovyan/opensarlab-notebooks/SAR_Training/English/Master/change_detection_example/data/NISAR_L2_PR_GCOV_087_039_D_090_2005_DHDH_A_20251102T220639_20251102T220714_T00407_N_F_J_001.h5'),\n PosixPath('/home/jovyan/opensarlab-notebooks/SAR_Training/English/Master/change_detection_example/data/NISAR_L2_PR_GCOV_087_039_D_090_2005_DHDH_A_20251102T220639_20251102T220714_T00407_N_F_J_001_0.h5'),\n PosixPath('/home/jovyan/opensarlab-notebooks/SAR_Training/English/Master/change_detection_example/data/NISAR_L2_PR_GCOV_087_039_D_090_2005_DHDH_A_20251102T220639_20251102T220714_T00407_N_F_J_001_1.h5'),\n PosixPath('/home/jovyan/opensarlab-notebooks/SAR_Training/English/Master/change_detection_example/data/NISAR_L2_PR_GCOV_087_039_D_090_2005_DHDH_A_20251102T220639_20251102T220714_T00407_N_F_J_001_2.h5'),\n PosixPath('/home/jovyan/opensarlab-notebooks/SAR_Training/English/Master/change_detection_example/data/NISAR_L2_PR_GCOV_087_039_D_090_2005_DHDH_A_20251102T220639_20251102T220714_T00407_N_F_J_001_3.h5'),\n PosixPath('/home/jovyan/opensarlab-notebooks/SAR_Training/English/Master/change_detection_example/data/NISAR_L2_PR_GCOV_087_039_D_090_2005_DHDH_A_20251102T220639_20251102T220714_T00407_N_F_J_001_4.h5'),\n PosixPath('/home/jovyan/opensarlab-notebooks/SAR_Training/English/Master/change_detection_example/data/NISAR_L2_PR_GCOV_087_039_D_090_2005_DHDH_A_20251102T220639_20251102T220714_T00407_N_F_J_001_5.h5'),\n PosixPath('/home/jovyan/opensarlab-notebooks/SAR_Training/English/Master/change_detection_example/data/NISAR_L2_PR_GCOV_087_039_D_090_2005_DHDH_A_20251102T220639_20251102T220714_T00407_N_F_J_001_6.h5')]","content_type":"text/plain"}}}],"key":"WAIkxrMiuA"}],"key":"jJ3E1hIoiz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import re\nimport h5py\nimport numpy as np\nimport xarray as xr\nimport dask.array as da\nfrom dask import delayed\n\n_date_regex = re.compile(r\"_(\\d{8}T\\d{6})_\")\ndef _get_ts(filename):\n    match = _date_regex.search(filename)\n    if match:\n        ts_str = match.group(1)\n        return np.datetime64(f\"{ts_str[:4]}-{ts_str[4:6]}-{ts_str[6:8]}T{ts_str[9:11]}:{ts_str[11:13]}:{ts_str[13:15]}\") \n    return np.datetime64(\"NaT\")\n\ndef open_gcov(gcov_paths, vars_to_load=(\"HHHH\", \"HVHV\", \"mask\", \"numberOfLooks\", \"rtcGammaToSigmaFactor\"), freqs=(\"A\",\"B\"), max_xy_chunk=2048):\n    gcov_paths = sorted(gcov_paths)\n    group = {f: f\"/science/LSAR/GCOV/grids/frequency{f}\" for f in freqs}\n    with h5py.File(gcov_paths[0], \"r\") as f0:\n        g = f0[group[freqs[0]]]\n        x, y = g[\"xCoordinates\"][...], g[\"yCoordinates\"][...]\n        proj = g[\"projection\"][()]\n    ny, nx = len(y), len(x)\n    time = np.array([_get_ts(p.name) for p in gcov_paths])\n    chunks = (1, 1, min(ny, max_xy_chunk), min(nx, max_xy_chunk))  # (time, frequency, y, x)\n\n    data_vars = {}\n    for v in vars_to_load:\n        per_freq = []\n        for freq in freqs:\n            with h5py.File(gcov_paths[0], \"r\") as f0:\n                dt = f0[f\"{group[freq]}/{v}\"].dtype\n            planes = [da.from_delayed(delayed(lambda p, d: h5py.File(p,\"r\")[d][...])(p, f\"{group[freq]}/{v}\"),\n                                      shape=(ny, nx), dtype=dt)[None, None, ...]\n                      for p in gcov_paths]\n            per_freq.append(da.concatenate(planes, axis=0))\n        stacked = da.concatenate(per_freq, axis=1).rechunk(chunks)\n        data_vars[v] = ((\"time\",\"frequency\",\"y\",\"x\"), stacked)\n\n    return xr.Dataset(\n        data_vars=data_vars,\n        coords={\"time\": time, \"frequency\": np.array(list(freqs)), \"y\": y, \"x\": x},\n        attrs={\"source\": \"NISAR L2 GCOV\", \"projection\": proj},\n    )","key":"rb3iC4vZ1u"},{"type":"output","id":"M7_asucSrXJcBkqOJODRj","data":[],"key":"lmUzHneVTM"}],"key":"IA7qbbgk68"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds = open_gcov(gcov_files)\nds","key":"QNoMuM6UUe"},{"type":"output","id":"wuuZQuibYCt0R5SdoeQTJ","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"73bbe162540d5c6bdceb45fb34ad6308","path":"/NISAR_GCOV_Cookbook/build/73bbe162540d5c6bdceb45fb34ad6308.html"},"text/plain":{"content":"\u003cxarray.Dataset\u003e Size: 72GB\nDimensions:                (time: 8, frequency: 2, y: 15984, x: 16668)\nCoordinates:\n  * time                   (time) datetime64[s] 64B 2025-11-02T22:06:39 ... 2...\n  * frequency              (frequency) \u003cU1 8B 'A' 'B'\n  * y                      (y) float64 128kB 9.819e+06 9.819e+06 ... 9.499e+06\n  * x                      (x) float64 133kB 3.312e+05 3.312e+05 ... 6.646e+05\nData variables:\n    HHHH                   (time, frequency, y, x) float32 17GB dask.array\u003cchunksize=(1, 1, 2048, 2048), meta=np.ndarray\u003e\n    HVHV                   (time, frequency, y, x) float32 17GB dask.array\u003cchunksize=(1, 1, 2048, 2048), meta=np.ndarray\u003e\n    mask                   (time, frequency, y, x) uint8 4GB dask.array\u003cchunksize=(1, 1, 2048, 2048), meta=np.ndarray\u003e\n    numberOfLooks          (time, frequency, y, x) float32 17GB dask.array\u003cchunksize=(1, 1, 2048, 2048), meta=np.ndarray\u003e\n    rtcGammaToSigmaFactor  (time, frequency, y, x) float32 17GB dask.array\u003cchunksize=(1, 1, 2048, 2048), meta=np.ndarray\u003e\nAttributes:\n    source:      NISAR L2 GCOV\n    projection:  32721","content_type":"text/plain"}}}],"key":"WpObKu5w3E"}],"key":"VuCZer9YB7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# TODO: remove this when there is real NISAR data\n# Fakes a time series by updating dates and backscatter\n\nimport pandas as pd\n\nfake_times = pd.date_range(\n    start=\"2025-11-02T22:06:39\",\n    periods=ds.sizes[\"time\"],\n    freq=\"D\"\n)\n\nds = ds.assign_coords(time=fake_times)\n\n# adjust each duplicated time step's backscatter values for better test visualization\nfactors = 1 + 0.3 * np.sin(np.linspace(0, 2*np.pi, ds.sizes[\"time\"]))\nscaled = ds * xr.DataArray(factors, dims=[\"time\"])\nscaled = scaled.assign_attrs(ds.attrs)\nds = scaled\nds","key":"bnMXqegwgx"},{"type":"output","id":"Aw5FzE3y_tBrH-FvHbAmZ","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"1de35962776a9344e64e2be2ddbab3f9","path":"/NISAR_GCOV_Cookbook/build/1de35962776a9344e64e2be2ddbab3f9.html"},"text/plain":{"content":"\u003cxarray.Dataset\u003e Size: 171GB\nDimensions:                (frequency: 2, y: 15984, x: 16668, time: 8)\nCoordinates:\n  * frequency              (frequency) \u003cU1 8B 'A' 'B'\n  * y                      (y) float64 128kB 9.819e+06 9.819e+06 ... 9.499e+06\n  * x                      (x) float64 133kB 3.312e+05 3.312e+05 ... 6.646e+05\n  * time                   (time) datetime64[ns] 64B 2025-11-02T22:06:39 ... ...\nData variables:\n    HHHH                   (time, frequency, y, x) float64 34GB dask.array\u003cchunksize=(1, 1, 2048, 2048), meta=np.ndarray\u003e\n    HVHV                   (time, frequency, y, x) float64 34GB dask.array\u003cchunksize=(1, 1, 2048, 2048), meta=np.ndarray\u003e\n    mask                   (time, frequency, y, x) float64 34GB dask.array\u003cchunksize=(1, 1, 2048, 2048), meta=np.ndarray\u003e\n    numberOfLooks          (time, frequency, y, x) float64 34GB dask.array\u003cchunksize=(1, 1, 2048, 2048), meta=np.ndarray\u003e\n    rtcGammaToSigmaFactor  (time, frequency, y, x) float64 34GB dask.array\u003cchunksize=(1, 1, 2048, 2048), meta=np.ndarray\u003e\nAttributes:\n    source:      NISAR L2 GCOV\n    projection:  32721","content_type":"text/plain"}}}],"key":"gNYYhzqRze"}],"key":"A0uhfpQrZk"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine the path to the analysis directory containing the tiff directory:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MjeIgttivR"}],"key":"NvHphKfdlC"}],"key":"FRWzqnDIsE"}],"key":"fJ8upNgHkT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# polarization = asfn.select_parameter(['VV', 'VH'], 'polarization:')\n# polarization","key":"bUeIemYuQo"},{"type":"output","id":"tinJzvJMX6xm5RAm7fGEQ","data":[],"key":"s3APD0fFjN"}],"key":"FRmbWp5dSq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\npolarization = \"HVHV\"\nfrequency = \"A\"\n\nda = ds[polarization].sel(frequency=frequency,\n                          x=slice(400000.0, 500000.0),\n                          y=slice(9700000.0, 9600000.0))\nda = da.assign_attrs({**ds.attrs, **da.attrs})\n# da.load()\nda","key":"ebfiGMoaXq"},{"type":"output","id":"Vg8Rvid5pZdvNqeNk7ZvU","data":[{"name":"stdout","output_type":"stream","text":"CPU times: user 4.08 ms, sys: 0 ns, total: 4.08 ms\nWall time: 3.13 ms\n"},{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\u003csvg style=\"position: absolute; width: 0; height: 0; overflow: hidden\"\u003e\n\u003cdefs\u003e\n\u003csymbol id=\"icon-database\" viewBox=\"0 0 32 32\"\u003e\n\u003cpath d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"\u003e\u003c/path\u003e\n\u003c/symbol\u003e\n\u003csymbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\"\u003e\n\u003cpath d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003c/symbol\u003e\n\u003c/defs\u003e\n\u003c/svg\u003e\n\u003cstyle\u003e/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header \u003e div,\n.xr-header \u003e ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary \u003e span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label \u003e span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap \u003e label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item \u003e div,\n.xr-var-item label,\n.xr-var-item \u003e .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item \u003e .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list \u003e li:nth-child(odd) \u003e div,\n.xr-var-list \u003e li:nth-child(odd) \u003e label,\n.xr-var-list \u003e li:nth-child(odd) \u003e .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data \u003e table {\n  float: right;\n}\n\n.xr-var-data \u003e pre,\n.xr-index-data \u003e pre,\n.xr-var-data \u003e table \u003e tbody \u003e tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label \u003e .xr-icon-file-text2,\n.xr-var-data-in:checked + label \u003e .xr-icon-database,\n.xr-index-data-in:checked + label \u003e .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n\u003c/style\u003e\u003cpre class='xr-text-repr-fallback'\u003e\u0026lt;xarray.DataArray \u0026#x27;HVHV\u0026#x27; (time: 8, y: 5000, x: 5000)\u0026gt; Size: 2GB\ndask.array\u0026lt;getitem, shape=(8, 5000, 5000), dtype=float64, chunksize=(1, 2048, 2048), chunktype=numpy.ndarray\u0026gt;\nCoordinates:\n    frequency  \u0026lt;U1 4B \u0026#x27;A\u0026#x27;\n  * y          (y) float64 40kB 9.7e+06 9.7e+06 9.7e+06 ... 9.6e+06 9.6e+06\n  * x          (x) float64 40kB 4e+05 4e+05 4e+05 ... 5e+05 5e+05 5e+05\n  * time       (time) datetime64[ns] 64B 2025-11-02T22:06:39 ... 2025-11-09T2...\nAttributes:\n    source:      NISAR L2 GCOV\n    projection:  32721\u003c/pre\u003e\u003cdiv class='xr-wrap' style='display:none'\u003e\u003cdiv class='xr-header'\u003e\u003cdiv class='xr-obj-type'\u003exarray.DataArray\u003c/div\u003e\u003cdiv class='xr-array-name'\u003e'HVHV'\u003c/div\u003e\u003cul class='xr-dim-list'\u003e\u003cli\u003e\u003cspan class='xr-has-index'\u003etime\u003c/span\u003e: 8\u003c/li\u003e\u003cli\u003e\u003cspan class='xr-has-index'\u003ey\u003c/span\u003e: 5000\u003c/li\u003e\u003cli\u003e\u003cspan class='xr-has-index'\u003ex\u003c/span\u003e: 5000\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003cul class='xr-sections'\u003e\u003cli class='xr-section-item'\u003e\u003cdiv class='xr-array-wrap'\u003e\u003cinput id='section-75abffca-d1ca-4cf4-9a7a-4398c1423f93' class='xr-array-in' type='checkbox' checked\u003e\u003clabel for='section-75abffca-d1ca-4cf4-9a7a-4398c1423f93' title='Show/hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-array-preview xr-preview'\u003e\u003cspan\u003edask.array\u0026lt;chunksize=(1, 212, 656), meta=np.ndarray\u0026gt;\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-array-data'\u003e\u003ctable\u003e\n    \u003ctr\u003e\n        \u003ctd\u003e\n            \u003ctable style=\"border-collapse: collapse;\"\u003e\n                \u003cthead\u003e\n                    \u003ctr\u003e\n                        \u003ctd\u003e \u003c/td\u003e\n                        \u003cth\u003e Array \u003c/th\u003e\n                        \u003cth\u003e Chunk \u003c/th\u003e\n                    \u003c/tr\u003e\n                \u003c/thead\u003e\n                \u003ctbody\u003e\n                    \n                    \u003ctr\u003e\n                        \u003cth\u003e Bytes \u003c/th\u003e\n                        \u003ctd\u003e 1.49 GiB \u003c/td\u003e\n                        \u003ctd\u003e 32.00 MiB \u003c/td\u003e\n                    \u003c/tr\u003e\n                    \n                    \u003ctr\u003e\n                        \u003cth\u003e Shape \u003c/th\u003e\n                        \u003ctd\u003e (8, 5000, 5000) \u003c/td\u003e\n                        \u003ctd\u003e (1, 2048, 2048) \u003c/td\u003e\n                    \u003c/tr\u003e\n                    \u003ctr\u003e\n                        \u003cth\u003e Dask graph \u003c/th\u003e\n                        \u003ctd colspan=\"2\"\u003e 128 chunks in 56 graph layers \u003c/td\u003e\n                    \u003c/tr\u003e\n                    \u003ctr\u003e\n                        \u003cth\u003e Data type \u003c/th\u003e\n                        \u003ctd colspan=\"2\"\u003e float64 numpy.ndarray \u003c/td\u003e\n                    \u003c/tr\u003e\n                \u003c/tbody\u003e\n            \u003c/table\u003e\n        \u003c/td\u003e\n        \u003ctd\u003e\n        \u003csvg width=\"194\" height=\"184\" style=\"stroke:rgb(0,0,0);stroke-width:1\" \u003e\n\n  \u003c!-- Horizontal lines --\u003e\n  \u003cline x1=\"10\" y1=\"0\" x2=\"24\" y2=\"14\" style=\"stroke-width:2\" /\u003e\n  \u003cline x1=\"10\" y1=\"5\" x2=\"24\" y2=\"20\" /\u003e\n  \u003cline x1=\"10\" y1=\"54\" x2=\"24\" y2=\"69\" /\u003e\n  \u003cline x1=\"10\" y1=\"103\" x2=\"24\" y2=\"118\" /\u003e\n  \u003cline x1=\"10\" y1=\"120\" x2=\"24\" y2=\"134\" style=\"stroke-width:2\" /\u003e\n\n  \u003c!-- Vertical lines --\u003e\n  \u003cline x1=\"10\" y1=\"0\" x2=\"10\" y2=\"120\" style=\"stroke-width:2\" /\u003e\n  \u003cline x1=\"11\" y1=\"1\" x2=\"11\" y2=\"121\" /\u003e\n  \u003cline x1=\"13\" y1=\"3\" x2=\"13\" y2=\"123\" /\u003e\n  \u003cline x1=\"15\" y1=\"5\" x2=\"15\" y2=\"125\" /\u003e\n  \u003cline x1=\"17\" y1=\"7\" x2=\"17\" y2=\"127\" /\u003e\n  \u003cline x1=\"19\" y1=\"9\" x2=\"19\" y2=\"129\" /\u003e\n  \u003cline x1=\"21\" y1=\"11\" x2=\"21\" y2=\"131\" /\u003e\n  \u003cline x1=\"23\" y1=\"13\" x2=\"23\" y2=\"133\" /\u003e\n  \u003cline x1=\"24\" y1=\"14\" x2=\"24\" y2=\"134\" style=\"stroke-width:2\" /\u003e\n\n  \u003c!-- Colored Rectangle --\u003e\n  \u003cpolygon points=\"10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,134.9485979497544 10.0,120.0\" style=\"fill:#ECB172A0;stroke-width:0\"/\u003e\n\n  \u003c!-- Horizontal lines --\u003e\n  \u003cline x1=\"10\" y1=\"0\" x2=\"130\" y2=\"0\" style=\"stroke-width:2\" /\u003e\n  \u003cline x1=\"11\" y1=\"1\" x2=\"131\" y2=\"1\" /\u003e\n  \u003cline x1=\"13\" y1=\"3\" x2=\"133\" y2=\"3\" /\u003e\n  \u003cline x1=\"15\" y1=\"5\" x2=\"135\" y2=\"5\" /\u003e\n  \u003cline x1=\"17\" y1=\"7\" x2=\"137\" y2=\"7\" /\u003e\n  \u003cline x1=\"19\" y1=\"9\" x2=\"139\" y2=\"9\" /\u003e\n  \u003cline x1=\"21\" y1=\"11\" x2=\"141\" y2=\"11\" /\u003e\n  \u003cline x1=\"23\" y1=\"13\" x2=\"143\" y2=\"13\" /\u003e\n  \u003cline x1=\"24\" y1=\"14\" x2=\"144\" y2=\"14\" style=\"stroke-width:2\" /\u003e\n\n  \u003c!-- Vertical lines --\u003e\n  \u003cline x1=\"10\" y1=\"0\" x2=\"24\" y2=\"14\" style=\"stroke-width:2\" /\u003e\n  \u003cline x1=\"25\" y1=\"0\" x2=\"40\" y2=\"14\" /\u003e\n  \u003cline x1=\"74\" y1=\"0\" x2=\"89\" y2=\"14\" /\u003e\n  \u003cline x1=\"124\" y1=\"0\" x2=\"138\" y2=\"14\" /\u003e\n  \u003cline x1=\"130\" y1=\"0\" x2=\"144\" y2=\"14\" style=\"stroke-width:2\" /\u003e\n\n  \u003c!-- Colored Rectangle --\u003e\n  \u003cpolygon points=\"10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403\" style=\"fill:#ECB172A0;stroke-width:0\"/\u003e\n\n  \u003c!-- Horizontal lines --\u003e\n  \u003cline x1=\"24\" y1=\"14\" x2=\"144\" y2=\"14\" style=\"stroke-width:2\" /\u003e\n  \u003cline x1=\"24\" y1=\"20\" x2=\"144\" y2=\"20\" /\u003e\n  \u003cline x1=\"24\" y1=\"69\" x2=\"144\" y2=\"69\" /\u003e\n  \u003cline x1=\"24\" y1=\"118\" x2=\"144\" y2=\"118\" /\u003e\n  \u003cline x1=\"24\" y1=\"134\" x2=\"144\" y2=\"134\" style=\"stroke-width:2\" /\u003e\n\n  \u003c!-- Vertical lines --\u003e\n  \u003cline x1=\"24\" y1=\"14\" x2=\"24\" y2=\"134\" style=\"stroke-width:2\" /\u003e\n  \u003cline x1=\"40\" y1=\"14\" x2=\"40\" y2=\"134\" /\u003e\n  \u003cline x1=\"89\" y1=\"14\" x2=\"89\" y2=\"134\" /\u003e\n  \u003cline x1=\"138\" y1=\"14\" x2=\"138\" y2=\"134\" /\u003e\n  \u003cline x1=\"144\" y1=\"14\" x2=\"144\" y2=\"134\" style=\"stroke-width:2\" /\u003e\n\n  \u003c!-- Colored Rectangle --\u003e\n  \u003cpolygon points=\"24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,134.9485979497544 24.9485979497544,134.9485979497544\" style=\"fill:#ECB172A0;stroke-width:0\"/\u003e\n\n  \u003c!-- Text --\u003e\n  \u003ctext x=\"84.948598\" y=\"154.948598\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" \u003e5000\u003c/text\u003e\n  \u003ctext x=\"164.948598\" y=\"74.948598\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(-90,164.948598,74.948598)\"\u003e5000\u003c/text\u003e\n  \u003ctext x=\"7.474299\" y=\"147.474299\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(45,7.474299,147.474299)\"\u003e8\u003c/text\u003e\n\u003c/svg\u003e\n        \u003c/td\u003e\n    \u003c/tr\u003e\n\u003c/table\u003e\u003c/div\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-67273609-8657-4775-9cf3-07a2e59af055' class='xr-section-summary-in' type='checkbox'  checked\u003e\u003clabel for='section-67273609-8657-4775-9cf3-07a2e59af055' class='xr-section-summary' \u003eCoordinates: \u003cspan\u003e(4)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cul class='xr-var-list'\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan\u003efrequency\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e()\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003e\u0026lt;U1\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e\u0026#x27;A\u0026#x27;\u003c/div\u003e\u003cinput id='attrs-d173fb57-2feb-4049-bd05-3e16bc7b0fa7' class='xr-var-attrs-in' type='checkbox' disabled\u003e\u003clabel for='attrs-d173fb57-2feb-4049-bd05-3e16bc7b0fa7' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-ea58672c-cb44-40e4-a2de-d44255efb791' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-ea58672c-cb44-40e4-a2de-d44255efb791' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray(\u0026#x27;A\u0026#x27;, dtype=\u0026#x27;\u0026lt;U1\u0026#x27;)\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan class='xr-has-index'\u003ey\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e(y)\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003efloat64\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e9.7e+06 9.7e+06 ... 9.6e+06 9.6e+06\u003c/div\u003e\u003cinput id='attrs-a1f79ea9-ffe4-4431-b0e5-bc6bee456f5c' class='xr-var-attrs-in' type='checkbox' disabled\u003e\u003clabel for='attrs-a1f79ea9-ffe4-4431-b0e5-bc6bee456f5c' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-67e8b215-2422-4390-b4c3-f42647ab0ecf' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-67e8b215-2422-4390-b4c3-f42647ab0ecf' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray([9699990., 9699970., 9699950., ..., 9600050., 9600030., 9600010.],\n      shape=(5000,))\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan class='xr-has-index'\u003ex\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e(x)\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003efloat64\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e4e+05 4e+05 4e+05 ... 5e+05 5e+05\u003c/div\u003e\u003cinput id='attrs-21441c07-832e-4a3f-8857-d3dcacba0527' class='xr-var-attrs-in' type='checkbox' disabled\u003e\u003clabel for='attrs-21441c07-832e-4a3f-8857-d3dcacba0527' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-4f392b0d-747a-493e-a8b7-cbcb520b2157' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-4f392b0d-747a-493e-a8b7-cbcb520b2157' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray([400010., 400030., 400050., ..., 499950., 499970., 499990.],\n      shape=(5000,))\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan class='xr-has-index'\u003etime\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e(time)\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003edatetime64[ns]\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e2025-11-02T22:06:39 ... 2025-11-...\u003c/div\u003e\u003cinput id='attrs-c7f9f66f-e49b-478e-b82e-800bca7d29fe' class='xr-var-attrs-in' type='checkbox' disabled\u003e\u003clabel for='attrs-c7f9f66f-e49b-478e-b82e-800bca7d29fe' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-f55c6273-569d-4ba4-bd79-11a9ffc8d6c1' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-f55c6273-569d-4ba4-bd79-11a9ffc8d6c1' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray([\u0026#x27;2025-11-02T22:06:39.000000000\u0026#x27;, \u0026#x27;2025-11-03T22:06:39.000000000\u0026#x27;,\n       \u0026#x27;2025-11-04T22:06:39.000000000\u0026#x27;, \u0026#x27;2025-11-05T22:06:39.000000000\u0026#x27;,\n       \u0026#x27;2025-11-06T22:06:39.000000000\u0026#x27;, \u0026#x27;2025-11-07T22:06:39.000000000\u0026#x27;,\n       \u0026#x27;2025-11-08T22:06:39.000000000\u0026#x27;, \u0026#x27;2025-11-09T22:06:39.000000000\u0026#x27;],\n      dtype=\u0026#x27;datetime64[ns]\u0026#x27;)\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-0f232d98-f464-4e82-a97a-b93307e45a6e' class='xr-section-summary-in' type='checkbox'  \u003e\u003clabel for='section-0f232d98-f464-4e82-a97a-b93307e45a6e' class='xr-section-summary' \u003eIndexes: \u003cspan\u003e(3)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cul class='xr-var-list'\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-index-name'\u003e\u003cdiv\u003ey\u003c/div\u003e\u003c/div\u003e\u003cdiv class='xr-index-preview'\u003ePandasIndex\u003c/div\u003e\u003cinput type='checkbox' disabled/\u003e\u003clabel\u003e\u003c/label\u003e\u003cinput id='index-b9a565c0-354a-4e36-a562-0108b6d6e1d4' class='xr-index-data-in' type='checkbox'/\u003e\u003clabel for='index-b9a565c0-354a-4e36-a562-0108b6d6e1d4' title='Show/Hide index repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-index-data'\u003e\u003cpre\u003ePandasIndex(Index([9699990.0, 9699970.0, 9699950.0, 9699930.0, 9699910.0, 9699890.0,\n       9699870.0, 9699850.0, 9699830.0, 9699810.0,\n       ...\n       9600190.0, 9600170.0, 9600150.0, 9600130.0, 9600110.0, 9600090.0,\n       9600070.0, 9600050.0, 9600030.0, 9600010.0],\n      dtype=\u0026#x27;float64\u0026#x27;, name=\u0026#x27;y\u0026#x27;, length=5000))\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-index-name'\u003e\u003cdiv\u003ex\u003c/div\u003e\u003c/div\u003e\u003cdiv class='xr-index-preview'\u003ePandasIndex\u003c/div\u003e\u003cinput type='checkbox' disabled/\u003e\u003clabel\u003e\u003c/label\u003e\u003cinput id='index-7899b57f-50d6-4de6-80e8-00ad8daa5099' class='xr-index-data-in' type='checkbox'/\u003e\u003clabel for='index-7899b57f-50d6-4de6-80e8-00ad8daa5099' title='Show/Hide index repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-index-data'\u003e\u003cpre\u003ePandasIndex(Index([400010.0, 400030.0, 400050.0, 400070.0, 400090.0, 400110.0, 400130.0,\n       400150.0, 400170.0, 400190.0,\n       ...\n       499810.0, 499830.0, 499850.0, 499870.0, 499890.0, 499910.0, 499930.0,\n       499950.0, 499970.0, 499990.0],\n      dtype=\u0026#x27;float64\u0026#x27;, name=\u0026#x27;x\u0026#x27;, length=5000))\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-index-name'\u003e\u003cdiv\u003etime\u003c/div\u003e\u003c/div\u003e\u003cdiv class='xr-index-preview'\u003ePandasIndex\u003c/div\u003e\u003cinput type='checkbox' disabled/\u003e\u003clabel\u003e\u003c/label\u003e\u003cinput id='index-598e4e8b-0d97-430c-b7d7-12f6ea4f14cf' class='xr-index-data-in' type='checkbox'/\u003e\u003clabel for='index-598e4e8b-0d97-430c-b7d7-12f6ea4f14cf' title='Show/Hide index repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-index-data'\u003e\u003cpre\u003ePandasIndex(DatetimeIndex([\u0026#x27;2025-11-02 22:06:39\u0026#x27;, \u0026#x27;2025-11-03 22:06:39\u0026#x27;,\n               \u0026#x27;2025-11-04 22:06:39\u0026#x27;, \u0026#x27;2025-11-05 22:06:39\u0026#x27;,\n               \u0026#x27;2025-11-06 22:06:39\u0026#x27;, \u0026#x27;2025-11-07 22:06:39\u0026#x27;,\n               \u0026#x27;2025-11-08 22:06:39\u0026#x27;, \u0026#x27;2025-11-09 22:06:39\u0026#x27;],\n              dtype=\u0026#x27;datetime64[ns]\u0026#x27;, name=\u0026#x27;time\u0026#x27;, freq=\u0026#x27;D\u0026#x27;))\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-97147824-8d88-47d8-a8e6-c8663d20ed36' class='xr-section-summary-in' type='checkbox'  checked\u003e\u003clabel for='section-97147824-8d88-47d8-a8e6-c8663d20ed36' class='xr-section-summary' \u003eAttributes: \u003cspan\u003e(2)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cdl class='xr-attrs'\u003e\u003cdt\u003e\u003cspan\u003esource :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003eNISAR L2 GCOV\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003eprojection :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003e32721\u003c/dd\u003e\u003c/dl\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"\u003cxarray.DataArray 'HVHV' (time: 8, y: 5000, x: 5000)\u003e Size: 2GB\ndask.array\u003cgetitem, shape=(8, 5000, 5000), dtype=float64, chunksize=(1, 2048, 2048), chunktype=numpy.ndarray\u003e\nCoordinates:\n    frequency  \u003cU1 4B 'A'\n  * y          (y) float64 40kB 9.7e+06 9.7e+06 9.7e+06 ... 9.6e+06 9.6e+06\n  * x          (x) float64 40kB 4e+05 4e+05 4e+05 ... 5e+05 5e+05 5e+05\n  * time       (time) datetime64[ns] 64B 2025-11-02T22:06:39 ... 2025-11-09T2...\nAttributes:\n    source:      NISAR L2 GCOV\n    projection:  32721","content_type":"text/plain"}}}],"key":"hQj7YOY22W"}],"key":"yAXIddrXjK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# pol = polarization.value\n# print(f'polarization: {pol}')","key":"R2OtQoeq7f"},{"type":"output","id":"dASSouy97XWVIisrWJ78g","data":[],"key":"tg6aPn5AfG"}],"key":"IjPtQUMMKK"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create a wildcard path to the tiffs:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q5y8W5GvPJ"}],"key":"wqd3apRoI2"}],"key":"Upo52WZcWn"}],"key":"YGfskXjDrP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# if pol == 'VV':\n#     wildcard_path = f\"{tiff_dir}/*VV*.tif*\"\n# else:\n#     wildcard_path = f\"{tiff_dir}/*VH*.tif*\"\n# print(f'wildcard_path: \\n{wildcard_path}')","key":"XNdyw29I5j"},{"type":"output","id":"a5sJygclQSzpcUa_ebirZ","data":[],"key":"zbOBOaMuNd"}],"key":"f6jmL3n2UO"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Write a function to extract the tiff dates from a wildcard path.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zQ7Mf3TUM5"}],"key":"X8dzrUcRR8"}],"key":"TJgNhyzraD"}],"key":"IxnZkrN9vR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# def get_date(pth):\n#     date_regex = r'(?\u003c=_)\\d{8}(?=T\\d{6})'\n#     try:\n#         return re.search(date_regex, str(pth)).group(0)\n#     except AttributeError:\n#         raise Exception(f\"Date string not found in {pth}\")","key":"UyMLqmRZCe"},{"type":"output","id":"1FPA5IUN_C4aD6SuDkpp-","data":[],"key":"U0B2uRwavy"}],"key":"I4bzQ1Blf0"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Call get_dates() to collect the product acquisition dates:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c4ALudvF2T"}],"key":"m8IFCowm0P"}],"key":"Im1nmczRVl"}],"key":"qEVSSAYfTH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# file_ext = None\n# if pol == 'VV':\n#     file_ext = f'*VV*.tif*'\n# else:\n#     file_ext = f'*VH*.tif*'\n\n# dates = sorted([get_date(d) for d in tiff_dir.rglob(file_ext)])\n# print(f'dates: \\n{dates}')","key":"WCiatcuWDb"},{"type":"output","id":"y3W-3RzKAVGdcG6neatLA","data":[],"key":"W1yk95R30R"}],"key":"jKQFxFddS4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2. Create the VRTs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Fo36mivqEk"}],"identifier":"id-2-create-the-vrts","label":"2. Create the VRTs","html_id":"id-2-create-the-vrts","implicit":true,"key":"Z149eYzoLR"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Create the virtual raster table for the GeoTiffs:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"n08vkdUF0S"}],"key":"va7T4iKeS5"}],"key":"HKXUYjOFQA"}],"key":"JStWAHUPgM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# raster_path = f\"{analysis_dir}/raster_stack_{pol}.vrt\"\n# !gdalbuildvrt -separate $raster_path $wildcard_path","key":"ZhBPdBsUsA"},{"type":"output","id":"8is8JEJtNfiOuMLP8eqja","data":[],"key":"iNUYdrKZ6s"}],"key":"zyxNduie6S"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3. Define Some Python Helper Functions for this Notebook","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BZsxF4NuFN"}],"identifier":"id-3-define-some-python-helper-functions-for-this-notebook","label":"3. Define Some Python Helper Functions for this Notebook","html_id":"id-3-define-some-python-helper-functions-for-this-notebook","implicit":true,"key":"XjOFeyg1aH"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We are defining two helper functions for this notebook:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YEqbyU0MJw"}],"key":"lcbWnkU4jv"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"CreateGeoTiff()","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"G4LCyFsAJp"}],"key":"MXq8hUXHOm"},{"type":"text","value":" to write out images","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Kd6qX5AZ5A"}],"key":"tOOsgepzBl"}],"key":"rS4lJ1G9T7"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"timeseries_metrics()","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"SdsOG3O78E"}],"key":"s2iUNnxBK4"},{"type":"text","value":" to compute various metrics from a time series data stack","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"EQ3hH2BbhG"}],"key":"IQMtlKlx6D"}],"key":"Zx99cWsbiO"}],"key":"Nt0t8nqQGp"}],"key":"ZRdkStiFk5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def create_geotiff(name, array, data_type, ndv, bandnames=None, \n                   ref_image=None, geo_t=None, projection=None):\n    # If it's a 2D image we fake a third dimension:\n    if len(array.shape) == 2:\n        array = np.array([array])\n    if ref_image == None and (geo_t == None or projection == None):\n        raise RuntimeWarning('ref_image or settings required.')\n    if bandnames != None:\n        if len(bandnames) != array.shape[0]:\n            raise RuntimeError(f'Need {Array.shape[0]} bandnames. {len(bandnames)} given')\n    else:\n        bandnames = [f'Band {i+1}' for i in range(array.shape[0])]\n    if ref_image != None:\n        refimg = gdal.Open(ref_image)\n        geo_t = refimg.GetGeoTransform()\n        Projection = refimg.GetProjection()\n    driver = gdal.GetDriverByName('GTIFF')\n    array[np.isnan(array)] = ndv\n    dataset = driver.Create(name, array.shape[2], array.shape[1], \n                            array.shape[0], data_type)\n    dataset.SetGeoTransform(geo_t)\n    dataset.SetProjection(projection)\n    for i, image in enumerate(array, 1):\n        dataset.GetRasterBand(i).WriteArray(image)\n        dataset.GetRasterBand(i).SetNoDataValue(ndv)\n        dataset.SetDescription(bandnames[i-1])\n    dataset.FlushCache()\n    return name","key":"fqHJMwkPR7"},{"type":"output","id":"AGw4oZLuMtN3RNlsSB_cG","data":[],"key":"bwTscIb7s9"}],"key":"YKuIQ7V19i"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"da","key":"H4YL1FMxq5"},{"type":"output","id":"fnZvWmZ9HtVoAyHzxyA-u","data":[],"key":"Q9WOgD4iIo"}],"key":"r4NpVKcilX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# def timeseries_metrics(raster, ndv=np.nan):     \n#     # Make us of numpy nan functions\n#     # Check if type is a float array\n#     if not raster.dtype.name.find('float')\u003e-1:\n#         raster = raster.astype(np.float64)\n#     # Set ndv to nan\n#     if not np.isnan(ndv):\n#         raster[np.equal(raster,ndv)] = np.nan\n#     # Build dictionary of the metrics\n#     tsmetrics={}\n#     rperc = np.nanpercentile(raster,[5,50,95], axis=0)\n#     tsmetrics['mean'] = np.nanmean(raster, axis=0)\n#     tsmetrics['max'] = np.nanmax(raster, axis=0)\n#     tsmetrics['min'] = np.nanmin(raster, axis=0)\n#     tsmetrics['range'] = tsmetrics['max'] - tsmetrics['min']\n#     tsmetrics['median'] = rperc[1]\n#     tsmetrics['p5'] = rperc[0]\n#     tsmetrics['p95'] = rperc[2]\n#     tsmetrics['prange'] = rperc[2]-rperc[0]\n    # tsmetrics['var'] = np.nanvar(raster, axis=0)\n    # tsmetrics['std'] = np.sqrt(tsmetrics['var'])\n    # tsmetrics['CV'] = np.abs(tsmetrics['var'] / tsmetrics['mean'])\n#     return tsmetrics","key":"e854PbQSOP"},{"type":"output","id":"CroEyUrD-zwvtyjsG97sE","data":[],"key":"jChLq0JInQ"}],"key":"zj9AWAHlTd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def timeseries_metrics(da):     \n    q = da.quantile([0.05, 0.5, 0.95], dim=\"time\")\n    p05 = q.sel(quantile=0.05, drop=True)\n    p50 = q.sel(quantile=0.50, drop=True)\n    p95 = q.sel(quantile=0.95, drop=True)\n    prange = p95 - p05\n    \n    max = da.max(dim=\"time\")\n    min = da.min(dim=\"time\")\n    range = max - min\n\n    mean = da.mean(dim=\"time\")\n    var = da.var(dim=\"time\")\n    std = da.std(dim=\"time\")\n    cv = std / xr.where(mean != 0, mean, np.nan)\n    \n    return xr.Dataset(\n        dict(\n            min=min, max=max, range=range,\n            mean=mean, var=var, std=std, CV=cv,\n            p05=p05, p50=p50, p95=p95,\n            prange=p95 - p05\n        )\n    )","key":"ylL1Fr5xFq"},{"type":"output","id":"YQ4h3ubmyv1ful2txM9yk","data":[],"key":"RIjx23OR7P"}],"key":"jJkWYnPpra"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"4. Create a Pandas Time Index and Display the VRT Band Dates","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C6oHEdR01n"}],"identifier":"id-4-create-a-pandas-time-index-and-display-the-vrt-band-dates","label":"4. Create a Pandas Time Index and Display the VRT Band Dates","html_id":"id-4-create-a-pandas-time-index-and-display-the-vrt-band-dates","implicit":true,"key":"qLCHpOIZst"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Create an index of timedelta64 data with Pandas:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bXbjIMrnR5"}],"key":"WKA4SAKJPJ"}],"key":"rr7uccmzpl"}],"key":"dPhot1wUgP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# tindex = pd.DatetimeIndex(dates)","key":"lEnQUHOpRx"},{"type":"output","id":"aWnWE28yaR7e4zrteCg3e","data":[],"key":"T0R9wHsNkM"}],"key":"cZ67Yangpk"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Print the bands and dates for all images in the virtual raster table (VRT):","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"S6mrUZlx9Z"}],"key":"pWUimOjavV"}],"key":"yadZmAXKfl"}],"key":"cCuRMgcYPj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# j = 1\n# print(f\"Bands and dates for {raster_path}\")\n# for i in tindex:\n#     print(\"{:4d} {}\".format(j, i.date()), end=' ')\n#     j += 1\n#     if j%5 == 1:\n#         print()","key":"vMU5PEHexU"},{"type":"output","id":"uPHAng1_Khq7bFygT8tIL","data":[],"key":"eLLZV0bq7g"}],"key":"dRNZyLVpOf"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C1ujPdTi78"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"4. Create a Time Series Animation to get an Idea of the Dynamics at the Site","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"rQyhuCDBdG"}],"identifier":"id-4-create-a-time-series-animation-to-get-an-idea-of-the-dynamics-at-the-site","label":"4. Create a Time Series Animation to get an Idea of the Dynamics at the Site","html_id":"id-4-create-a-time-series-animation-to-get-an-idea-of-the-dynamics-at-the-site","implicit":true,"key":"mpO9H5SNRL"},{"type":"heading","depth":3,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"4.1 Load Time Series Stack","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"sJ1AWAwPU4"}],"identifier":"id-4-1-load-time-series-stack","label":"4.1 Load Time Series Stack","html_id":"id-4-1-load-time-series-stack","implicit":true,"key":"aashemLcLz"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Now we are ready to create a time series animation from the calibrated SAR data.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"BvxomkRIma"}],"key":"XJd2MPOZQ3"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"First, create a raster from band 0 and a raster stack from all the images:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"CaTOjxN5yO"}],"key":"uuRJomtiGQ"}],"key":"qdmfA7eGqH"}],"key":"Pe2IaI8Uzd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# img = gdal.Open(raster_path)\n# band = img.GetRasterBand(1)\n# raster0 = band.ReadAsArray()\n# band_number = 0 # Needed for updates\n# rasterstack = img.ReadAsArray()","key":"EEnoPQ4MLg"},{"type":"output","id":"9FS2pK_m4g-UEmXFEpOWR","data":[],"key":"p0H7oN6m2k"}],"key":"wrcQW2MOIB"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Print the bands, pixels, and lines:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Fvz6Tv4Adg"}],"key":"pZCkTxI8f0"}],"key":"Lwecc9UuIF"}],"key":"wNqEb2EUvM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# print(f\"Number of  bands: {img.RasterCount}\")\n# print(f\"Number of pixels: {img.RasterXSize}\")\n# print(f\"Number of  lines: {img.RasterYSize}\")","key":"lnPsYYqLaT"},{"type":"output","id":"g13yjhpvBRm0eXOzcMCxI","data":[],"key":"gOuJuYm93O"}],"key":"BEw2hbXLrt"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"4.2 Data Conversion between dB and Power Scales","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HFMoqV2vzU"}],"identifier":"id-4-2-data-conversion-between-db-and-power-scales","label":"4.2 Data Conversion between dB and Power Scales","html_id":"id-4-2-data-conversion-between-db-and-power-scales","implicit":true,"key":"LPMByGb3me"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The data at hand are radiometrically terrain corrected images, which are often expressed as terrain flattened ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HQJG06LksM"},{"type":"inlineMath","value":"\\gamma^0","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi\u003eγ\u003c/mi\u003e\u003cmn\u003e0\u003c/mn\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\gamma^0\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0085em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05556em;\"\u003eγ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"GNbcl57qHL"},{"type":"text","value":" backscattering coefficients. For forest and land cover monitoring applications ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PMtgGXXcGD"},{"type":"inlineMath","value":"\\gamma^0","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi\u003eγ\u003c/mi\u003e\u003cmn\u003e0\u003c/mn\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\gamma^0\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0085em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05556em;\"\u003eγ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"FXD52eDHPo"},{"type":"text","value":" is the preferred metric.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UwF2GvFed7"}],"key":"zG9rT8Lske"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"To use a logarithmic scale instead of the natural power scale, ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"z4wK2SPZqE"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"you can set the following variable to True:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NM9m8dHRin"}],"key":"SaK4xKds3I"}],"key":"YoUvAeihpm"}],"key":"ib7W37gg9z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# todB = True\n\n# labeldB = 'dB' if todB else 'linear'\n\n# def convert(raster, todB=todB):\n#     if todB:\n#         return 10 * np.ma.log10(raster)\n#     else:\n#         return raster","key":"LHVlWJhb8g"},{"type":"output","id":"I1LVkrFclS_RviBEtqHjz","data":[],"key":"DRDoKt3nxO"}],"key":"NiiVoFEKco"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nda_db = 10*np.log10(da)\nda_db","key":"FABhA7otZp"},{"type":"output","id":"US4zKt0i_iPQS05DDxnDx","data":[{"name":"stdout","output_type":"stream","text":"CPU times: user 1.85 ms, sys: 0 ns, total: 1.85 ms\nWall time: 1.85 ms\n"},{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\u003csvg style=\"position: absolute; width: 0; height: 0; overflow: hidden\"\u003e\n\u003cdefs\u003e\n\u003csymbol id=\"icon-database\" viewBox=\"0 0 32 32\"\u003e\n\u003cpath d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"\u003e\u003c/path\u003e\n\u003c/symbol\u003e\n\u003csymbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\"\u003e\n\u003cpath d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003c/symbol\u003e\n\u003c/defs\u003e\n\u003c/svg\u003e\n\u003cstyle\u003e/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header \u003e div,\n.xr-header \u003e ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary \u003e span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label \u003e span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap \u003e label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item \u003e div,\n.xr-var-item label,\n.xr-var-item \u003e .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item \u003e .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list \u003e li:nth-child(odd) \u003e div,\n.xr-var-list \u003e li:nth-child(odd) \u003e label,\n.xr-var-list \u003e li:nth-child(odd) \u003e .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data \u003e table {\n  float: right;\n}\n\n.xr-var-data \u003e pre,\n.xr-index-data \u003e pre,\n.xr-var-data \u003e table \u003e tbody \u003e tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label \u003e .xr-icon-file-text2,\n.xr-var-data-in:checked + label \u003e .xr-icon-database,\n.xr-index-data-in:checked + label \u003e .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n\u003c/style\u003e\u003cpre class='xr-text-repr-fallback'\u003e\u0026lt;xarray.DataArray \u0026#x27;HVHV\u0026#x27; (time: 8, y: 5000, x: 5000)\u0026gt; Size: 2GB\ndask.array\u0026lt;mul, shape=(8, 5000, 5000), dtype=float64, chunksize=(1, 2048, 2048), chunktype=numpy.ndarray\u0026gt;\nCoordinates:\n    frequency  \u0026lt;U1 4B \u0026#x27;A\u0026#x27;\n  * y          (y) float64 40kB 9.7e+06 9.7e+06 9.7e+06 ... 9.6e+06 9.6e+06\n  * x          (x) float64 40kB 4e+05 4e+05 4e+05 ... 5e+05 5e+05 5e+05\n  * time       (time) datetime64[ns] 64B 2025-11-02T22:06:39 ... 2025-11-09T2...\u003c/pre\u003e\u003cdiv class='xr-wrap' style='display:none'\u003e\u003cdiv class='xr-header'\u003e\u003cdiv class='xr-obj-type'\u003exarray.DataArray\u003c/div\u003e\u003cdiv class='xr-array-name'\u003e'HVHV'\u003c/div\u003e\u003cul class='xr-dim-list'\u003e\u003cli\u003e\u003cspan class='xr-has-index'\u003etime\u003c/span\u003e: 8\u003c/li\u003e\u003cli\u003e\u003cspan class='xr-has-index'\u003ey\u003c/span\u003e: 5000\u003c/li\u003e\u003cli\u003e\u003cspan class='xr-has-index'\u003ex\u003c/span\u003e: 5000\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003cul class='xr-sections'\u003e\u003cli class='xr-section-item'\u003e\u003cdiv class='xr-array-wrap'\u003e\u003cinput id='section-ddc502df-8d91-4d10-b478-b6bf659a05ca' class='xr-array-in' type='checkbox' checked\u003e\u003clabel for='section-ddc502df-8d91-4d10-b478-b6bf659a05ca' title='Show/hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-array-preview xr-preview'\u003e\u003cspan\u003edask.array\u0026lt;chunksize=(1, 212, 656), meta=np.ndarray\u0026gt;\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-array-data'\u003e\u003ctable\u003e\n    \u003ctr\u003e\n        \u003ctd\u003e\n            \u003ctable style=\"border-collapse: collapse;\"\u003e\n                \u003cthead\u003e\n                    \u003ctr\u003e\n                        \u003ctd\u003e \u003c/td\u003e\n                        \u003cth\u003e Array \u003c/th\u003e\n                        \u003cth\u003e Chunk \u003c/th\u003e\n                    \u003c/tr\u003e\n                \u003c/thead\u003e\n                \u003ctbody\u003e\n                    \n                    \u003ctr\u003e\n                        \u003cth\u003e Bytes \u003c/th\u003e\n                        \u003ctd\u003e 1.49 GiB \u003c/td\u003e\n                        \u003ctd\u003e 32.00 MiB \u003c/td\u003e\n                    \u003c/tr\u003e\n                    \n                    \u003ctr\u003e\n                        \u003cth\u003e Shape \u003c/th\u003e\n                        \u003ctd\u003e (8, 5000, 5000) \u003c/td\u003e\n                        \u003ctd\u003e (1, 2048, 2048) \u003c/td\u003e\n                    \u003c/tr\u003e\n                    \u003ctr\u003e\n                        \u003cth\u003e Dask graph \u003c/th\u003e\n                        \u003ctd colspan=\"2\"\u003e 128 chunks in 58 graph layers \u003c/td\u003e\n                    \u003c/tr\u003e\n                    \u003ctr\u003e\n                        \u003cth\u003e Data type \u003c/th\u003e\n                        \u003ctd colspan=\"2\"\u003e float64 numpy.ndarray \u003c/td\u003e\n                    \u003c/tr\u003e\n                \u003c/tbody\u003e\n            \u003c/table\u003e\n        \u003c/td\u003e\n        \u003ctd\u003e\n        \u003csvg width=\"194\" height=\"184\" style=\"stroke:rgb(0,0,0);stroke-width:1\" \u003e\n\n  \u003c!-- Horizontal lines --\u003e\n  \u003cline x1=\"10\" y1=\"0\" x2=\"24\" y2=\"14\" style=\"stroke-width:2\" /\u003e\n  \u003cline x1=\"10\" y1=\"5\" x2=\"24\" y2=\"20\" /\u003e\n  \u003cline x1=\"10\" y1=\"54\" x2=\"24\" y2=\"69\" /\u003e\n  \u003cline x1=\"10\" y1=\"103\" x2=\"24\" y2=\"118\" /\u003e\n  \u003cline x1=\"10\" y1=\"120\" x2=\"24\" y2=\"134\" style=\"stroke-width:2\" /\u003e\n\n  \u003c!-- Vertical lines --\u003e\n  \u003cline x1=\"10\" y1=\"0\" x2=\"10\" y2=\"120\" style=\"stroke-width:2\" /\u003e\n  \u003cline x1=\"11\" y1=\"1\" x2=\"11\" y2=\"121\" /\u003e\n  \u003cline x1=\"13\" y1=\"3\" x2=\"13\" y2=\"123\" /\u003e\n  \u003cline x1=\"15\" y1=\"5\" x2=\"15\" y2=\"125\" /\u003e\n  \u003cline x1=\"17\" y1=\"7\" x2=\"17\" y2=\"127\" /\u003e\n  \u003cline x1=\"19\" y1=\"9\" x2=\"19\" y2=\"129\" /\u003e\n  \u003cline x1=\"21\" y1=\"11\" x2=\"21\" y2=\"131\" /\u003e\n  \u003cline x1=\"23\" y1=\"13\" x2=\"23\" y2=\"133\" /\u003e\n  \u003cline x1=\"24\" y1=\"14\" x2=\"24\" y2=\"134\" style=\"stroke-width:2\" /\u003e\n\n  \u003c!-- Colored Rectangle --\u003e\n  \u003cpolygon points=\"10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,134.9485979497544 10.0,120.0\" style=\"fill:#ECB172A0;stroke-width:0\"/\u003e\n\n  \u003c!-- Horizontal lines --\u003e\n  \u003cline x1=\"10\" y1=\"0\" x2=\"130\" y2=\"0\" style=\"stroke-width:2\" /\u003e\n  \u003cline x1=\"11\" y1=\"1\" x2=\"131\" y2=\"1\" /\u003e\n  \u003cline x1=\"13\" y1=\"3\" x2=\"133\" y2=\"3\" /\u003e\n  \u003cline x1=\"15\" y1=\"5\" x2=\"135\" y2=\"5\" /\u003e\n  \u003cline x1=\"17\" y1=\"7\" x2=\"137\" y2=\"7\" /\u003e\n  \u003cline x1=\"19\" y1=\"9\" x2=\"139\" y2=\"9\" /\u003e\n  \u003cline x1=\"21\" y1=\"11\" x2=\"141\" y2=\"11\" /\u003e\n  \u003cline x1=\"23\" y1=\"13\" x2=\"143\" y2=\"13\" /\u003e\n  \u003cline x1=\"24\" y1=\"14\" x2=\"144\" y2=\"14\" style=\"stroke-width:2\" /\u003e\n\n  \u003c!-- Vertical lines --\u003e\n  \u003cline x1=\"10\" y1=\"0\" x2=\"24\" y2=\"14\" style=\"stroke-width:2\" /\u003e\n  \u003cline x1=\"25\" y1=\"0\" x2=\"40\" y2=\"14\" /\u003e\n  \u003cline x1=\"74\" y1=\"0\" x2=\"89\" y2=\"14\" /\u003e\n  \u003cline x1=\"124\" y1=\"0\" x2=\"138\" y2=\"14\" /\u003e\n  \u003cline x1=\"130\" y1=\"0\" x2=\"144\" y2=\"14\" style=\"stroke-width:2\" /\u003e\n\n  \u003c!-- Colored Rectangle --\u003e\n  \u003cpolygon points=\"10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403\" style=\"fill:#ECB172A0;stroke-width:0\"/\u003e\n\n  \u003c!-- Horizontal lines --\u003e\n  \u003cline x1=\"24\" y1=\"14\" x2=\"144\" y2=\"14\" style=\"stroke-width:2\" /\u003e\n  \u003cline x1=\"24\" y1=\"20\" x2=\"144\" y2=\"20\" /\u003e\n  \u003cline x1=\"24\" y1=\"69\" x2=\"144\" y2=\"69\" /\u003e\n  \u003cline x1=\"24\" y1=\"118\" x2=\"144\" y2=\"118\" /\u003e\n  \u003cline x1=\"24\" y1=\"134\" x2=\"144\" y2=\"134\" style=\"stroke-width:2\" /\u003e\n\n  \u003c!-- Vertical lines --\u003e\n  \u003cline x1=\"24\" y1=\"14\" x2=\"24\" y2=\"134\" style=\"stroke-width:2\" /\u003e\n  \u003cline x1=\"40\" y1=\"14\" x2=\"40\" y2=\"134\" /\u003e\n  \u003cline x1=\"89\" y1=\"14\" x2=\"89\" y2=\"134\" /\u003e\n  \u003cline x1=\"138\" y1=\"14\" x2=\"138\" y2=\"134\" /\u003e\n  \u003cline x1=\"144\" y1=\"14\" x2=\"144\" y2=\"134\" style=\"stroke-width:2\" /\u003e\n\n  \u003c!-- Colored Rectangle --\u003e\n  \u003cpolygon points=\"24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,134.9485979497544 24.9485979497544,134.9485979497544\" style=\"fill:#ECB172A0;stroke-width:0\"/\u003e\n\n  \u003c!-- Text --\u003e\n  \u003ctext x=\"84.948598\" y=\"154.948598\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" \u003e5000\u003c/text\u003e\n  \u003ctext x=\"164.948598\" y=\"74.948598\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(-90,164.948598,74.948598)\"\u003e5000\u003c/text\u003e\n  \u003ctext x=\"7.474299\" y=\"147.474299\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(45,7.474299,147.474299)\"\u003e8\u003c/text\u003e\n\u003c/svg\u003e\n        \u003c/td\u003e\n    \u003c/tr\u003e\n\u003c/table\u003e\u003c/div\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-238992eb-cc01-44b4-9fba-9123eb60f096' class='xr-section-summary-in' type='checkbox'  checked\u003e\u003clabel for='section-238992eb-cc01-44b4-9fba-9123eb60f096' class='xr-section-summary' \u003eCoordinates: \u003cspan\u003e(4)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cul class='xr-var-list'\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan\u003efrequency\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e()\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003e\u0026lt;U1\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e\u0026#x27;A\u0026#x27;\u003c/div\u003e\u003cinput id='attrs-a48be088-2152-40dd-8074-d2c73865d48b' class='xr-var-attrs-in' type='checkbox' disabled\u003e\u003clabel for='attrs-a48be088-2152-40dd-8074-d2c73865d48b' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-b27d11bb-90b8-459b-970c-744b02649704' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-b27d11bb-90b8-459b-970c-744b02649704' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray(\u0026#x27;A\u0026#x27;, dtype=\u0026#x27;\u0026lt;U1\u0026#x27;)\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan class='xr-has-index'\u003ey\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e(y)\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003efloat64\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e9.7e+06 9.7e+06 ... 9.6e+06 9.6e+06\u003c/div\u003e\u003cinput id='attrs-70b41817-84cd-4758-b507-231f0007166c' class='xr-var-attrs-in' type='checkbox' disabled\u003e\u003clabel for='attrs-70b41817-84cd-4758-b507-231f0007166c' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-e8abe9ce-3bc7-4401-9d33-fab9e189d88f' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-e8abe9ce-3bc7-4401-9d33-fab9e189d88f' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray([9699990., 9699970., 9699950., ..., 9600050., 9600030., 9600010.],\n      shape=(5000,))\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan class='xr-has-index'\u003ex\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e(x)\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003efloat64\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e4e+05 4e+05 4e+05 ... 5e+05 5e+05\u003c/div\u003e\u003cinput id='attrs-96f264ad-d0fa-4438-954b-a8b070daa5eb' class='xr-var-attrs-in' type='checkbox' disabled\u003e\u003clabel for='attrs-96f264ad-d0fa-4438-954b-a8b070daa5eb' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-fdd80336-6724-40bb-8bea-623580935448' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-fdd80336-6724-40bb-8bea-623580935448' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray([400010., 400030., 400050., ..., 499950., 499970., 499990.],\n      shape=(5000,))\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan class='xr-has-index'\u003etime\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e(time)\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003edatetime64[ns]\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e2025-11-02T22:06:39 ... 2025-11-...\u003c/div\u003e\u003cinput id='attrs-01e76313-7e4f-4e42-bcd0-a9a6b3e3063b' class='xr-var-attrs-in' type='checkbox' disabled\u003e\u003clabel for='attrs-01e76313-7e4f-4e42-bcd0-a9a6b3e3063b' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-ddf2b624-98b9-41b5-8def-7916de215efa' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-ddf2b624-98b9-41b5-8def-7916de215efa' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray([\u0026#x27;2025-11-02T22:06:39.000000000\u0026#x27;, \u0026#x27;2025-11-03T22:06:39.000000000\u0026#x27;,\n       \u0026#x27;2025-11-04T22:06:39.000000000\u0026#x27;, \u0026#x27;2025-11-05T22:06:39.000000000\u0026#x27;,\n       \u0026#x27;2025-11-06T22:06:39.000000000\u0026#x27;, \u0026#x27;2025-11-07T22:06:39.000000000\u0026#x27;,\n       \u0026#x27;2025-11-08T22:06:39.000000000\u0026#x27;, \u0026#x27;2025-11-09T22:06:39.000000000\u0026#x27;],\n      dtype=\u0026#x27;datetime64[ns]\u0026#x27;)\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-f0fb2123-fc0e-4b22-9fa0-c682cededa20' class='xr-section-summary-in' type='checkbox'  \u003e\u003clabel for='section-f0fb2123-fc0e-4b22-9fa0-c682cededa20' class='xr-section-summary' \u003eIndexes: \u003cspan\u003e(3)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cul class='xr-var-list'\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-index-name'\u003e\u003cdiv\u003ey\u003c/div\u003e\u003c/div\u003e\u003cdiv class='xr-index-preview'\u003ePandasIndex\u003c/div\u003e\u003cinput type='checkbox' disabled/\u003e\u003clabel\u003e\u003c/label\u003e\u003cinput id='index-fc59d5b2-69a9-4b89-b62e-b2ca46241516' class='xr-index-data-in' type='checkbox'/\u003e\u003clabel for='index-fc59d5b2-69a9-4b89-b62e-b2ca46241516' title='Show/Hide index repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-index-data'\u003e\u003cpre\u003ePandasIndex(Index([9699990.0, 9699970.0, 9699950.0, 9699930.0, 9699910.0, 9699890.0,\n       9699870.0, 9699850.0, 9699830.0, 9699810.0,\n       ...\n       9600190.0, 9600170.0, 9600150.0, 9600130.0, 9600110.0, 9600090.0,\n       9600070.0, 9600050.0, 9600030.0, 9600010.0],\n      dtype=\u0026#x27;float64\u0026#x27;, name=\u0026#x27;y\u0026#x27;, length=5000))\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-index-name'\u003e\u003cdiv\u003ex\u003c/div\u003e\u003c/div\u003e\u003cdiv class='xr-index-preview'\u003ePandasIndex\u003c/div\u003e\u003cinput type='checkbox' disabled/\u003e\u003clabel\u003e\u003c/label\u003e\u003cinput id='index-7574224f-b9d0-4da9-acfb-b6904ad832a9' class='xr-index-data-in' type='checkbox'/\u003e\u003clabel for='index-7574224f-b9d0-4da9-acfb-b6904ad832a9' title='Show/Hide index repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-index-data'\u003e\u003cpre\u003ePandasIndex(Index([400010.0, 400030.0, 400050.0, 400070.0, 400090.0, 400110.0, 400130.0,\n       400150.0, 400170.0, 400190.0,\n       ...\n       499810.0, 499830.0, 499850.0, 499870.0, 499890.0, 499910.0, 499930.0,\n       499950.0, 499970.0, 499990.0],\n      dtype=\u0026#x27;float64\u0026#x27;, name=\u0026#x27;x\u0026#x27;, length=5000))\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-index-name'\u003e\u003cdiv\u003etime\u003c/div\u003e\u003c/div\u003e\u003cdiv class='xr-index-preview'\u003ePandasIndex\u003c/div\u003e\u003cinput type='checkbox' disabled/\u003e\u003clabel\u003e\u003c/label\u003e\u003cinput id='index-33780c8e-c811-4c85-a903-ab03b7ddf63c' class='xr-index-data-in' type='checkbox'/\u003e\u003clabel for='index-33780c8e-c811-4c85-a903-ab03b7ddf63c' title='Show/Hide index repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-index-data'\u003e\u003cpre\u003ePandasIndex(DatetimeIndex([\u0026#x27;2025-11-02 22:06:39\u0026#x27;, \u0026#x27;2025-11-03 22:06:39\u0026#x27;,\n               \u0026#x27;2025-11-04 22:06:39\u0026#x27;, \u0026#x27;2025-11-05 22:06:39\u0026#x27;,\n               \u0026#x27;2025-11-06 22:06:39\u0026#x27;, \u0026#x27;2025-11-07 22:06:39\u0026#x27;,\n               \u0026#x27;2025-11-08 22:06:39\u0026#x27;, \u0026#x27;2025-11-09 22:06:39\u0026#x27;],\n              dtype=\u0026#x27;datetime64[ns]\u0026#x27;, name=\u0026#x27;time\u0026#x27;, freq=\u0026#x27;D\u0026#x27;))\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-15692636-44c8-4c9a-8c17-3d0819aec0a3' class='xr-section-summary-in' type='checkbox' disabled \u003e\u003clabel for='section-15692636-44c8-4c9a-8c17-3d0819aec0a3' class='xr-section-summary'  title='Expand/collapse section'\u003eAttributes: \u003cspan\u003e(0)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cdl class='xr-attrs'\u003e\u003c/dl\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"\u003cxarray.DataArray 'HVHV' (time: 8, y: 5000, x: 5000)\u003e Size: 2GB\ndask.array\u003cmul, shape=(8, 5000, 5000), dtype=float64, chunksize=(1, 2048, 2048), chunktype=numpy.ndarray\u003e\nCoordinates:\n    frequency  \u003cU1 4B 'A'\n  * y          (y) float64 40kB 9.7e+06 9.7e+06 9.7e+06 ... 9.6e+06 9.6e+06\n  * x          (x) float64 40kB 4e+05 4e+05 4e+05 ... 5e+05 5e+05 5e+05\n  * time       (time) datetime64[ns] 64B 2025-11-02T22:06:39 ... 2025-11-09T2...","content_type":"text/plain"}}}],"key":"cTcsb9pIT4"}],"key":"NvzlHsMEbf"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"4.3 Create Time Series Animation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tZ4V2GDjpy"}],"identifier":"id-4-3-create-time-series-animation","label":"4.3 Create Time Series Animation","html_id":"id-4-3-create-time-series-animation","implicit":true,"key":"nUuzh1N9Gz"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Create and move into a directory in which to store our plots and animations:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uh6I1Ff0KN"}],"key":"gFfbd7nnS2"}],"key":"Iwaj2f3Fvy"}],"key":"dsIrnBHMmK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# product_path = analysis_dir/f'plots_and_animations'\n\n# if not product_path.exists():\n#     print(f'{product_path} created')\n#     product_path.mkdir()","key":"n2G4owXkdZ"},{"type":"output","id":"OfhUkl6aCPHyt51tPq1gX","data":[],"key":"UxbLjlIS8V"}],"key":"HHohoTazAb"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we can ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zsG0iuFR7W"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"create the information needed to animate our data:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rojsLJhASu"}],"key":"q8FKDsYiVB"}],"key":"g4hKiyP37v"}],"key":"MfZQMvQ7Za"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nfrom matplotlib import pyplot as plt\nfrom matplotlib.animation import FuncAnimation\nfrom matplotlib.animation import FFMpegWriter, PillowWriter\n\nvmin, vmax = (da_db.quantile([0.05, 0.95], skipna=True).values.astype(float))\n\nfig, ax = plt.subplots(figsize=(6, 6))\nframe_0 = da_db.isel(time=0).values\nim = ax.imshow(frame_0, vmin=vmin, vmax=vmax, origin=\"upper\", cmap=\"grey\")\ncb = fig.colorbar(im, ax=ax, label=\"γ⁰ (dB)\")\nax.set_title(np.datetime_as_string(da_db.time.values[0], unit='s'))\nax.set_axis_off()\n\ndef animate(i):\n    frame = da_db.isel(time=i).values\n    im.set_data(frame)\n    ax.set_title(np.datetime_as_string(da_db.time.values[i], unit='s'))\n    return (im,)\n\nani = FuncAnimation(fig, animate, frames=da_db.sizes[\"time\"], interval=300, blit=False)\n\nplt.show()","key":"AexfdxrfAo"},{"type":"output","id":"5bafqlua1TKSIFWLl-7jN","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d022eab9578ec221e699aa3dc4ae40b0","path":"/NISAR_GCOV_Cookbook/build/d022eab9578ec221e699aa3dc4ae40b0.png"},"text/plain":{"content":"\u003cFigure size 600x600 with 2 Axes\u003e","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"CPU times: user 25.2 s, sys: 3.47 s, total: 28.7 s\nWall time: 23.2 s\n"}],"key":"sQH2m1Paev"}],"key":"ATqjIl5O4l"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from IPython.display import HTML\n\nHTML(ani.to_jshtml())","key":"iPgooupCya"},{"type":"output","id":"ABrTK9-hue5HMVVpri9Lo","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"b2878a979469f0075c2ab9ba661b91f0","path":"/NISAR_GCOV_Cookbook/build/b2878a979469f0075c2ab9ba661b91f0.html"},"text/plain":{"content":"\u003cIPython.core.display.HTML object\u003e","content_type":"text/plain"}}}],"key":"XyVtbHweSR"}],"key":"dcQrtO3tAC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# %%capture \n# fig = plt.figure(figsize=(10, 5))\n# ax = fig.subplots()\n# ax.axis('off')\n\n# copyRaster = np.copy(convert(rasterstack))\n# vmin = np.nanpercentile(copyRaster, 1)\n# vmax = np.nanpercentile(copyRaster, 99)\n\n# im = ax.imshow(convert(raster0), cmap='inferno', vmin=vmin, vmax=vmax)\n# cbar = fig.colorbar(im)\n# cbar.set_label(labeldB)\n# ax.set_title(\"{}\".format(tindex[0].date()))\n# plt.rcParams.update({'font.size': 14})\n\n# def animate(i):\n#     ax.set_title(\"{}\".format(tindex[i].date()))\n#     im.set_data(convert(rasterstack[i]))\n\n# # Interval is given in milliseconds\n# ani = animation.FuncAnimation(fig, animate, frames=rasterstack.shape[0], interval=300)","key":"HJY69qI7Ju"},{"type":"output","id":"U-CdvE27aCOs4NDI3u1ob","data":[],"key":"jmZ7XWY3eG"}],"key":"J71xxoRNVE"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Configure matplotlib’s RC settings for the animation:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qUcRjCyIZV"}],"key":"F8d4UlNySN"}],"key":"NPGvAvjXr5"}],"key":"YX01A25PhM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# rc('animation', embed_limit=40971520.0)  # We need to increase the limit maybe to show the entire animation","key":"JID5AaiBdi"},{"type":"output","id":"w0GNlj-nNq5D7v_tIjFY2","data":[],"key":"JKR2Hw7aYK"}],"key":"o4HaqNelly"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create a javascript animation of the time-series running inline in the notebook:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kzgRjdzcBU"}],"key":"DGa2DozxcH"}],"key":"WVEM87AfIo"}],"key":"EXG0ZiENYi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# HTML(ani.to_jshtml())","key":"X0fklSCFDX"},{"type":"output","id":"gdIVC6kjNnwIMVBpYWtCw","data":[],"key":"vlnmwRbseR"}],"key":"kwLq0eCvDR"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Delete the dummy png that was saved to the current working directory while generating the javascript animation in the last code cell.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OhZVZLbctg"}],"key":"MsXrNh6SdB"}],"key":"DQbmnFPibg"}],"key":"YuX8p1w4Er"},{"type":"block","kind":"notebook-code","data":{"hide_input":false},"children":[{"type":"code","lang":"python","executable":true,"value":"# try:\n#     Path('/home/jovyan/notebooks/SAR_Training/English/Master/None0000000.png').unlink()\n# except FileNotFoundError:\n#     pass","key":"nwz59aok0A"},{"type":"output","id":"bBb7S7ojej5is7nIRTndx","data":[],"key":"rkLXTRSUBq"}],"key":"VaBKGceGRg"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Save the animation (animation.gif):","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qlCKBr5ZEi"}],"key":"cqE9V0FDDX"}],"key":"hZBDObIFut"}],"key":"xU4eOZpjyz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ani.save(plot_dir/f'animation.gif', writer='pillow', fps=2)","key":"lH1igjg6I5"},{"type":"output","id":"wsOj4RqYOO1DlgCGV-uVf","data":[],"key":"Su7eRrYQs6"}],"key":"erqh5ikihc"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nYwxmTHQ2D"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"5. Computation and Visualization of Time Series Metrics","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"UaeANJmjxS"}],"identifier":"id-5-computation-and-visualization-of-time-series-metrics","label":"5. Computation and Visualization of Time Series Metrics","html_id":"id-5-computation-and-visualization-of-time-series-metrics","implicit":true,"key":"fCLE9f3GKq"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Once a time-series was constructed, we can compute ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"nHZMpcrxI3"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"a set of metrics","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"GRQqwZOdur"}],"key":"k4pQdLXuTo"},{"type":"text","value":" for each pixel in the stack:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ApxhES8IO1"}],"key":"WhxPMprIBX"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Mean","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"pVxqsdzQbq"}],"key":"tKmbfW4YsT"}],"key":"D4FA8BGH0X"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Median","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"I5TjvXlVW8"}],"key":"NkJGA1PnX2"}],"key":"z5vghsTqfL"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Maximum","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"xP1n8U76hb"}],"key":"LMgejEjWy3"}],"key":"KJxtEJb3Al"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Minimum","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"aFgh66k3DE"}],"key":"hGcbW4O7ue"}],"key":"PgadF93uNR"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Range (Maximum - Minimum)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"vBPVh0Iwgr"}],"key":"iSkRDgqLuG"}],"key":"tph16k0fio"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"5th Percentile","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"UlMzguUk5c"}],"key":"E4pGhKd2js"}],"key":"KL1xhEVLju"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"95th Percentile","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"YtHbWJe9N3"}],"key":"zPXA0yMmwr"}],"key":"ewlQkBEHRW"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"PRange (95th - 5th Percentile)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"AXaNCXTIN7"}],"key":"Sy9eIzLJtT"}],"key":"YElYgtFhUm"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Variance","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"sUAKerwF5M"}],"key":"oDj9RTMyVK"}],"key":"aurq5KNbtT"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Coefficient of Variation (Variance/Mean)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"lAqwFQwNrc"}],"key":"G30ksEGdfJ"}],"key":"rCbGQ0oWW6"}],"key":"ZqBLMiuOIU"},{"type":"thematicBreak","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"cX5BQwRVAs"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"First, we ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"OQw80k1hJG"},{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"mask out pixels","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"RsZKEBhnyy"}],"key":"ByOQQmLmxY"},{"type":"text","value":" that are zero (e.g. beyond the edge of the swath). Then we ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"lYmm8n5nNy"},{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"calculate the time series metrics:","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"GWxe4rIZDQ"}],"key":"rSxlbxMXHU"}],"key":"lbLeSeejt7"}],"key":"AT7npwmoHI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# mask = (rasterstack == 0)\n# raster = np.ma.array(convert(rasterstack), mask=mask, dtype=np.float64)","key":"pdwpkiIFyO"},{"type":"output","id":"eZ_Oy2BaELhUGMSyLE_Bf","data":[],"key":"QuSitkIGKg"}],"key":"UuOUdZwbDx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"zjxDBLzlHX"},{"type":"output","id":"RVBw1UuAWcS1H-Lt1a9On","data":[],"key":"XTYDRtCYht"}],"key":"Tose8BFZSR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n# calc metric in power\nmetrics = timeseries_metrics(da)\nmetrics.load()\nmetrics","key":"Lnimce17vV"},{"type":"output","id":"4sCZewdsVEBLJ6iyp9Rer","data":[{"name":"stdout","output_type":"stream","text":"CPU times: user 1min 24s, sys: 18.6 s, total: 1min 42s\nWall time: 56.2 s\n"},{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"5c9c008e07c25b1adad63c1b2e6b829c","path":"/NISAR_GCOV_Cookbook/build/5c9c008e07c25b1adad63c1b2e6b829c.html"},"text/plain":{"content":"\u003cxarray.Dataset\u003e Size: 2GB\nDimensions:    (y: 5000, x: 5000)\nCoordinates:\n    frequency  \u003cU1 4B 'A'\n  * y          (y) float64 40kB 9.7e+06 9.7e+06 9.7e+06 ... 9.6e+06 9.6e+06\n  * x          (x) float64 40kB 4e+05 4e+05 4e+05 ... 5e+05 5e+05 5e+05\nData variables:\n    min        (y, x) float64 200MB 2.867e-08 2.171e-08 ... 7.217e-08 9.814e-08\n    max        (y, x) float64 200MB 5.238e-08 3.967e-08 ... 1.318e-07 1.793e-07\n    range      (y, x) float64 200MB 2.371e-08 1.795e-08 ... 5.967e-08 8.114e-08\n    mean       (y, x) float64 200MB 4.053e-08 3.069e-08 ... 1.02e-07 1.387e-07\n    var        (y, x) float64 200MB 6.467e-17 3.709e-17 ... 4.097e-16 7.575e-16\n    std        (y, x) float64 200MB 8.041e-09 6.09e-09 ... 2.024e-08 2.752e-08\n    CV         (y, x) float64 200MB 0.1984 0.1984 0.1984 ... 0.1984 0.1984\n    p05        (y, x) float64 200MB 2.949e-08 2.234e-08 ... 7.424e-08 1.009e-07\n    p50        (y, x) float64 200MB 4.053e-08 3.069e-08 ... 1.02e-07 1.387e-07\n    p95        (y, x) float64 200MB 5.156e-08 3.905e-08 ... 1.298e-07 1.765e-07\n    prange     (y, x) float64 200MB 2.206e-08 1.671e-08 ... 5.553e-08 7.551e-08","content_type":"text/plain"}}}],"key":"KLOIBPZ23R"}],"key":"BavtH6zywX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# metrics.keys()","key":"iKZEnGkwPQ"},{"type":"output","id":"7tGKzVXKOutxw1NTmZNLE","data":[],"key":"bJ4jeOXw4o"}],"key":"kC7F81bOFm"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s look at the histograms for the time series variance and coeficient of variation to aid displaying those images:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hfKXYeOADx"}],"key":"o6bIpNmHcL"}],"key":"Cn8WNH7ofI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# fig, ax = plt.subplots(1,2,figsize=(16,4))\n# ax[0].hist(metrics['var'].flatten(), bins=100, range=np.nanpercentile(metrics['var'], [1,99]))\n# ax[1].hist(metrics['CV'].flatten(), bins=100, range=np.nanpercentile(metrics['CV'], [1,99]))\n# _ = ax[0].set_title('Variance')\n# _ = ax[1].set_title('Coefficient of Variation')","key":"hfN7QtDrWZ"},{"type":"output","id":"mFrf_n_T_IlhZ_Hnu-q90","data":[],"key":"sJcptcXESl"}],"key":"cKtWQLOfBk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"np.min(cv)","key":"yjJPQqt6wA"},{"type":"output","id":"x4eb8IfTKD33nEbuOP0Dk","data":[],"key":"lovtnt9eo9"}],"key":"mdwTBcV8JK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"np.max(cv)","key":"aVOG1uIyrx"},{"type":"output","id":"ljSuSmt60_1OW043aPXC4","data":[],"key":"gZGoN93GSh"}],"key":"GowlXMUAnL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"len(cv)","key":"Telrh9l7PZ"},{"type":"output","id":"P1jzvfu-QP2u4eUWfcqkE","data":[],"key":"es4HW1TAh4"}],"key":"y1Be7yhVai"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib import pyplot as plt\n\nfig, ax = plt.subplots(1,2,figsize=(9, 3))\n\nvar = metrics[\"var\"].values.ravel()\nax[0].hist(var, bins=100, range=np.nanpercentile(var, [1,99]))\nax[0].set_title('Variance')\n\ncv = metrics[\"CV\"].values.ravel()\nax[1].hist(cv, bins=100, range=np.nanpercentile(cv, [1,99]))\nax[1].set_title('Coefficient of Variation')\n\nplt.show()","key":"mQd2CSdlfV"},{"type":"output","id":"Xxd4Um4UUMG00ptfCAbr7","data":[{"ename":"ValueError","evalue":"Too many bins for data range. Cannot create 100 finite-sized bins.","output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mValueError\u001b[39m                                Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[12]\u001b[39m\u001b[32m, line 10\u001b[39m\n\u001b[32m      7\u001b[39m ax[\u001b[32m0\u001b[39m].set_title(\u001b[33m'\u001b[39m\u001b[33mVariance\u001b[39m\u001b[33m'\u001b[39m)\n\u001b[32m      9\u001b[39m cv = metrics[\u001b[33m\"\u001b[39m\u001b[33mCV\u001b[39m\u001b[33m\"\u001b[39m].values.ravel()\n\u001b[32m---\u003e \u001b[39m\u001b[32m10\u001b[39m \u001b[43max\u001b[49m\u001b[43m[\u001b[49m\u001b[32;43m1\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m.\u001b[49m\u001b[43mhist\u001b[49m\u001b[43m(\u001b[49m\u001b[43mcv\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mbins\u001b[49m\u001b[43m=\u001b[49m\u001b[32;43m100\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mrange\u001b[39;49m\u001b[43m=\u001b[49m\u001b[43mnp\u001b[49m\u001b[43m.\u001b[49m\u001b[43mnanpercentile\u001b[49m\u001b[43m(\u001b[49m\u001b[43mcv\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m[\u001b[49m\u001b[32;43m1\u001b[39;49m\u001b[43m,\u001b[49m\u001b[32;43m99\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     11\u001b[39m ax[\u001b[32m1\u001b[39m].set_title(\u001b[33m'\u001b[39m\u001b[33mCoefficient of Variation\u001b[39m\u001b[33m'\u001b[39m)\n\u001b[32m     13\u001b[39m plt.show()\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/_api/deprecation.py:453\u001b[39m, in \u001b[36mmake_keyword_only.\u003clocals\u003e.wrapper\u001b[39m\u001b[34m(*args, **kwargs)\u001b[39m\n\u001b[32m    447\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mlen\u001b[39m(args) \u003e name_idx:\n\u001b[32m    448\u001b[39m     warn_deprecated(\n\u001b[32m    449\u001b[39m         since, message=\u001b[33m\"\u001b[39m\u001b[33mPassing the \u001b[39m\u001b[38;5;132;01m%(name)s\u001b[39;00m\u001b[33m \u001b[39m\u001b[38;5;132;01m%(obj_type)s\u001b[39;00m\u001b[33m \u001b[39m\u001b[33m\"\u001b[39m\n\u001b[32m    450\u001b[39m         \u001b[33m\"\u001b[39m\u001b[33mpositionally is deprecated since Matplotlib \u001b[39m\u001b[38;5;132;01m%(since)s\u001b[39;00m\u001b[33m; the \u001b[39m\u001b[33m\"\u001b[39m\n\u001b[32m    451\u001b[39m         \u001b[33m\"\u001b[39m\u001b[33mparameter will become keyword-only in \u001b[39m\u001b[38;5;132;01m%(removal)s\u001b[39;00m\u001b[33m.\u001b[39m\u001b[33m\"\u001b[39m,\n\u001b[32m    452\u001b[39m         name=name, obj_type=\u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[33mparameter of \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mfunc.\u001b[34m__name__\u001b[39m\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m()\u001b[39m\u001b[33m\"\u001b[39m)\n\u001b[32m--\u003e \u001b[39m\u001b[32m453\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mfunc\u001b[49m\u001b[43m(\u001b[49m\u001b[43m*\u001b[49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/__init__.py:1524\u001b[39m, in \u001b[36m_preprocess_data.\u003clocals\u003e.inner\u001b[39m\u001b[34m(ax, data, *args, **kwargs)\u001b[39m\n\u001b[32m   1521\u001b[39m \u001b[38;5;129m@functools\u001b[39m.wraps(func)\n\u001b[32m   1522\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34minner\u001b[39m(ax, *args, data=\u001b[38;5;28;01mNone\u001b[39;00m, **kwargs):\n\u001b[32m   1523\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m data \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[32m-\u003e \u001b[39m\u001b[32m1524\u001b[39m         \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mfunc\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m   1525\u001b[39m \u001b[43m            \u001b[49m\u001b[43max\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1526\u001b[39m \u001b[43m            \u001b[49m\u001b[43m*\u001b[49m\u001b[38;5;28;43mmap\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43mcbook\u001b[49m\u001b[43m.\u001b[49m\u001b[43msanitize_sequence\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43margs\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1527\u001b[39m \u001b[43m            \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43m{\u001b[49m\u001b[43mk\u001b[49m\u001b[43m:\u001b[49m\u001b[43m \u001b[49m\u001b[43mcbook\u001b[49m\u001b[43m.\u001b[49m\u001b[43msanitize_sequence\u001b[49m\u001b[43m(\u001b[49m\u001b[43mv\u001b[49m\u001b[43m)\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mfor\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mk\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mv\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;129;43;01min\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m.\u001b[49m\u001b[43mitems\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m}\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   1529\u001b[39m     bound = new_sig.bind(ax, *args, **kwargs)\n\u001b[32m   1530\u001b[39m     auto_label = (bound.arguments.get(label_namer)\n\u001b[32m   1531\u001b[39m                   \u001b[38;5;129;01mor\u001b[39;00m bound.kwargs.get(label_namer))\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/axes/_axes.py:7132\u001b[39m, in \u001b[36mAxes.hist\u001b[39m\u001b[34m(self, x, bins, range, density, weights, cumulative, bottom, histtype, align, orientation, rwidth, log, color, label, stacked, **kwargs)\u001b[39m\n\u001b[32m   7128\u001b[39m \u001b[38;5;66;03m# Loop through datasets\u001b[39;00m\n\u001b[32m   7129\u001b[39m \u001b[38;5;28;01mfor\u001b[39;00m i \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(nx):\n\u001b[32m   7130\u001b[39m     \u001b[38;5;66;03m# this will automatically overwrite bins,\u001b[39;00m\n\u001b[32m   7131\u001b[39m     \u001b[38;5;66;03m# so that each histogram uses the same bins\u001b[39;00m\n\u001b[32m-\u003e \u001b[39m\u001b[32m7132\u001b[39m     m, bins = \u001b[43mnp\u001b[49m\u001b[43m.\u001b[49m\u001b[43mhistogram\u001b[49m\u001b[43m(\u001b[49m\u001b[43mx\u001b[49m\u001b[43m[\u001b[49m\u001b[43mi\u001b[49m\u001b[43m]\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mbins\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mweights\u001b[49m\u001b[43m=\u001b[49m\u001b[43mw\u001b[49m\u001b[43m[\u001b[49m\u001b[43mi\u001b[49m\u001b[43m]\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mhist_kwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   7133\u001b[39m     tops.append(m)\n\u001b[32m   7134\u001b[39m tops = np.array(tops, \u001b[38;5;28mfloat\u001b[39m)  \u001b[38;5;66;03m# causes problems later if it's an int\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/numpy/lib/_histograms_impl.py:792\u001b[39m, in \u001b[36mhistogram\u001b[39m\u001b[34m(a, bins, range, density, weights)\u001b[39m\n\u001b[32m    687\u001b[39m \u001b[38;5;250m\u001b[39m\u001b[33mr\u001b[39m\u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m    688\u001b[39m \u001b[33;03mCompute the histogram of a dataset.\u001b[39;00m\n\u001b[32m    689\u001b[39m \n\u001b[32m   (...)\u001b[39m\u001b[32m    788\u001b[39m \n\u001b[32m    789\u001b[39m \u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m    790\u001b[39m a, weights = _ravel_and_check_weights(a, weights)\n\u001b[32m--\u003e \u001b[39m\u001b[32m792\u001b[39m bin_edges, uniform_bins = \u001b[43m_get_bin_edges\u001b[49m\u001b[43m(\u001b[49m\u001b[43ma\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mbins\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mrange\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mweights\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    794\u001b[39m \u001b[38;5;66;03m# Histogram is an integer or a float array depending on the weights.\u001b[39;00m\n\u001b[32m    795\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m weights \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/numpy/lib/_histograms_impl.py:449\u001b[39m, in \u001b[36m_get_bin_edges\u001b[39m\u001b[34m(a, bins, range, weights)\u001b[39m\n\u001b[32m    445\u001b[39m     bin_edges = np.linspace(\n\u001b[32m    446\u001b[39m         first_edge, last_edge, n_equal_bins + \u001b[32m1\u001b[39m,\n\u001b[32m    447\u001b[39m         endpoint=\u001b[38;5;28;01mTrue\u001b[39;00m, dtype=bin_type)\n\u001b[32m    448\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m np.any(bin_edges[:-\u001b[32m1\u001b[39m] \u003e= bin_edges[\u001b[32m1\u001b[39m:]):\n\u001b[32m--\u003e \u001b[39m\u001b[32m449\u001b[39m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[32m    450\u001b[39m             \u001b[33mf\u001b[39m\u001b[33m'\u001b[39m\u001b[33mToo many bins for data range. Cannot create \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mn_equal_bins\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m \u001b[39m\u001b[33m'\u001b[39m\n\u001b[32m    451\u001b[39m             \u001b[33mf\u001b[39m\u001b[33m'\u001b[39m\u001b[33mfinite-sized bins.\u001b[39m\u001b[33m'\u001b[39m)\n\u001b[32m    452\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m bin_edges, (first_edge, last_edge, n_equal_bins)\n\u001b[32m    453\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\n\u001b[31mValueError\u001b[39m: Too many bins for data range. Cannot create 100 finite-sized bins."},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4df5c407fd0d935de67f4c07a4c89540","path":"/NISAR_GCOV_Cookbook/build/4df5c407fd0d935de67f4c07a4c89540.png"},"text/plain":{"content":"\u003cFigure size 900x300 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"iuKdo0MKI9"}],"key":"LSHjmHR5QE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# # List the metrics keys you want to plot\n# metric_keys=['mean', 'median', 'max', 'min', \n#              'p95', 'p5', 'prange', 'var', 'std', 'CV']\n# fig= plt.figure(figsize=(16,40))\n# idx=1\n# for i in metric_keys:\n#     ax = fig.add_subplot(5,2,idx)\n#     vmin, vmax = np.nanpercentile(metrics[i], [1, 99])\n#     ax.imshow(metrics[i],vmin=vmin,vmax=vmax,cmap='inferno')\n#     ax.set_title(i.upper())\n#     ax.axis('off')\n#     idx+=1","key":"eB3YmD3fGB"},{"type":"output","id":"7WV0jVRy-mhuzcvKPkQNf","data":[],"key":"re8qB2y1dY"}],"key":"nKXs83qqhW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"metrics","key":"OJJkgyDFv4"},{"type":"output","id":"Z5WG6gZ2oyCfsRdN3xxTf","data":[],"key":"DSCLc5lhCr"}],"key":"o58FEHyun8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# List the metrics keys you want to plot\nmetric_keys=['mean', 'p50', 'max', 'min', \n             'p95', 'p05', 'prange', 'var', 'std', 'CV']\nfig= plt.figure(figsize=(16,40))\nidx=1\nfor i in metric_keys:\n    ax = fig.add_subplot(5,2,idx)\n    vmin, vmax = np.nanpercentile(metrics[i], [1, 99])\n    ax.imshow(metrics[i],vmin=vmin,vmax=vmax,cmap='inferno')\n    ax.set_title(i.upper())\n    ax.axis('off')\n    idx+=1","key":"k6OWfYEVzJ"},{"type":"output","id":"0UsU1JnzThgXFJ_Pl-Qcf","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cdf02963424843d5363c231615f85944","path":"/NISAR_GCOV_Cookbook/build/cdf02963424843d5363c231615f85944.png"},"text/plain":{"content":"\u003cFigure size 1600x4000 with 10 Axes\u003e","content_type":"text/plain"}}}],"key":"by5QPx5Y33"}],"key":"VzXDuV8q6t"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"You might have noticed white patches in the images above. These do not contain any data. The reason is that they are in the radar shadow of terrain that is closer to the satellite.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kNSGnMpEVY"}],"key":"T2dmL4wwxz"},{"type":"thematicBreak","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"neXvkp7fBN"},{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"6. Some Popular SAR Change Detection Methods","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QecLbq3U2v"}],"identifier":"id-6-some-popular-sar-change-detection-methods","label":"6. Some Popular SAR Change Detection Methods","html_id":"id-6-some-popular-sar-change-detection-methods","implicit":true,"key":"z6qhS1PtZu"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"This section will introduce you to the following popular and simple change detection methods:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"xkQiWFpQFd"}],"key":"EAOYaX2vUb"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Time series metrics  95","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"AnkH20xAbn"},{"type":"inlineMath","value":"^{th}","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmrow\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmi\u003eh\u003c/mi\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e^{th}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8491em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8491em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003et\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eh\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"ivm0PnB7bh"},{"type":"text","value":" and 5","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"rWvccIsKwJ"},{"type":"inlineMath","value":"^{th}","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmrow\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmi\u003eh\u003c/mi\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e^{th}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8491em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8491em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003et\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eh\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"OGFYVcx40Z"},{"type":"text","value":" percentile difference and standard deviation thresholding","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"han0T0sKzD"}],"key":"ptrnAIuPxS"}],"key":"ln4Yn8hHBT"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Time series coefficient of variation thresholding","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"RQ6m3Pd0fa"}],"key":"kUEfGRo357"}],"key":"sxydaOpNMp"}],"key":"l3FTLoX8RF"},{"type":"thematicBreak","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"DvVT0gwYMa"},{"type":"heading","depth":3,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"6.1 Change Detection with the Percentile Difference and the Variance Threshold Method","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"vB1PW4g6SK"}],"identifier":"id-6-1-change-detection-with-the-percentile-difference-and-the-variance-threshold-method","label":"6.1 Change Detection with the Percentile Difference and the Variance Threshold Method","html_id":"id-6-1-change-detection-with-the-percentile-difference-and-the-variance-threshold-method","implicit":true,"key":"liIkG9pHIZ"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"In this method we find thresholds on the ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"eyVN4edF7n"},{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"95","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"iVj75gvCyO"},{"type":"inlineMath","value":"^{th}","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmrow\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmi\u003eh\u003c/mi\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e^{th}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8491em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8491em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003et\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eh\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"OCKoO8EcFv"},{"type":"text","value":" and 5","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"jN336wMqI6"},{"type":"inlineMath","value":"^{th}","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmrow\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmi\u003eh\u003c/mi\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e^{th}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8491em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8491em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003et\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eh\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"HxOD4BDnNT"},{"type":"text","value":" percentile difference","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"baitALftSL"}],"key":"JS9jAMmcFw"},{"type":"text","value":" or the ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"eVlQKNODsZ"},{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"temporal pixel-by-pixel gray value cariance","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Cl9Oq7fdgn"}],"key":"UvBq8j4qNc"},{"type":"text","value":". Let’s start with the 95","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"LalMJeNGnj"},{"type":"inlineMath","value":"^{th}","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmrow\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmi\u003eh\u003c/mi\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e^{th}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8491em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8491em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003et\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eh\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"uWFFp308yB"},{"type":"text","value":" and 5","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"BykYZLSJqb"},{"type":"inlineMath","value":"^{th}","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmrow\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmi\u003eh\u003c/mi\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e^{th}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8491em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8491em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003et\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eh\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"VU84Ge5GpQ"},{"type":"text","value":" percentile difference. The advantage to look at percentiles verus maximum minus minimum is that it is more robust to outliers.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Gww0xCyMHh"}],"key":"wzyqaMcXFH"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"First, let us define a ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"xO38Y2yQ5G"},{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"function for plotting histograms:","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"RpIRcjG9Sj"}],"key":"S6byRgJS3w"}],"key":"MnpMzAMC5G"}],"key":"TXaZEqFUgm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def plot_histogram_cdf(metric='std'):\n    plt.rcParams.update({'font.size': 12})\n    fig = plt.figure(figsize=(14, 4)) # Initialize figure with a size\n    ax1 = fig.add_subplot(121)  # 121 determines: 2 rows, 2 plots, first plot\n    ax2 = fig.add_subplot(122)\n\n    h = ax1.hist(\n        metrics[metric].values.ravel(), range=np.nanpercentile(metrics[metric], [1, 99]))\n    ax1.xaxis.set_label_text(f'{metric}')\n    ax1.set_title('Histogram')\n\n    n, bins, patches = ax2.hist(\n        metrics[metric].values.ravel(), range=np.nanpercentile(metrics[metric], [1, 99]),\n        cumulative='True', density='True', histtype='step', label='Empirical')\n\n    ax2.xaxis.set_label_text(f'{metric}')\n    ax2.set_title('CDF')\n\n    outind = np.where(n \u003e 0.95)   \n    threshind = np.min(outind)\n    thresh = bins[threshind]\n    ax1.axvline(thresh,color='red')\n    _ = ax2.axvline(thresh,color='red')\n    plt.savefig(plot_dir/f'{metric}_histogram.png',\n                dpi=200, transparent='true')","key":"fbIPGcLb2I"},{"type":"output","id":"FxITjze0ssSZ9AuukY3vS","data":[],"key":"Cj9jsuCyA3"}],"key":"gA8a0UywK1"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now let’s look at the 95th - 5th percentile range","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YrTqlyBpOr"}],"key":"no0H89Qe4Y"}],"key":"NHv9Evybmb"}],"key":"kCfDTBA2Cn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_histogram_cdf(metric='prange')","key":"fv9VWxJ3eg"},{"type":"output","id":"wOqnveVJ1_hWCE7HycKlg","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8710e7d305ef2852661bcee12d4e5abc","path":"/NISAR_GCOV_Cookbook/build/8710e7d305ef2852661bcee12d4e5abc.png"},"text/plain":{"content":"\u003cFigure size 1400x400 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"qefKIjjQlD"}],"key":"RNIuqBZxxK"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s visualize the 5% of all pixels with the largest (95th - 5th percentile) difference in the time series. We will refer to the pixels (x,y) that exceed this threshold ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U826nBibAo"},{"type":"inlineMath","value":"t","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003et\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003et\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6151em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"eOJYnd5QcC"},{"type":"text","value":" as likely ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bmYGs2ca1F"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"change pixels (cp):","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uF8j7GEF98"}],"key":"z4eciZWwBE"}],"key":"NqNAXZO61V"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineMath","value":"{cp}_{x,y} = P_{x,y}^{95th} - P_{x,y}^{5th} \u003e t","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmrow\u003e\u003cmi\u003ec\u003c/mi\u003e\u003cmi\u003ep\u003c/mi\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsubsup\u003e\u003cmi\u003eP\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmn\u003e95\u003c/mn\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmi\u003eh\u003c/mi\u003e\u003c/mrow\u003e\u003c/msubsup\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmsubsup\u003e\u003cmi\u003eP\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmn\u003e5\u003c/mn\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmi\u003eh\u003c/mi\u003e\u003c/mrow\u003e\u003c/msubsup\u003e\u003cmo\u003e\u0026gt;\u003c/mo\u003e\u003cmi\u003et\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e{cp}_{x,y} = P_{x,y}^{95th} - P_{x,y}^{5th} \u0026gt; t\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8108em;vertical-align:-0.3802em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ec\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ep\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.0573em;\"\u003e\u003cspan style=\"top:-2.4559em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003cspan class=\"mpunct mtight\"\u003e,\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3802em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.2322em;vertical-align:-0.3831em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eP\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8491em;\"\u003e\u003cspan style=\"top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003cspan class=\"mpunct mtight\"\u003e,\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e95\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003et\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eh\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3831em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.2322em;vertical-align:-0.3831em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eP\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8491em;\"\u003e\u003cspan style=\"top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003cspan class=\"mpunct mtight\"\u003e,\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e5\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003et\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eh\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3831em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6151em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"FZYiBnjDzh"}],"key":"LbsNhnkL46"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"If we define ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"YPuXeedWV9"},{"type":"inlineMath","value":"t","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003et\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003et\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6151em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"zOYOaK88Qo"},{"type":"text","value":" to correspond to the 5% of pixels with highest (95th - 5th percentile) difference, the image looks like:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"q54B5uTxVC"}],"key":"KmJ7EWMEw6"}],"key":"diXS7F6eJd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def plot_threshold_classifier(metric='prange', percentage_cutoff=5):\n    plt.figure(figsize=(8,8))\n    thresh = np.nanpercentile(metrics[metric], 100 - percentage_cutoff)\n    mask = metrics[metric] \u003c thresh # For display we prepare the inverse mask\n    plt.imshow(mask, cmap='gray')\n    _=plt.title(f'Threshold Classifier on {metric} \u003e %1.8f' % thresh)\n    plt.savefig(plot_dir/f'changes_{metric}.png',\n            dpi=200, transparent='true')\n    return np.logical_not(mask)\n\nmetric = 'prange'\nmasks = {metric: plot_threshold_classifier(metric=metric)}","key":"Gc8YHBL9TE"},{"type":"output","id":"4v7X0gPRN6e8kkc7n3fAI","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4121dcc6a28815f57f25f226e2ef3cc9","path":"/NISAR_GCOV_Cookbook/build/4121dcc6a28815f57f25f226e2ef3cc9.png"},"text/plain":{"content":"\u003cFigure size 800x800 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"u0GxJC6SKR"}],"key":"Cnmn2VvpXV"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Instead of applying a threshold on the 95th - 5th percentile difference data, we can also attempt to threshold other metrics. The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FPVzE0WDlQ"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"standard deviation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gD5nVxoTuF"}],"key":"pDCa55fA0a"},{"type":"text","value":" (or variance) variable seems a useful indicator for change as it identifies pixels for which radar brightness has changed strongly within the time series. Hence, in the following we use this metric for change identification according to:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D81otXDsdC"}],"key":"plIKKat4Fw"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineMath","value":"{cp}_{x,y} = \\sigma \u003e t","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmrow\u003e\u003cmi\u003ec\u003c/mi\u003e\u003cmi\u003ep\u003c/mi\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003cmo\u003e\u0026gt;\u003c/mo\u003e\u003cmi\u003et\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e{cp}_{x,y} = \\sigma \u0026gt; t\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8108em;vertical-align:-0.3802em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ec\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ep\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.0573em;\"\u003e\u003cspan style=\"top:-2.4559em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003cspan class=\"mpunct mtight\"\u003e,\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3802em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6151em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"EsVq8uLSt2"}],"key":"ULoDk4Lp79"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"with ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Gtr0OKqJ3U"},{"type":"inlineMath","value":"t=CDF_{\\sigma} \u003e 0.95","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003eC\u003c/mi\u003e\u003cmi\u003eD\u003c/mi\u003e\u003cmsub\u003e\u003cmi\u003eF\u003c/mi\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003c/msub\u003e\u003cmo\u003e\u0026gt;\u003c/mo\u003e\u003cmn\u003e0.95\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003et=CDF_{\\sigma} \u0026gt; 0.95\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6151em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\"\u003eC\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003eD\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eF\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0.95\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"wAFznfynLs"},{"type":"text","value":" (5% pixels with highest standard deviation):","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"kDgEEJLElB"}],"key":"fBbuPyPF33"}],"key":"rNmRG2tGH2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_histogram_cdf(metric='std')","key":"opClw2vDZ1"},{"type":"output","id":"IUHnoc4EfYE1YOuMNaFGb","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"121597439082e37604a170032487480b","path":"/NISAR_GCOV_Cookbook/build/121597439082e37604a170032487480b.png"},"text/plain":{"content":"\u003cFigure size 1400x400 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"oCvzjk2iIv"}],"key":"isRmoKen4H"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"metric = 'std'\nmasks[metric] = plot_threshold_classifier(metric=metric)","key":"ZmZQnfINu6"},{"type":"output","id":"JaRen8H8nbq2YT5vEnDf9","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"473070a9d286e08b40709d01950c7244","path":"/NISAR_GCOV_Cookbook/build/473070a9d286e08b40709d01950c7244.png"},"text/plain":{"content":"\u003cFigure size 800x800 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"RhtlXFmWFc"}],"key":"OAsg1uXzei"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"6.2 Change Detection with the Coefficient of Variation Method","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qjc7eGQDs9"}],"identifier":"id-6-2-change-detection-with-the-coefficient-of-variation-method","label":"6.2 Change Detection with the Coefficient of Variation Method","html_id":"id-6-2-change-detection-with-the-coefficient-of-variation-method","implicit":true,"key":"wcFZ4cg8ZA"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"We can also set a threshold ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"InPgRCSPAK"},{"type":"inlineMath","value":"t","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003et\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003et\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6151em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"gGyUyJ2jyu"},{"type":"text","value":" for the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NzBMg7kTj8"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"coefficient of variation image","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EtHUsatIgY"}],"key":"MeuY9RKLYm"},{"type":"text","value":"\nto classify change in the time series:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"l9oSCOYTRB"}],"key":"bOACWaD8AM"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"inlineMath","value":"{CV}_{x,y} = \\frac{\\sigma_{x,y}}{\\overline{X}_{x,y}} \u003e t","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmrow\u003e\u003cmi\u003eC\u003c/mi\u003e\u003cmi\u003eV\u003c/mi\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmfrac\u003e\u003cmsub\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmsub\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003eX\u003c/mi\u003e\u003cmo stretchy=\"true\"\u003e‾\u003c/mo\u003e\u003c/mover\u003e\u003cmrow\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003c/mfrac\u003e\u003cmo\u003e\u0026gt;\u003c/mo\u003e\u003cmi\u003et\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e{CV}_{x,y} = \\frac{\\sigma_{x,y}}{\\overline{X}_{x,y}} \u0026gt; t\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\"\u003eC\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.22222em;\"\u003eV\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003cspan class=\"mpunct mtight\"\u003e,\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.4659em;vertical-align:-0.6572em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8087em;\"\u003e\u003cspan style=\"top:-2.5402em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord overline mtight\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9283em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\"\u003eX\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.8303em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"overline-line mtight\" style=\"border-bottom-width:0.049em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1645em;\"\u003e\u003cspan style=\"top:-2.357em;margin-right:0.0714em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.5em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size3 size1 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003cspan class=\"mpunct mtight\"\u003e,\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2819em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.5073em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1645em;\"\u003e\u003cspan style=\"top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.5em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size3 size1 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003cspan class=\"mpunct mtight\"\u003e,\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2819em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.6572em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6151em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"JOSnq9CDHz"}],"key":"QNdFnWHiYz"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Let’s look at the histogram and the Cumulative Distribution Function (CDF) of the coefficient of variation:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"wmaMiIPPSy"}],"key":"TB9DJNAYXG"}],"key":"e4eGyl5ZL9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_histogram_cdf(metric='CV')","key":"MOnjfb0IvV"},{"type":"output","id":"FIpOaQThrs50eGZDsMS4O","data":[{"ename":"ValueError","evalue":"Too many bins for data range. Cannot create 10 finite-sized bins.","output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mValueError\u001b[39m                                Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[31]\u001b[39m\u001b[32m, line 1\u001b[39m\n\u001b[32m----\u003e \u001b[39m\u001b[32m1\u001b[39m \u001b[43mplot_histogram_cdf\u001b[49m\u001b[43m(\u001b[49m\u001b[43mmetric\u001b[49m\u001b[43m=\u001b[49m\u001b[33;43m'\u001b[39;49m\u001b[33;43mCV\u001b[39;49m\u001b[33;43m'\u001b[39;49m\u001b[43m)\u001b[49m\n\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[24]\u001b[39m\u001b[32m, line 7\u001b[39m, in \u001b[36mplot_histogram_cdf\u001b[39m\u001b[34m(metric)\u001b[39m\n\u001b[32m      4\u001b[39m ax1 = fig.add_subplot(\u001b[32m121\u001b[39m)  \u001b[38;5;66;03m# 121 determines: 2 rows, 2 plots, first plot\u001b[39;00m\n\u001b[32m      5\u001b[39m ax2 = fig.add_subplot(\u001b[32m122\u001b[39m)\n\u001b[32m----\u003e \u001b[39m\u001b[32m7\u001b[39m h = \u001b[43max1\u001b[49m\u001b[43m.\u001b[49m\u001b[43mhist\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m      8\u001b[39m \u001b[43m    \u001b[49m\u001b[43mmetrics\u001b[49m\u001b[43m[\u001b[49m\u001b[43mmetric\u001b[49m\u001b[43m]\u001b[49m\u001b[43m.\u001b[49m\u001b[43mvalues\u001b[49m\u001b[43m.\u001b[49m\u001b[43mravel\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mrange\u001b[39;49m\u001b[43m=\u001b[49m\u001b[43mnp\u001b[49m\u001b[43m.\u001b[49m\u001b[43mnanpercentile\u001b[49m\u001b[43m(\u001b[49m\u001b[43mmetrics\u001b[49m\u001b[43m[\u001b[49m\u001b[43mmetric\u001b[49m\u001b[43m]\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m[\u001b[49m\u001b[32;43m1\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[32;43m99\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m      9\u001b[39m ax1.xaxis.set_label_text(\u001b[33mf\u001b[39m\u001b[33m'\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mmetric\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m'\u001b[39m)\n\u001b[32m     10\u001b[39m ax1.set_title(\u001b[33m'\u001b[39m\u001b[33mHistogram\u001b[39m\u001b[33m'\u001b[39m)\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/_api/deprecation.py:453\u001b[39m, in \u001b[36mmake_keyword_only.\u003clocals\u003e.wrapper\u001b[39m\u001b[34m(*args, **kwargs)\u001b[39m\n\u001b[32m    447\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mlen\u001b[39m(args) \u003e name_idx:\n\u001b[32m    448\u001b[39m     warn_deprecated(\n\u001b[32m    449\u001b[39m         since, message=\u001b[33m\"\u001b[39m\u001b[33mPassing the \u001b[39m\u001b[38;5;132;01m%(name)s\u001b[39;00m\u001b[33m \u001b[39m\u001b[38;5;132;01m%(obj_type)s\u001b[39;00m\u001b[33m \u001b[39m\u001b[33m\"\u001b[39m\n\u001b[32m    450\u001b[39m         \u001b[33m\"\u001b[39m\u001b[33mpositionally is deprecated since Matplotlib \u001b[39m\u001b[38;5;132;01m%(since)s\u001b[39;00m\u001b[33m; the \u001b[39m\u001b[33m\"\u001b[39m\n\u001b[32m    451\u001b[39m         \u001b[33m\"\u001b[39m\u001b[33mparameter will become keyword-only in \u001b[39m\u001b[38;5;132;01m%(removal)s\u001b[39;00m\u001b[33m.\u001b[39m\u001b[33m\"\u001b[39m,\n\u001b[32m    452\u001b[39m         name=name, obj_type=\u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[33mparameter of \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mfunc.\u001b[34m__name__\u001b[39m\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m()\u001b[39m\u001b[33m\"\u001b[39m)\n\u001b[32m--\u003e \u001b[39m\u001b[32m453\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mfunc\u001b[49m\u001b[43m(\u001b[49m\u001b[43m*\u001b[49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/__init__.py:1524\u001b[39m, in \u001b[36m_preprocess_data.\u003clocals\u003e.inner\u001b[39m\u001b[34m(ax, data, *args, **kwargs)\u001b[39m\n\u001b[32m   1521\u001b[39m \u001b[38;5;129m@functools\u001b[39m.wraps(func)\n\u001b[32m   1522\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34minner\u001b[39m(ax, *args, data=\u001b[38;5;28;01mNone\u001b[39;00m, **kwargs):\n\u001b[32m   1523\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m data \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[32m-\u003e \u001b[39m\u001b[32m1524\u001b[39m         \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mfunc\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m   1525\u001b[39m \u001b[43m            \u001b[49m\u001b[43max\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1526\u001b[39m \u001b[43m            \u001b[49m\u001b[43m*\u001b[49m\u001b[38;5;28;43mmap\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43mcbook\u001b[49m\u001b[43m.\u001b[49m\u001b[43msanitize_sequence\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43margs\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1527\u001b[39m \u001b[43m            \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43m{\u001b[49m\u001b[43mk\u001b[49m\u001b[43m:\u001b[49m\u001b[43m \u001b[49m\u001b[43mcbook\u001b[49m\u001b[43m.\u001b[49m\u001b[43msanitize_sequence\u001b[49m\u001b[43m(\u001b[49m\u001b[43mv\u001b[49m\u001b[43m)\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mfor\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mk\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mv\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;129;43;01min\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m.\u001b[49m\u001b[43mitems\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m}\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   1529\u001b[39m     bound = new_sig.bind(ax, *args, **kwargs)\n\u001b[32m   1530\u001b[39m     auto_label = (bound.arguments.get(label_namer)\n\u001b[32m   1531\u001b[39m                   \u001b[38;5;129;01mor\u001b[39;00m bound.kwargs.get(label_namer))\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/axes/_axes.py:7132\u001b[39m, in \u001b[36mAxes.hist\u001b[39m\u001b[34m(self, x, bins, range, density, weights, cumulative, bottom, histtype, align, orientation, rwidth, log, color, label, stacked, **kwargs)\u001b[39m\n\u001b[32m   7128\u001b[39m \u001b[38;5;66;03m# Loop through datasets\u001b[39;00m\n\u001b[32m   7129\u001b[39m \u001b[38;5;28;01mfor\u001b[39;00m i \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(nx):\n\u001b[32m   7130\u001b[39m     \u001b[38;5;66;03m# this will automatically overwrite bins,\u001b[39;00m\n\u001b[32m   7131\u001b[39m     \u001b[38;5;66;03m# so that each histogram uses the same bins\u001b[39;00m\n\u001b[32m-\u003e \u001b[39m\u001b[32m7132\u001b[39m     m, bins = \u001b[43mnp\u001b[49m\u001b[43m.\u001b[49m\u001b[43mhistogram\u001b[49m\u001b[43m(\u001b[49m\u001b[43mx\u001b[49m\u001b[43m[\u001b[49m\u001b[43mi\u001b[49m\u001b[43m]\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mbins\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mweights\u001b[49m\u001b[43m=\u001b[49m\u001b[43mw\u001b[49m\u001b[43m[\u001b[49m\u001b[43mi\u001b[49m\u001b[43m]\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mhist_kwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   7133\u001b[39m     tops.append(m)\n\u001b[32m   7134\u001b[39m tops = np.array(tops, \u001b[38;5;28mfloat\u001b[39m)  \u001b[38;5;66;03m# causes problems later if it's an int\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/numpy/lib/_histograms_impl.py:792\u001b[39m, in \u001b[36mhistogram\u001b[39m\u001b[34m(a, bins, range, density, weights)\u001b[39m\n\u001b[32m    687\u001b[39m \u001b[38;5;250m\u001b[39m\u001b[33mr\u001b[39m\u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m    688\u001b[39m \u001b[33;03mCompute the histogram of a dataset.\u001b[39;00m\n\u001b[32m    689\u001b[39m \n\u001b[32m   (...)\u001b[39m\u001b[32m    788\u001b[39m \n\u001b[32m    789\u001b[39m \u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m    790\u001b[39m a, weights = _ravel_and_check_weights(a, weights)\n\u001b[32m--\u003e \u001b[39m\u001b[32m792\u001b[39m bin_edges, uniform_bins = \u001b[43m_get_bin_edges\u001b[49m\u001b[43m(\u001b[49m\u001b[43ma\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mbins\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mrange\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mweights\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    794\u001b[39m \u001b[38;5;66;03m# Histogram is an integer or a float array depending on the weights.\u001b[39;00m\n\u001b[32m    795\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m weights \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/numpy/lib/_histograms_impl.py:449\u001b[39m, in \u001b[36m_get_bin_edges\u001b[39m\u001b[34m(a, bins, range, weights)\u001b[39m\n\u001b[32m    445\u001b[39m     bin_edges = np.linspace(\n\u001b[32m    446\u001b[39m         first_edge, last_edge, n_equal_bins + \u001b[32m1\u001b[39m,\n\u001b[32m    447\u001b[39m         endpoint=\u001b[38;5;28;01mTrue\u001b[39;00m, dtype=bin_type)\n\u001b[32m    448\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m np.any(bin_edges[:-\u001b[32m1\u001b[39m] \u003e= bin_edges[\u001b[32m1\u001b[39m:]):\n\u001b[32m--\u003e \u001b[39m\u001b[32m449\u001b[39m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[32m    450\u001b[39m             \u001b[33mf\u001b[39m\u001b[33m'\u001b[39m\u001b[33mToo many bins for data range. Cannot create \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mn_equal_bins\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m \u001b[39m\u001b[33m'\u001b[39m\n\u001b[32m    451\u001b[39m             \u001b[33mf\u001b[39m\u001b[33m'\u001b[39m\u001b[33mfinite-sized bins.\u001b[39m\u001b[33m'\u001b[39m)\n\u001b[32m    452\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m bin_edges, (first_edge, last_edge, n_equal_bins)\n\u001b[32m    453\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\n\u001b[31mValueError\u001b[39m: Too many bins for data range. Cannot create 10 finite-sized bins."},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f4b04bbcde8a212dbc2cd49756eeee1c","path":"/NISAR_GCOV_Cookbook/build/f4b04bbcde8a212dbc2cd49756eeee1c.png"},"text/plain":{"content":"\u003cFigure size 1400x400 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"MqPQYBJ0uZ"}],"key":"TgVGmsep3W"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"With a threshold of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qXE3LS8QvX"},{"type":"inlineMath","value":"t=CDF_{CV} \u003e 0.95","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003eC\u003c/mi\u003e\u003cmi\u003eD\u003c/mi\u003e\u003cmsub\u003e\u003cmi\u003eF\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003eC\u003c/mi\u003e\u003cmi\u003eV\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmo\u003e\u0026gt;\u003c/mo\u003e\u003cmn\u003e0.95\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003et=CDF_{CV} \u0026gt; 0.95\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6151em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\"\u003eC\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003eD\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eF\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3283em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\"\u003eC\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\"\u003eV\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0.95\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"G3VzvyZYiG"},{"type":"text","value":" (5% pixels with highest variance) the change pixels would look like the following image:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GJnKlYiDwA"}],"key":"oqd2peOfX7"}],"key":"CUraTLXZKw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"metric = 'CV'\nmasks[metric] = plot_threshold_classifier(metric=metric)","key":"nlS6evYrH4"},{"type":"output","id":"QYs5zoNqKmBEjkFArBM4o","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cbca4bf5566363a3beff8fda9ee98427","path":"/NISAR_GCOV_Cookbook/build/cbca4bf5566363a3beff8fda9ee98427.png"},"text/plain":{"content":"\u003cFigure size 800x800 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"aaemBxicCw"}],"key":"ALqbMKodRK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"6.3 Pair-wise change detection","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IFFRqCxv30"}],"identifier":"id-6-3-pair-wise-change-detection","label":"6.3 Pair-wise change detection","html_id":"id-6-3-pair-wise-change-detection","implicit":true,"key":"NZTIqSpir1"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To analyze temporal changes between two images, it is useful to compute metrics that are sensitive to discrepancies between the two images. In radar remote sensing, the standard way is to look at ratios (in the linearly scaled power domain) or, equivalently, at differences in the logarithmic dB domain.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"S95WfAxcuv"}],"key":"OMCRPylUnU"}],"key":"WGrsjeMdWR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# dates = ('2018-05-27', '2018-06-08') # around first eruption\n\n# # convert to datetime objects\n# dates_ = [datetime.datetime.strptime(date, '%Y-%m-%d') for date in dates]\n\n# # get the indices in one line\n# dates_ind = [np.argmin(np.abs(date - tindex)) for date in dates_]\n# print(f'Comparing image {dates_ind[0]} from {tindex[dates_ind[0]].date()} with {dates_ind[1]} from {tindex[dates_ind[1]].date()}')","key":"DUCjsdDC6R"},{"type":"output","id":"1PobY0dvvI9E-1-51N6d2","data":[],"key":"KxYZ8Gf8tU"}],"key":"GXMs4I5qfy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dates = ('2025-11-03', '2025-11-07') # around first eruption\n\n# convert to datetime objects\ndates_ = [datetime.datetime.strptime(date, '%Y-%m-%d') for date in dates]\n\n# get the indices in one line\ndates_ind = [np.argmin(np.abs(date - tindex)) for date in dates_]\nprint(f'Comparing image {dates_ind[0]} from {tindex[dates_ind[0]].date()} with {dates_ind[1]} from {tindex[dates_ind[1]].date()}')","key":"cFVlLUUz0X"},{"type":"output","id":"gFhk93N9iyRY91dzase9C","data":[],"key":"R3FNo1ryfs"}],"key":"qoc1U2CW6U"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"da.time","key":"UfDRbietXI"},{"type":"output","id":"C5_gMtq6oz4efN0k-U7CR","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\u003csvg style=\"position: absolute; width: 0; height: 0; overflow: hidden\"\u003e\n\u003cdefs\u003e\n\u003csymbol id=\"icon-database\" viewBox=\"0 0 32 32\"\u003e\n\u003cpath d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"\u003e\u003c/path\u003e\n\u003c/symbol\u003e\n\u003csymbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\"\u003e\n\u003cpath d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003c/symbol\u003e\n\u003c/defs\u003e\n\u003c/svg\u003e\n\u003cstyle\u003e/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header \u003e div,\n.xr-header \u003e ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary \u003e span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label \u003e span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap \u003e label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item \u003e div,\n.xr-var-item label,\n.xr-var-item \u003e .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item \u003e .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list \u003e li:nth-child(odd) \u003e div,\n.xr-var-list \u003e li:nth-child(odd) \u003e label,\n.xr-var-list \u003e li:nth-child(odd) \u003e .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data \u003e table {\n  float: right;\n}\n\n.xr-var-data \u003e pre,\n.xr-index-data \u003e pre,\n.xr-var-data \u003e table \u003e tbody \u003e tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label \u003e .xr-icon-file-text2,\n.xr-var-data-in:checked + label \u003e .xr-icon-database,\n.xr-index-data-in:checked + label \u003e .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n\u003c/style\u003e\u003cpre class='xr-text-repr-fallback'\u003e\u0026lt;xarray.DataArray \u0026#x27;time\u0026#x27; (time: 8)\u0026gt; Size: 64B\narray([\u0026#x27;2025-11-02T22:06:39.000000000\u0026#x27;, \u0026#x27;2025-11-03T22:06:39.000000000\u0026#x27;,\n       \u0026#x27;2025-11-04T22:06:39.000000000\u0026#x27;, \u0026#x27;2025-11-05T22:06:39.000000000\u0026#x27;,\n       \u0026#x27;2025-11-06T22:06:39.000000000\u0026#x27;, \u0026#x27;2025-11-07T22:06:39.000000000\u0026#x27;,\n       \u0026#x27;2025-11-08T22:06:39.000000000\u0026#x27;, \u0026#x27;2025-11-09T22:06:39.000000000\u0026#x27;],\n      dtype=\u0026#x27;datetime64[ns]\u0026#x27;)\nCoordinates:\n    frequency  \u0026lt;U1 4B \u0026#x27;A\u0026#x27;\n  * time       (time) datetime64[ns] 64B 2025-11-02T22:06:39 ... 2025-11-09T2...\u003c/pre\u003e\u003cdiv class='xr-wrap' style='display:none'\u003e\u003cdiv class='xr-header'\u003e\u003cdiv class='xr-obj-type'\u003exarray.DataArray\u003c/div\u003e\u003cdiv class='xr-array-name'\u003e'time'\u003c/div\u003e\u003cul class='xr-dim-list'\u003e\u003cli\u003e\u003cspan class='xr-has-index'\u003etime\u003c/span\u003e: 8\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003cul class='xr-sections'\u003e\u003cli class='xr-section-item'\u003e\u003cdiv class='xr-array-wrap'\u003e\u003cinput id='section-3d3b4f1c-cc7a-4a07-ad44-6b4e1def7842' class='xr-array-in' type='checkbox' checked\u003e\u003clabel for='section-3d3b4f1c-cc7a-4a07-ad44-6b4e1def7842' title='Show/hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-array-preview xr-preview'\u003e\u003cspan\u003e2025-11-02T22:06:39 2025-11-03T22:06:39 ... 2025-11-09T22:06:39\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-array-data'\u003e\u003cpre\u003earray([\u0026#x27;2025-11-02T22:06:39.000000000\u0026#x27;, \u0026#x27;2025-11-03T22:06:39.000000000\u0026#x27;,\n       \u0026#x27;2025-11-04T22:06:39.000000000\u0026#x27;, \u0026#x27;2025-11-05T22:06:39.000000000\u0026#x27;,\n       \u0026#x27;2025-11-06T22:06:39.000000000\u0026#x27;, \u0026#x27;2025-11-07T22:06:39.000000000\u0026#x27;,\n       \u0026#x27;2025-11-08T22:06:39.000000000\u0026#x27;, \u0026#x27;2025-11-09T22:06:39.000000000\u0026#x27;],\n      dtype=\u0026#x27;datetime64[ns]\u0026#x27;)\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-ff0633b3-4d6c-4a80-aca6-e41d91708465' class='xr-section-summary-in' type='checkbox'  checked\u003e\u003clabel for='section-ff0633b3-4d6c-4a80-aca6-e41d91708465' class='xr-section-summary' \u003eCoordinates: \u003cspan\u003e(2)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cul class='xr-var-list'\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan\u003efrequency\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e()\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003e\u0026lt;U1\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e\u0026#x27;A\u0026#x27;\u003c/div\u003e\u003cinput id='attrs-398614ec-4da9-4444-9cb3-80e8c0d7d217' class='xr-var-attrs-in' type='checkbox' disabled\u003e\u003clabel for='attrs-398614ec-4da9-4444-9cb3-80e8c0d7d217' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-04ef3e1b-6a45-4305-8a3e-7e4b3abb9e65' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-04ef3e1b-6a45-4305-8a3e-7e4b3abb9e65' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray(\u0026#x27;A\u0026#x27;, dtype=\u0026#x27;\u0026lt;U1\u0026#x27;)\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan class='xr-has-index'\u003etime\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e(time)\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003edatetime64[ns]\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e2025-11-02T22:06:39 ... 2025-11-...\u003c/div\u003e\u003cinput id='attrs-b44bbaec-940d-420c-8d6c-d8ab2b47cd60' class='xr-var-attrs-in' type='checkbox' disabled\u003e\u003clabel for='attrs-b44bbaec-940d-420c-8d6c-d8ab2b47cd60' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-7dbb329b-9f04-4940-8c23-8edafddaab83' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-7dbb329b-9f04-4940-8c23-8edafddaab83' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray([\u0026#x27;2025-11-02T22:06:39.000000000\u0026#x27;, \u0026#x27;2025-11-03T22:06:39.000000000\u0026#x27;,\n       \u0026#x27;2025-11-04T22:06:39.000000000\u0026#x27;, \u0026#x27;2025-11-05T22:06:39.000000000\u0026#x27;,\n       \u0026#x27;2025-11-06T22:06:39.000000000\u0026#x27;, \u0026#x27;2025-11-07T22:06:39.000000000\u0026#x27;,\n       \u0026#x27;2025-11-08T22:06:39.000000000\u0026#x27;, \u0026#x27;2025-11-09T22:06:39.000000000\u0026#x27;],\n      dtype=\u0026#x27;datetime64[ns]\u0026#x27;)\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-668661ac-428b-4cfe-bdd7-b40845dd245f' class='xr-section-summary-in' type='checkbox'  \u003e\u003clabel for='section-668661ac-428b-4cfe-bdd7-b40845dd245f' class='xr-section-summary' \u003eIndexes: \u003cspan\u003e(1)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cul class='xr-var-list'\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-index-name'\u003e\u003cdiv\u003etime\u003c/div\u003e\u003c/div\u003e\u003cdiv class='xr-index-preview'\u003ePandasIndex\u003c/div\u003e\u003cinput type='checkbox' disabled/\u003e\u003clabel\u003e\u003c/label\u003e\u003cinput id='index-15fd1a1a-fdd5-4e40-8431-5a591dc5383b' class='xr-index-data-in' type='checkbox'/\u003e\u003clabel for='index-15fd1a1a-fdd5-4e40-8431-5a591dc5383b' title='Show/Hide index repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-index-data'\u003e\u003cpre\u003ePandasIndex(DatetimeIndex([\u0026#x27;2025-11-02 22:06:39\u0026#x27;, \u0026#x27;2025-11-03 22:06:39\u0026#x27;,\n               \u0026#x27;2025-11-04 22:06:39\u0026#x27;, \u0026#x27;2025-11-05 22:06:39\u0026#x27;,\n               \u0026#x27;2025-11-06 22:06:39\u0026#x27;, \u0026#x27;2025-11-07 22:06:39\u0026#x27;,\n               \u0026#x27;2025-11-08 22:06:39\u0026#x27;, \u0026#x27;2025-11-09 22:06:39\u0026#x27;],\n              dtype=\u0026#x27;datetime64[ns]\u0026#x27;, name=\u0026#x27;time\u0026#x27;, freq=\u0026#x27;D\u0026#x27;))\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-3997733e-28ce-4651-a1b4-0b4e812c797f' class='xr-section-summary-in' type='checkbox' disabled \u003e\u003clabel for='section-3997733e-28ce-4651-a1b4-0b4e812c797f' class='xr-section-summary'  title='Expand/collapse section'\u003eAttributes: \u003cspan\u003e(0)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cdl class='xr-attrs'\u003e\u003c/dl\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"\u003cxarray.DataArray 'time' (time: 8)\u003e Size: 64B\narray(['2025-11-02T22:06:39.000000000', '2025-11-03T22:06:39.000000000',\n       '2025-11-04T22:06:39.000000000', '2025-11-05T22:06:39.000000000',\n       '2025-11-06T22:06:39.000000000', '2025-11-07T22:06:39.000000000',\n       '2025-11-08T22:06:39.000000000', '2025-11-09T22:06:39.000000000'],\n      dtype='datetime64[ns]')\nCoordinates:\n    frequency  \u003cU1 4B 'A'\n  * time       (time) datetime64[ns] 64B 2025-11-02T22:06:39 ... 2025-11-09T2...","content_type":"text/plain"}}}],"key":"LK6LzMbh9u"}],"key":"vpMJ6Yk1UY"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compute the log ratio in dB","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FFVGehVTXl"}],"key":"tHrN2nLPPB"},{"type":"text","value":", corresponding to the difference in dB","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yUPYZZ04on"}],"key":"XD5mbbPuav"}],"key":"Wt88xAKzgN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# ratiodB = 10 * np.ma.log10(np.ma.divide(rasterstack[dates_ind[1], ...], rasterstack[dates_ind[0], ...]))","key":"wqhQPIA9jT"},{"type":"output","id":"lqNyWdT3w7DZIA12y74aZ","data":[],"key":"u1OA3jGKbk"}],"key":"r8CMUfAkIk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"date_0 = da.sel(time=\"2025-11-03\").squeeze(\"time\", drop=True)\ndate_1 = da.sel(time=\"2025-11-07\").squeeze(\"time\", drop=True)\n\nratiodB = 10 * np.log10(date_1 / date_0)\nratiodB","key":"QAeLJZcCv4"},{"type":"output","id":"5EiUkOkzWDmYuNBeFIx0H","data":[{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\u003csvg style=\"position: absolute; width: 0; height: 0; overflow: hidden\"\u003e\n\u003cdefs\u003e\n\u003csymbol id=\"icon-database\" viewBox=\"0 0 32 32\"\u003e\n\u003cpath d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"\u003e\u003c/path\u003e\n\u003c/symbol\u003e\n\u003csymbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\"\u003e\n\u003cpath d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003c/symbol\u003e\n\u003c/defs\u003e\n\u003c/svg\u003e\n\u003cstyle\u003e/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header \u003e div,\n.xr-header \u003e ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary \u003e span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label \u003e span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap \u003e label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item \u003e div,\n.xr-var-item label,\n.xr-var-item \u003e .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item \u003e .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list \u003e li:nth-child(odd) \u003e div,\n.xr-var-list \u003e li:nth-child(odd) \u003e label,\n.xr-var-list \u003e li:nth-child(odd) \u003e .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data \u003e table {\n  float: right;\n}\n\n.xr-var-data \u003e pre,\n.xr-index-data \u003e pre,\n.xr-var-data \u003e table \u003e tbody \u003e tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label \u003e .xr-icon-file-text2,\n.xr-var-data-in:checked + label \u003e .xr-icon-database,\n.xr-index-data-in:checked + label \u003e .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n\u003c/style\u003e\u003cpre class='xr-text-repr-fallback'\u003e\u0026lt;xarray.DataArray \u0026#x27;HVHV\u0026#x27; (y: 5000, x: 5000)\u0026gt; Size: 200MB\ndask.array\u0026lt;mul, shape=(5000, 5000), dtype=float64, chunksize=(2048, 2048), chunktype=numpy.ndarray\u0026gt;\nCoordinates:\n    frequency  \u0026lt;U1 4B \u0026#x27;A\u0026#x27;\n  * y          (y) float64 40kB 9.7e+06 9.7e+06 9.7e+06 ... 9.6e+06 9.6e+06\n  * x          (x) float64 40kB 4e+05 4e+05 4e+05 ... 5e+05 5e+05 5e+05\u003c/pre\u003e\u003cdiv class='xr-wrap' style='display:none'\u003e\u003cdiv class='xr-header'\u003e\u003cdiv class='xr-obj-type'\u003exarray.DataArray\u003c/div\u003e\u003cdiv class='xr-array-name'\u003e'HVHV'\u003c/div\u003e\u003cul class='xr-dim-list'\u003e\u003cli\u003e\u003cspan class='xr-has-index'\u003ey\u003c/span\u003e: 5000\u003c/li\u003e\u003cli\u003e\u003cspan class='xr-has-index'\u003ex\u003c/span\u003e: 5000\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003cul class='xr-sections'\u003e\u003cli class='xr-section-item'\u003e\u003cdiv class='xr-array-wrap'\u003e\u003cinput id='section-f9a52b78-a240-4314-85e3-c09d3a0d3f5b' class='xr-array-in' type='checkbox' checked\u003e\u003clabel for='section-f9a52b78-a240-4314-85e3-c09d3a0d3f5b' title='Show/hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-array-preview xr-preview'\u003e\u003cspan\u003edask.array\u0026lt;chunksize=(212, 656), meta=np.ndarray\u0026gt;\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-array-data'\u003e\u003ctable\u003e\n    \u003ctr\u003e\n        \u003ctd\u003e\n            \u003ctable style=\"border-collapse: collapse;\"\u003e\n                \u003cthead\u003e\n                    \u003ctr\u003e\n                        \u003ctd\u003e \u003c/td\u003e\n                        \u003cth\u003e Array \u003c/th\u003e\n                        \u003cth\u003e Chunk \u003c/th\u003e\n                    \u003c/tr\u003e\n                \u003c/thead\u003e\n                \u003ctbody\u003e\n                    \n                    \u003ctr\u003e\n                        \u003cth\u003e Bytes \u003c/th\u003e\n                        \u003ctd\u003e 190.73 MiB \u003c/td\u003e\n                        \u003ctd\u003e 32.00 MiB \u003c/td\u003e\n                    \u003c/tr\u003e\n                    \n                    \u003ctr\u003e\n                        \u003cth\u003e Shape \u003c/th\u003e\n                        \u003ctd\u003e (5000, 5000) \u003c/td\u003e\n                        \u003ctd\u003e (2048, 2048) \u003c/td\u003e\n                    \u003c/tr\u003e\n                    \u003ctr\u003e\n                        \u003cth\u003e Dask graph \u003c/th\u003e\n                        \u003ctd colspan=\"2\"\u003e 16 chunks in 63 graph layers \u003c/td\u003e\n                    \u003c/tr\u003e\n                    \u003ctr\u003e\n                        \u003cth\u003e Data type \u003c/th\u003e\n                        \u003ctd colspan=\"2\"\u003e float64 numpy.ndarray \u003c/td\u003e\n                    \u003c/tr\u003e\n                \u003c/tbody\u003e\n            \u003c/table\u003e\n        \u003c/td\u003e\n        \u003ctd\u003e\n        \u003csvg width=\"170\" height=\"170\" style=\"stroke:rgb(0,0,0);stroke-width:1\" \u003e\n\n  \u003c!-- Horizontal lines --\u003e\n  \u003cline x1=\"0\" y1=\"0\" x2=\"120\" y2=\"0\" style=\"stroke-width:2\" /\u003e\n  \u003cline x1=\"0\" y1=\"5\" x2=\"120\" y2=\"5\" /\u003e\n  \u003cline x1=\"0\" y1=\"54\" x2=\"120\" y2=\"54\" /\u003e\n  \u003cline x1=\"0\" y1=\"103\" x2=\"120\" y2=\"103\" /\u003e\n  \u003cline x1=\"0\" y1=\"120\" x2=\"120\" y2=\"120\" style=\"stroke-width:2\" /\u003e\n\n  \u003c!-- Vertical lines --\u003e\n  \u003cline x1=\"0\" y1=\"0\" x2=\"0\" y2=\"120\" style=\"stroke-width:2\" /\u003e\n  \u003cline x1=\"15\" y1=\"0\" x2=\"15\" y2=\"120\" /\u003e\n  \u003cline x1=\"64\" y1=\"0\" x2=\"64\" y2=\"120\" /\u003e\n  \u003cline x1=\"114\" y1=\"0\" x2=\"114\" y2=\"120\" /\u003e\n  \u003cline x1=\"120\" y1=\"0\" x2=\"120\" y2=\"120\" style=\"stroke-width:2\" /\u003e\n\n  \u003c!-- Colored Rectangle --\u003e\n  \u003cpolygon points=\"0.0,0.0 120.0,0.0 120.0,120.0 0.0,120.0\" style=\"fill:#ECB172A0;stroke-width:0\"/\u003e\n\n  \u003c!-- Text --\u003e\n  \u003ctext x=\"60.000000\" y=\"140.000000\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" \u003e5000\u003c/text\u003e\n  \u003ctext x=\"140.000000\" y=\"60.000000\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(-90,140.000000,60.000000)\"\u003e5000\u003c/text\u003e\n\u003c/svg\u003e\n        \u003c/td\u003e\n    \u003c/tr\u003e\n\u003c/table\u003e\u003c/div\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-3f559d0e-8f82-41d8-b52f-09773ae073c7' class='xr-section-summary-in' type='checkbox'  checked\u003e\u003clabel for='section-3f559d0e-8f82-41d8-b52f-09773ae073c7' class='xr-section-summary' \u003eCoordinates: \u003cspan\u003e(3)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cul class='xr-var-list'\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan\u003efrequency\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e()\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003e\u0026lt;U1\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e\u0026#x27;A\u0026#x27;\u003c/div\u003e\u003cinput id='attrs-8a048e28-09c7-400c-a506-d1f41ff5a089' class='xr-var-attrs-in' type='checkbox' disabled\u003e\u003clabel for='attrs-8a048e28-09c7-400c-a506-d1f41ff5a089' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-8a8dab7b-c229-4261-bf46-5ae4d88bcca3' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-8a8dab7b-c229-4261-bf46-5ae4d88bcca3' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray(\u0026#x27;A\u0026#x27;, dtype=\u0026#x27;\u0026lt;U1\u0026#x27;)\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan class='xr-has-index'\u003ey\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e(y)\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003efloat64\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e9.7e+06 9.7e+06 ... 9.6e+06 9.6e+06\u003c/div\u003e\u003cinput id='attrs-e3aeb079-7841-4629-bb68-13ca10e85394' class='xr-var-attrs-in' type='checkbox' disabled\u003e\u003clabel for='attrs-e3aeb079-7841-4629-bb68-13ca10e85394' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-ff69b130-b014-4649-96fc-056997bd1acb' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-ff69b130-b014-4649-96fc-056997bd1acb' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray([9699990., 9699970., 9699950., ..., 9600050., 9600030., 9600010.],\n      shape=(5000,))\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan class='xr-has-index'\u003ex\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e(x)\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003efloat64\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e4e+05 4e+05 4e+05 ... 5e+05 5e+05\u003c/div\u003e\u003cinput id='attrs-ed0f6bf4-8031-4769-83c4-fa0f3d99bd93' class='xr-var-attrs-in' type='checkbox' disabled\u003e\u003clabel for='attrs-ed0f6bf4-8031-4769-83c4-fa0f3d99bd93' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-72e5edc6-d857-483a-bc0f-691d9d990f32' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-72e5edc6-d857-483a-bc0f-691d9d990f32' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray([400010., 400030., 400050., ..., 499950., 499970., 499990.],\n      shape=(5000,))\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-c369deb1-f96c-4f9d-80f5-4f8b452fe37a' class='xr-section-summary-in' type='checkbox'  \u003e\u003clabel for='section-c369deb1-f96c-4f9d-80f5-4f8b452fe37a' class='xr-section-summary' \u003eIndexes: \u003cspan\u003e(2)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cul class='xr-var-list'\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-index-name'\u003e\u003cdiv\u003ey\u003c/div\u003e\u003c/div\u003e\u003cdiv class='xr-index-preview'\u003ePandasIndex\u003c/div\u003e\u003cinput type='checkbox' disabled/\u003e\u003clabel\u003e\u003c/label\u003e\u003cinput id='index-a3a45f3f-50b8-4b32-8bb7-d2dd4c346bed' class='xr-index-data-in' type='checkbox'/\u003e\u003clabel for='index-a3a45f3f-50b8-4b32-8bb7-d2dd4c346bed' title='Show/Hide index repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-index-data'\u003e\u003cpre\u003ePandasIndex(Index([9699990.0, 9699970.0, 9699950.0, 9699930.0, 9699910.0, 9699890.0,\n       9699870.0, 9699850.0, 9699830.0, 9699810.0,\n       ...\n       9600190.0, 9600170.0, 9600150.0, 9600130.0, 9600110.0, 9600090.0,\n       9600070.0, 9600050.0, 9600030.0, 9600010.0],\n      dtype=\u0026#x27;float64\u0026#x27;, name=\u0026#x27;y\u0026#x27;, length=5000))\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-index-name'\u003e\u003cdiv\u003ex\u003c/div\u003e\u003c/div\u003e\u003cdiv class='xr-index-preview'\u003ePandasIndex\u003c/div\u003e\u003cinput type='checkbox' disabled/\u003e\u003clabel\u003e\u003c/label\u003e\u003cinput id='index-67dda30f-896a-4a23-9c20-01595a1108e7' class='xr-index-data-in' type='checkbox'/\u003e\u003clabel for='index-67dda30f-896a-4a23-9c20-01595a1108e7' title='Show/Hide index repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-index-data'\u003e\u003cpre\u003ePandasIndex(Index([400010.0, 400030.0, 400050.0, 400070.0, 400090.0, 400110.0, 400130.0,\n       400150.0, 400170.0, 400190.0,\n       ...\n       499810.0, 499830.0, 499850.0, 499870.0, 499890.0, 499910.0, 499930.0,\n       499950.0, 499970.0, 499990.0],\n      dtype=\u0026#x27;float64\u0026#x27;, name=\u0026#x27;x\u0026#x27;, length=5000))\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-b7a7e907-f118-4bd0-b679-bea98b9c8a9d' class='xr-section-summary-in' type='checkbox' disabled \u003e\u003clabel for='section-b7a7e907-f118-4bd0-b679-bea98b9c8a9d' class='xr-section-summary'  title='Expand/collapse section'\u003eAttributes: \u003cspan\u003e(0)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cdl class='xr-attrs'\u003e\u003c/dl\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"\u003cxarray.DataArray 'HVHV' (y: 5000, x: 5000)\u003e Size: 200MB\ndask.array\u003cmul, shape=(5000, 5000), dtype=float64, chunksize=(2048, 2048), chunktype=numpy.ndarray\u003e\nCoordinates:\n    frequency  \u003cU1 4B 'A'\n  * y          (y) float64 40kB 9.7e+06 9.7e+06 9.7e+06 ... 9.6e+06 9.6e+06\n  * x          (x) float64 40kB 4e+05 4e+05 4e+05 ... 5e+05 5e+05 5e+05","content_type":"text/plain"}}}],"key":"hRKTNzkPrs"}],"key":"DFA8yiBS3Z"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let us manually choose a threshold this time","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GbfTA7cNBa"}],"key":"lhp2DW9irt"}],"key":"wjjXos5EC7"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"thresh is the threshold, e.g. -2 dB","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Q4SdPY8SFR"}],"key":"ISCLeeAfMs"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"thresh_type determines whether we mask everything below that (lower) or above (upper)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LZLFktp5Pn"}],"key":"NsSQpexRsX"}],"key":"cXWVvTfg1J"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# thresh = -2\n# thresh_type = 'lower' #'lower': mask everything below thresh, 'upper': mask everything above\n\n# copy_absRatiod = np.copy(np.abs(ratiodB))\n# # dynamic_range = np.nanpercentile(np.abs(ratiodB), 99)\n# dynamic_range = np.nanpercentile(copy_absRatiod, 99)\n# fig, axs = plt.subplots(ncols=3, nrows=1)\n# fig.set_size_inches(20, 4)\n# plt.subplots_adjust(hspace=0.4, right=0.85)\n\n# # h = axs[0].hist(\n# #         ratiodB.flatten(), bins=200, range=np.nanpercentile(ratiodB, [0.1, 99.9]))\n\n# h = axs[0].hist(\n#         ratiodB.flatten(), bins=200, range=np.nanpercentile(np.copy(ratiodB), [0.1, 99.9]))\n\n# axs[0].xaxis.set_label_text(f'difference [dB]')\n# axs[0].set_title('Histogram')\n# im0 = axs[1].imshow(ratiodB, cmap='RdBu', vmin=-dynamic_range, vmax=dynamic_range)\n# cbar = fig.colorbar(im0, orientation='vertical', ax=axs.ravel().tolist(), shrink=0.7)\n# cbar.set_label('[dB]')\n# axs[1].set_title('Image')\n# mask = (ratiodB \u003e thresh if thresh_type == 'lower' else ratiodB \u003c thresh).astype(np.int8)\n# axs[2].imshow(mask, cmap='gray')\n# axs[2].set_title('Mask')\n# fig.suptitle(f'{tindex[dates_ind[0]].date()} {tindex[dates_ind[0]].date()}')\n# logratiolabel = f'logratio_{tindex[dates_ind[0]].date()}_{tindex[dates_ind[0]].date()}'\n# plt.savefig(product_path/f'{logratiolabel}.png',\n#             dpi=200, transparent='true')\n# masks[logratiolabel] = np.logical_not(mask)","key":"zQEsPZPnKp"},{"type":"output","id":"VEDpjXx1wIKF2AAiGuS2o","data":[],"key":"uhr50lKnd5"}],"key":"OYgNUROIlW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# np.nanpercentile(np.copy(ratiodB), [0.1, 99.9])\nlow, high = (ratiodB.quantile([0.01, 0.99]))\nlow.compute().item()","key":"Bh6c6YsROV"},{"type":"output","id":"XNJ2M-zR93dlzQFzLS9Am","data":[{"output_type":"execute_result","execution_count":92,"metadata":{},"data":{"text/plain":{"content":"-2.417687692831179","content_type":"text/plain"}}}],"key":"Vb2ozuRRuI"}],"key":"VsWC8em4Em"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"high.compute().item()","key":"phL77mdwWQ"},{"type":"output","id":"xOtOCLMcY_N4sF8V-4c2c","data":[{"output_type":"execute_result","execution_count":93,"metadata":{},"data":{"text/plain":{"content":"-2.417687692831178","content_type":"text/plain"}}}],"key":"YQFHa6Csmt"}],"key":"E0UOJQIqA1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"thresh = -2\na = ratiodB \u003c thresh\na.max().compute().item()","key":"HiVbRKmnup"},{"type":"output","id":"m3Q_JygmUut1yF4SUtDkk","data":[{"output_type":"execute_result","execution_count":99,"metadata":{},"data":{"text/plain":{"content":"True","content_type":"text/plain"}}}],"key":"ucucTBuiI9"}],"key":"PLSFFyJ7Hu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"thresh = -2\nthresh_type = 'lower' #'lower': mask everything below thresh, 'upper': mask everything above\n\nabs_ratiodB = np.abs(ratiodB)\ndynamic_range = abs_ratiodB.quantile(0.99, skipna=True).compute().item()\n\n\nfig, axs = plt.subplots(ncols=3, nrows=1)\nfig.set_size_inches(20, 4)\nplt.subplots_adjust(hspace=0.4, right=0.85)\n\n# h = axs[0].hist(\n#         ratiodB.flatten(), bins=200, range=np.nanpercentile(ratiodB, [0.1, 99.9]))\n\naxs[0].hist(\n        ratiodB.values.ravel(), bins=10, range=np.nanpercentile(ratiodB, [0.1, 99.9]))\n\naxs[0].xaxis.set_label_text(f'difference [dB]')\naxs[0].set_title('Histogram')\n\nim0 = axs[1].imshow(ratiodB, cmap='RdBu', vmin=-dynamic_range, vmax=dynamic_range)\ncbar = fig.colorbar(im0, orientation='vertical', ax=axs.ravel().tolist(), shrink=0.7)\ncbar.set_label('[dB]')\naxs[1].set_title('Image')\n\nmask = (ratiodB \u003e thresh if thresh_type == 'lower' else ratiodB \u003c thresh).astype(np.int8)\n\naxs[2].imshow(mask, cmap='gray')\naxs[2].set_title('Mask')\nfig.suptitle(f'{tindex[dates_ind[0]].date()} {tindex[dates_ind[0]].date()}')\nlogratiolabel = f'logratio_{tindex[dates_ind[0]].date()}_{tindex[dates_ind[0]].date()}'\nplt.savefig(product_path/f'{logratiolabel}.png',\n            dpi=200, transparent='true')\nmasks[logratiolabel] = np.logical_not(mask)","key":"M9smk8jqwa"},{"type":"output","id":"gYtS0XHqOa66xdpPkrrTy","data":[{"ename":"ValueError","evalue":"Too many bins for data range. Cannot create 10 finite-sized bins.","output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mValueError\u001b[39m                                Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[101]\u001b[39m\u001b[32m, line 15\u001b[39m\n\u001b[32m     10\u001b[39m plt.subplots_adjust(hspace=\u001b[32m0.4\u001b[39m, right=\u001b[32m0.85\u001b[39m)\n\u001b[32m     12\u001b[39m \u001b[38;5;66;03m# h = axs[0].hist(\u001b[39;00m\n\u001b[32m     13\u001b[39m \u001b[38;5;66;03m#         ratiodB.flatten(), bins=200, range=np.nanpercentile(ratiodB, [0.1, 99.9]))\u001b[39;00m\n\u001b[32m---\u003e \u001b[39m\u001b[32m15\u001b[39m \u001b[43maxs\u001b[49m\u001b[43m[\u001b[49m\u001b[32;43m0\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m.\u001b[49m\u001b[43mhist\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m     16\u001b[39m \u001b[43m        \u001b[49m\u001b[43mratiodB\u001b[49m\u001b[43m.\u001b[49m\u001b[43mvalues\u001b[49m\u001b[43m.\u001b[49m\u001b[43mravel\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mbins\u001b[49m\u001b[43m=\u001b[49m\u001b[32;43m10\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mrange\u001b[39;49m\u001b[43m=\u001b[49m\u001b[43mnp\u001b[49m\u001b[43m.\u001b[49m\u001b[43mnanpercentile\u001b[49m\u001b[43m(\u001b[49m\u001b[43mratiodB\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m[\u001b[49m\u001b[32;43m0.1\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[32;43m99.9\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     18\u001b[39m axs[\u001b[32m0\u001b[39m].xaxis.set_label_text(\u001b[33mf\u001b[39m\u001b[33m'\u001b[39m\u001b[33mdifference [dB]\u001b[39m\u001b[33m'\u001b[39m)\n\u001b[32m     19\u001b[39m axs[\u001b[32m0\u001b[39m].set_title(\u001b[33m'\u001b[39m\u001b[33mHistogram\u001b[39m\u001b[33m'\u001b[39m)\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/_api/deprecation.py:453\u001b[39m, in \u001b[36mmake_keyword_only.\u003clocals\u003e.wrapper\u001b[39m\u001b[34m(*args, **kwargs)\u001b[39m\n\u001b[32m    447\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mlen\u001b[39m(args) \u003e name_idx:\n\u001b[32m    448\u001b[39m     warn_deprecated(\n\u001b[32m    449\u001b[39m         since, message=\u001b[33m\"\u001b[39m\u001b[33mPassing the \u001b[39m\u001b[38;5;132;01m%(name)s\u001b[39;00m\u001b[33m \u001b[39m\u001b[38;5;132;01m%(obj_type)s\u001b[39;00m\u001b[33m \u001b[39m\u001b[33m\"\u001b[39m\n\u001b[32m    450\u001b[39m         \u001b[33m\"\u001b[39m\u001b[33mpositionally is deprecated since Matplotlib \u001b[39m\u001b[38;5;132;01m%(since)s\u001b[39;00m\u001b[33m; the \u001b[39m\u001b[33m\"\u001b[39m\n\u001b[32m    451\u001b[39m         \u001b[33m\"\u001b[39m\u001b[33mparameter will become keyword-only in \u001b[39m\u001b[38;5;132;01m%(removal)s\u001b[39;00m\u001b[33m.\u001b[39m\u001b[33m\"\u001b[39m,\n\u001b[32m    452\u001b[39m         name=name, obj_type=\u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[33mparameter of \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mfunc.\u001b[34m__name__\u001b[39m\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m()\u001b[39m\u001b[33m\"\u001b[39m)\n\u001b[32m--\u003e \u001b[39m\u001b[32m453\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mfunc\u001b[49m\u001b[43m(\u001b[49m\u001b[43m*\u001b[49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/__init__.py:1524\u001b[39m, in \u001b[36m_preprocess_data.\u003clocals\u003e.inner\u001b[39m\u001b[34m(ax, data, *args, **kwargs)\u001b[39m\n\u001b[32m   1521\u001b[39m \u001b[38;5;129m@functools\u001b[39m.wraps(func)\n\u001b[32m   1522\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34minner\u001b[39m(ax, *args, data=\u001b[38;5;28;01mNone\u001b[39;00m, **kwargs):\n\u001b[32m   1523\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m data \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[32m-\u003e \u001b[39m\u001b[32m1524\u001b[39m         \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mfunc\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m   1525\u001b[39m \u001b[43m            \u001b[49m\u001b[43max\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1526\u001b[39m \u001b[43m            \u001b[49m\u001b[43m*\u001b[49m\u001b[38;5;28;43mmap\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43mcbook\u001b[49m\u001b[43m.\u001b[49m\u001b[43msanitize_sequence\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43margs\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1527\u001b[39m \u001b[43m            \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43m{\u001b[49m\u001b[43mk\u001b[49m\u001b[43m:\u001b[49m\u001b[43m \u001b[49m\u001b[43mcbook\u001b[49m\u001b[43m.\u001b[49m\u001b[43msanitize_sequence\u001b[49m\u001b[43m(\u001b[49m\u001b[43mv\u001b[49m\u001b[43m)\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mfor\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mk\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mv\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;129;43;01min\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m.\u001b[49m\u001b[43mitems\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m}\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   1529\u001b[39m     bound = new_sig.bind(ax, *args, **kwargs)\n\u001b[32m   1530\u001b[39m     auto_label = (bound.arguments.get(label_namer)\n\u001b[32m   1531\u001b[39m                   \u001b[38;5;129;01mor\u001b[39;00m bound.kwargs.get(label_namer))\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/matplotlib/axes/_axes.py:7132\u001b[39m, in \u001b[36mAxes.hist\u001b[39m\u001b[34m(self, x, bins, range, density, weights, cumulative, bottom, histtype, align, orientation, rwidth, log, color, label, stacked, **kwargs)\u001b[39m\n\u001b[32m   7128\u001b[39m \u001b[38;5;66;03m# Loop through datasets\u001b[39;00m\n\u001b[32m   7129\u001b[39m \u001b[38;5;28;01mfor\u001b[39;00m i \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(nx):\n\u001b[32m   7130\u001b[39m     \u001b[38;5;66;03m# this will automatically overwrite bins,\u001b[39;00m\n\u001b[32m   7131\u001b[39m     \u001b[38;5;66;03m# so that each histogram uses the same bins\u001b[39;00m\n\u001b[32m-\u003e \u001b[39m\u001b[32m7132\u001b[39m     m, bins = \u001b[43mnp\u001b[49m\u001b[43m.\u001b[49m\u001b[43mhistogram\u001b[49m\u001b[43m(\u001b[49m\u001b[43mx\u001b[49m\u001b[43m[\u001b[49m\u001b[43mi\u001b[49m\u001b[43m]\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mbins\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mweights\u001b[49m\u001b[43m=\u001b[49m\u001b[43mw\u001b[49m\u001b[43m[\u001b[49m\u001b[43mi\u001b[49m\u001b[43m]\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mhist_kwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   7133\u001b[39m     tops.append(m)\n\u001b[32m   7134\u001b[39m tops = np.array(tops, \u001b[38;5;28mfloat\u001b[39m)  \u001b[38;5;66;03m# causes problems later if it's an int\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/numpy/lib/_histograms_impl.py:792\u001b[39m, in \u001b[36mhistogram\u001b[39m\u001b[34m(a, bins, range, density, weights)\u001b[39m\n\u001b[32m    687\u001b[39m \u001b[38;5;250m\u001b[39m\u001b[33mr\u001b[39m\u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m    688\u001b[39m \u001b[33;03mCompute the histogram of a dataset.\u001b[39;00m\n\u001b[32m    689\u001b[39m \n\u001b[32m   (...)\u001b[39m\u001b[32m    788\u001b[39m \n\u001b[32m    789\u001b[39m \u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m    790\u001b[39m a, weights = _ravel_and_check_weights(a, weights)\n\u001b[32m--\u003e \u001b[39m\u001b[32m792\u001b[39m bin_edges, uniform_bins = \u001b[43m_get_bin_edges\u001b[49m\u001b[43m(\u001b[49m\u001b[43ma\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mbins\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mrange\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mweights\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    794\u001b[39m \u001b[38;5;66;03m# Histogram is an integer or a float array depending on the weights.\u001b[39;00m\n\u001b[32m    795\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m weights \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.local/envs/uwg_demo/lib/python3.13/site-packages/numpy/lib/_histograms_impl.py:449\u001b[39m, in \u001b[36m_get_bin_edges\u001b[39m\u001b[34m(a, bins, range, weights)\u001b[39m\n\u001b[32m    445\u001b[39m     bin_edges = np.linspace(\n\u001b[32m    446\u001b[39m         first_edge, last_edge, n_equal_bins + \u001b[32m1\u001b[39m,\n\u001b[32m    447\u001b[39m         endpoint=\u001b[38;5;28;01mTrue\u001b[39;00m, dtype=bin_type)\n\u001b[32m    448\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m np.any(bin_edges[:-\u001b[32m1\u001b[39m] \u003e= bin_edges[\u001b[32m1\u001b[39m:]):\n\u001b[32m--\u003e \u001b[39m\u001b[32m449\u001b[39m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[32m    450\u001b[39m             \u001b[33mf\u001b[39m\u001b[33m'\u001b[39m\u001b[33mToo many bins for data range. Cannot create \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mn_equal_bins\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m \u001b[39m\u001b[33m'\u001b[39m\n\u001b[32m    451\u001b[39m             \u001b[33mf\u001b[39m\u001b[33m'\u001b[39m\u001b[33mfinite-sized bins.\u001b[39m\u001b[33m'\u001b[39m)\n\u001b[32m    452\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m bin_edges, (first_edge, last_edge, n_equal_bins)\n\u001b[32m    453\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\n\u001b[31mValueError\u001b[39m: Too many bins for data range. Cannot create 10 finite-sized bins."},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a5c94d99e1bb5465aeabd1ead728728d","path":"/NISAR_GCOV_Cookbook/build/a5c94d99e1bb5465aeabd1ead728728d.png"},"text/plain":{"content":"\u003cFigure size 2000x400 with 3 Axes\u003e","content_type":"text/plain"}}}],"key":"ZzNegisypr"}],"key":"kLbZ9EAYhD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"TMHuEhlOAF"},{"type":"output","id":"BuZa73OJh9LZeH9GHvUI8","data":[],"key":"Vo6MMq7NRU"}],"key":"wM6M6XLOOW"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Do you think the threshold is appropriate? If not, try adjusting it.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"R1dNjfIStE"}],"key":"NLJvsgqkYR"}],"key":"xwMqBMgbCT"}],"key":"EK5V2ylM9B"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OKtwuf7GpH"},{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"7. Write Our Change Detection Results and Metrics Images to GeoTIFF files","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xf7eNmJhxy"}],"identifier":"id-7-write-our-change-detection-results-and-metrics-images-to-geotiff-files","label":"7. Write Our Change Detection Results and Metrics Images to GeoTIFF files","html_id":"id-7-write-our-change-detection-results-and-metrics-images-to-geotiff-files","implicit":true,"key":"zK5leTXX5Y"},{"type":"heading","depth":3,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"7.1 Determine Output Geometry","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"KKes2fYFVJ"}],"identifier":"id-7-1-determine-output-geometry","label":"7.1 Determine Output Geometry","html_id":"id-7-1-determine-output-geometry","implicit":true,"key":"LeVIK0Hd9f"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"First, we need to ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"zdr5iw2G7n"},{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"set the correct geotransformation and projection information","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jCHaw1lVrM"}],"key":"sZgrRZHLLt"},{"type":"text","value":". We retrieve the values from the input images:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"J4cL15TyBD"}],"key":"R4GZt2UGta"}],"key":"r5VqKcJYVv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"proj=img.GetProjection()\ngeotrans=list(img.GetGeoTransform())\ngeotrans","key":"IPw5N3aRgq"},{"type":"output","id":"5ZyKdgFoLpLqdcJlRBntO","data":[],"key":"gvBI8CMWRx"}],"key":"wVPrXPq8VH"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"7.2 Output Time Series Metrics Images","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Icqkh35ciI"}],"identifier":"id-7-2-output-time-series-metrics-images","label":"7.2 Output Time Series Metrics Images","html_id":"id-7-2-output-time-series-metrics-images","implicit":true,"key":"jeYqrJyGEm"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We use the root of the time series data stack name and append a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ftbEcpdbuH"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"ts_metrics","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"V137leXz2p"}],"key":"d03VStpqTz"},{"type":"text","value":"\u003cmetric\u003e.tif ending as filenames:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VqZc6CeRq1"}],"key":"bElUIluz8J"}],"key":"kRTzQmK5w2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Time Series Metrics as image:\n# We make a new subdirectory where we will store the images\n\ndirname = analysis_dir/f\"{str(analysis_dir).split('/')[-1]}_tsmetrics_{pol}\"\nif not dirname.exists():\n    dirname.mkdir()\n\nprint(dirname)","key":"zAvszHzfsd"},{"type":"output","id":"O898Ou1KKGTuDi0yFdpVm","data":[],"key":"fuOexjJaqg"}],"key":"aB8z7em0R6"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we can ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"I5EbFiZYZY"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"output the individual metrics as GeoTIFF images","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NFcAWaAK0e"}],"key":"qtcA4kaDTV"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IZGax1K70e"}],"key":"BoC6orP3Nd"}],"key":"qO7mOmLwRB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"names=[] # List to keep track of all the names\nfor metric in metrics:\n    name_ = dirname/f'{metric}_{labeldB}.tif'\n    create_geotiff(str(name_), metrics[metric], gdal.GDT_Float32, np.nan, [metric],\n                  geo_t=geotrans, projection=proj)\n    names.append(str(name_))","key":"Yded10OV8f"},{"type":"output","id":"_ihWTl7yJ8amnSUwCe9EM","data":[],"key":"h75ZeoLeQt"}],"key":"slusVI05jW"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"7.3 Build a Virtual Raster Table on the Metrics GeoTIFF images","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RMGWslEGWz"}],"identifier":"id-7-3-build-a-virtual-raster-table-on-the-metrics-geotiff-images","label":"7.3 Build a Virtual Raster Table on the Metrics GeoTIFF images","html_id":"id-7-3-build-a-virtual-raster-table-on-the-metrics-geotiff-images","implicit":true,"key":"Cg3Pw4aG1l"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To tie the images into one new raster stack of time series metrics we build a virtual raster table with all the metrics.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"veSX7aoLMH"}],"key":"SY0l38T9jX"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Trick: Use ’ '.join(names) to build one long string of names separated by a space as input to ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dycTxDy3UU"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"gdalbuildvrt","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xAZ0up7laH"}],"key":"dIbMglyzVf"},{"type":"text","value":":","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"aAUK1nDKUJ"}],"key":"O3xIlgTOCk"}],"key":"xJf9a9bFCa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cmd=f'gdalbuildvrt -separate -overwrite -vrtnodata nan {str(dirname)}' +\\\nf'_{labeldB}.vrt '+' '.join(names)\nprint(cmd)\n\n_ = system(cmd)","key":"BwxqJMBvw7"},{"type":"output","id":"CMVXhuiKyHnUVK_jjp97Q","data":[],"key":"UyQs65nzsq"}],"key":"UnI7t3rbQ2"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"7.4 Create GeoTIFFs for the Change Iamges from our Four Change Detection Attempts","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FXA0vUR2ec"}],"identifier":"id-7-4-create-geotiffs-for-the-change-iamges-from-our-four-change-detection-attempts","label":"7.4 Create GeoTIFFs for the Change Iamges from our Four Change Detection Attempts","html_id":"id-7-4-create-geotiffs-for-the-change-iamges-from-our-four-change-detection-attempts","implicit":true,"key":"K4XrEGdNO2"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We are going to write GeoTIFF output files that stores the results from the classifiers:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZVReNx7xRT"}],"key":"RQpDefsJyt"}],"key":"AL9Jz4vR5j"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for metric in masks:  \n    fnmetric = dirname/f\"{str(analysis_dir).split('/')[-1]}_{labeldB}_{metric}_thresholds.tif\"\n    print(fnmetric)\n\n    create_geotiff(str(fnmetric), masks[metric], gdal.GDT_Byte, np.nan, \n                  geo_t=geotrans, projection=proj)","key":"klbnumcd33"},{"type":"output","id":"4AQ4f5nbbvgBjmsm0CTab","data":[],"key":"B8JNlRncN2"}],"key":"hrQR4KtZve"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"SARChangeDetectionMethods_From_Prepared_Data_Stack - Version 1.4.2 - November 2021","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UNlaU85bJo"}],"key":"XLn4hvJ3r1"}],"key":"hjigs6SR11"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Version Changes","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Hw68g7Rutd"}],"key":"G4QWlxYtAC"}],"key":"s6esf9wFvP"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"update get_date function","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TE7sgQZURQ"}],"key":"QMfrzZfzIn"}],"key":"B1L16pJYq3"}],"key":"eUXH0b9BqA"}],"key":"oppkudd4rV"}],"key":"BjIQESgDsi"}],"key":"ralUHa8ls8"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Explore an Example NISAR GCOV Backscatter Time Series","url":"/notebooks/nisar-gcov-time-series-example","group":"Placeholder (unorganized notebooks)"}}},"domain":"http://localhost:3000"},"project":{"open_access":true,"license":{"content":{"id":"BSD-3-Clause","url":"https://opensource.org/licenses/BSD-3-Clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","free":true,"osi":true}},"title":"NISAR GCOV Cookbook","authors":[{"nameParsed":{"literal":"The Alaska Satellite Facility","given":"The Alaska Satellite","family":"Facility"},"name":"The Alaska Satellite Facility","id":"contributors-myst-generated-uid-0"}],"contributors":[{"id":"Alex-Lewandowski","nameParsed":{"literal":"Alex Lewandowski","given":"Alex","family":"Lewandowski"},"name":"Alex Lewandowski","orcid":"0009-0006-9584-0687","email":"aflewandowski@alaska.edu","affiliations":["ASF"],"github":"Alex-Lewandowski","linkedin":"https://www.linkedin.com/in/brian-rose-37bb55106/"},{"id":"julia-white","nameParsed":{"literal":"Julia White","given":"Julia","family":"White"},"name":"Julia White","affiliations":["UAF"]}],"github":"https://github.com/ASFOpenSARlab/NISAR_GCOV_Cookbook","affiliations":[{"id":"UAF","name":"University of Alaska Fairbanks","department":"Geophysical Institute","url":"https://www.gi.alaska.edu/"},{"id":"ASF","name":"Alaska Satellite Facility","url":"https://asf.alaska.edu/"}],"copyright":"2025","thebe":{"binder":{"url":"https://mybinder.org/","provider":"github","repo":"ASFOpenSARlab/NISAR_GCOV_Cookbook","ref":"HEAD"}},"toc":[{"file":"README.md"},{"children":[{"file":"notebooks/GCOV_intro.md"},{"url":"https://nisar.asf.earthdatacloud.nasa.gov/NISAR-SAMPLE-DATA/DOCS/NISAR_D-102274_RevE_NASA_SDS_Product_Specification_L2_GCOV_Nov8_2024_w-sigs.pdf","title":"NISAR GCOV Product Specification"}],"title":"Introduction to NISAR GCOV data"},{"children":[{"file":"notebooks/create_software_environment.ipynb"},{"file":"notebooks/set_up_Earthdata_Login.md"}],"title":"Prerequisites"},{"children":[{"file":"notebooks/NISAR_GCOV_Time_Series_Example.ipynb"},{"file":"notebooks/NISAR_GCOV_SARChangeDetectionMethods.ipynb"}],"title":"Placeholder (unorganized notebooks)"}],"thumbnail":"/NISAR_GCOV_Cookbook/build/thumbnail-026dbb82f595025330104291f168d4b8.png","exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Introduction to NISAR GCOV data"},{"slug":"notebooks.gcov-intro","title":"NISAR Level 2 Geocoded Covariance (GCOV) Product","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"NISAR GCOV Product Specification","url":"https://nisar.asf.earthdatacloud.nasa.gov/NISAR-SAMPLE-DATA/DOCS/NISAR_D-102274_RevE_NASA_SDS_Product_Specification_L2_GCOV_Nov8_2024_w-sigs.pdf","level":2},{"level":1,"title":"Prerequisites"},{"slug":"notebooks.create-software-environment","title":"Install Required Sorftware","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.set-up-earthdata-login","title":"Set Up an Earthdata Login Account for NISAR Data Access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Placeholder (unorganized notebooks)"},{"slug":"notebooks.nisar-gcov-time-series-example","title":"Explore an Example NISAR GCOV Backscatter Time Series","description":"","date":"","thumbnail":"/NISAR_GCOV_Cookbook/build/124abe7b9f98c2cf05d8765a59216420.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.nisar-gcov-sarchangedetectionmethods","title":"An Introduction to Simple SAR Change Detection Methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/NISAR_GCOV_Cookbook/build/manifest-06410F0D.js";
import * as route0 from "/NISAR_GCOV_Cookbook/build/root-ZJZ4LRPY.js";
import * as route1 from "/NISAR_GCOV_Cookbook/build/routes/$-23AHH5XS.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/NISAR_GCOV_Cookbook/build/entry.client-UNPC4GT3.js");</script></body></html>