{"version":2,"kind":"Notebook","sha256":"a912e1cc88de030277d02929f8fbb081f1dd05e6079747431008c6661775d910","slug":"notebooks.create-software-environment","location":"/notebooks/create_software_environment.ipynb","dependencies":[],"frontmatter":{"title":"Install Required Software Environment","content_includes_title":false,"kernelspec":{"name":"conda-base-py","display_name":"base [conda env:base] *","language":"python"},"authors":[{"nameParsed":{"literal":"The Alaska Satellite Facility","given":"The Alaska Satellite","family":"Facility"},"name":"The Alaska Satellite Facility","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"BSD-3-Clause","url":"https://opensource.org/licenses/BSD-3-Clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","free":true,"osi":true}},"github":"https://github.com/ASFOpenSARlab/NISAR_GCOV_Cookbook","copyright":"2025","affiliations":[{"id":"UAF","name":"University of Alaska Fairbanks","department":"Geophysical Institute","url":"https://www.gi.alaska.edu/"},{"id":"ASF","name":"Alaska Satellite Facility","url":"https://asf.alaska.edu/"}],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/ASFOpenSARlab/NISAR_GCOV_Cookbook/blob/HEAD/notebooks/create_software_environment.ipynb","edit_url":"https://github.com/ASFOpenSARlab/NISAR_GCOV_Cookbook/edit/HEAD/notebooks/create_software_environment.ipynb","exports":[{"format":"ipynb","filename":"create_software_environment.ipynb","url":"/NISAR_GCOV_Cookbook/_preview/4/build/create_software_envi-e8228923bc61f239e1dd3fd950dd367d.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Step 1: Create a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VjeNIXEqMl"},{"type":"inlineCode","value":"work_dir","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NLw2g5G1Xq"},{"type":"text","value":" context manager","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vh7f3HTRyK"}],"identifier":"step-1-create-a-work-dir-context-manager","label":"Step 1: Create a work_dir context manager","html_id":"step-1-create-a-work-dir-context-manager","implicit":true,"key":"bV6MyH9kOj"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This is useful when you want to run a command in a working directory and then automatically change back to your original directory","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ICOxlJIvQE"}],"key":"Y7DrOGqYo3"}],"key":"WXdTPgjS5F"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"import os\nfrom contextlib import contextmanager\nfrom pathlib import Path\n\n@contextmanager\ndef work_dir(new_dir):\n    old_dir = os.getcwd()\n    os.chdir(new_dir)\n    try:\n        yield\n    finally:\n        os.chdir(old_dir)","key":"sdPT4OhZK5"},{"type":"output","id":"af_KqC-o3np5SMdtw7X4B","data":[],"key":"Re82OzcY3K"}],"key":"oAOqIPfWsX"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 2: Install the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BghS3VGyBn"},{"type":"inlineCode","value":"isce3","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GIMXksV841"},{"type":"text","value":" environment with Pixi","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l9ijL0XuK1"}],"identifier":"step-2-install-the-isce3-environment-with-pixi","label":"Step 2: Install the isce3 environment with Pixi","html_id":"step-2-install-the-isce3-environment-with-pixi","implicit":true,"key":"nVKASKCI7n"}],"key":"ZJWl9EeIxY"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"with work_dir(Path.cwd().parent):\n    !pixi install -e isce3","key":"gNWSqUvdE8"},{"type":"output","id":"cRv9fhLNYmVjkcXDGpzPq","data":[],"key":"jlzB3jqjh3"}],"key":"z7D7DTBybJ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 3: Register the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rEudvz1pkK"},{"type":"inlineCode","value":"isce3","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RDJMqIODik"},{"type":"text","value":" environment’s Python kernel with ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EJB6GSe8rT"},{"type":"inlineCode","value":"ipykernel","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Vy3Lb60vz3"}],"identifier":"step-3-register-the-isce3-environments-python-kernel-with-ipykernel","label":"Step 3: Register the isce3 environment’s Python kernel with ipykernel","html_id":"step-3-register-the-isce3-environments-python-kernel-with-ipykernel","implicit":true,"key":"mXOpR6mQTo"}],"key":"P2DkgijKXO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"env_name = \"isce3\"\ndisplay_name = f'\"{env_name} (Python)\"'\n\n!pixi run -e isce3 python -m ipykernel install \\\n  --user \\\n  --name $env_name \\\n  --display-name $display_name","key":"nPGGmzjdOU"},{"type":"output","id":"VCTed50o8kQos-ho58wHt","data":[],"key":"rByP4Jzavh"}],"key":"Azvjht3XZR"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 4: Ensure notebook shell commands run in the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zzxxDdciW1"},{"type":"inlineCode","value":"isce3","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M5zmt76JwI"},{"type":"text","value":" environment","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tuvB3RivmP"}],"identifier":"step-4-ensure-notebook-shell-commands-run-in-the-isce3-environment","label":"Step 4: Ensure notebook shell commands run in the isce3 environment","html_id":"step-4-ensure-notebook-shell-commands-run-in-the-isce3-environment","implicit":true,"key":"ILOSnROavJ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This ensures that shell commands executed from inside a notebook with ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"w03AS87d9j"},{"type":"inlineCode","value":"!","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kd9myGCNyk"},{"type":"text","value":" run in the notebook kernel’s environment. This works by launching the entire Jupyter kernel process inside the Pixi environment, so the kernel’s PATH, environment variables, and Python executable all come from that Pixi environment, not from the parent JupyterLab environment.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Cnzm4Kz0oT"}],"key":"IWCQ4Wp6Vx"}],"key":"GC7RzWuLJs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from jupyter_client.kernelspec import KernelSpecManager\nimport json\n\nksm = KernelSpecManager()\nspec = ksm.get_kernel_spec(env_name)\nkernel_dir = Path(spec.resource_dir)\nkernel_json = kernel_dir / \"kernel.json\"\n\ndata = json.loads(kernel_json.read_text())\norig_argv = data.get(\"argv\", [])\n\nnew_argv = [\n    \"pixi\",\n    \"run\",\n    \"--manifest-path\",\n    str(Path.cwd().parent),\n    \"-e\",\n    env_name,\n] + orig_argv\n\ndata[\"argv\"] = new_argv\nkernel_json.write_text(json.dumps(data, indent=2))\nprint(f\"Updated kernel.json at {kernel_json} with Pixi wrapper.\")\nprint(\"argv:\", data[\"argv\"])","key":"xIWqDz9XcY"},{"type":"output","id":"rl6MPAXxIm80v64ShhIGC","data":[],"key":"tbvXddxSxR"}],"key":"jlPNk5FuFd"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 5: (Optional) Delete the environment and remove its ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jkLCTxHB8V"},{"type":"inlineCode","value":"kernelspec","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YBm6vRxLdG"}],"identifier":"step-5-optional-delete-the-environment-and-remove-its-kernelspec","label":"Step 5: (Optional) Delete the environment and remove its kernelspec","html_id":"step-5-optional-delete-the-environment-and-remove-its-kernelspec","implicit":true,"key":"Df1Vft8pwD"}],"key":"MWpicB27xK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"with work_dir(Path.cwd().parent):\n    !pixi clean\n    !jupyter kernelspec remove isce3 -y","key":"bCTA66VIQf"},{"type":"output","id":"Wlak0P0Q4q--FJq4hl4Ry","data":[],"key":"eMgcqJC0Cm"}],"key":"dsDBLISMAt"}],"key":"IE3EQfzj6B"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"NISAR Level 2 Geocoded Covariance (GCOV) Product","url":"/notebooks/gcov-intro","group":"Introduction to NISAR GCOV data"},"next":{"title":"Set Up an Earthdata Login Account for NISAR Data Access","url":"/notebooks/set-up-earthdata-login","group":"Prerequisites"}}},"domain":"http://localhost:3000"}